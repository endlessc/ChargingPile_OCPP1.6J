lib\site-packages\websockets\legacy\protocol.py", line 944, in transfer_data
    message = await self.read_message()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1013, in read_message
    frame = await self.read_data_frame(max_size=self.max_size)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1089, in read_data_frame
    frame = await self.read_frame(max_size)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1148, in read_frame
    extensions=self.extensions,
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\framing.py", line 70, in read
    data = await reader(2)
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\streams.py", line 679, in readexactly
    await self._wait_for_data('readexactly')
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\streams.py", line 473, in _wait_for_data
    await self._waiter
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\selector_events.py", line 812, in _read_ready__data_received
    data = self._sock.recv(self.max_size)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\server.py", line 231, in handler
    await self.ws_handler(self)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\server.py", line 1137, in _ws_handler
    )(websocket, websocket.path)
  File "D:\workspace\ocpp_test\server\connect.py", line 156, in on_connect
    await Value.chargePoint.start()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\ocpp\charge_point.py", line 125, in start
    message = await self._connection.recv()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 552, in recv
    await self.ensure_open()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 920, in ensure_open
    raise self.connection_closed_exc()
websockets.exceptions.ConnectionClosedError: no close frame received or sent
[INFO server.py:259] connection closed
[INFO server.py:641] connection open
[INFO connect.py:146] Protocols Matched: ocpp1.6
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012310555900000001","BootNotification",{"chargePointModel":"MaxiChargerAC","chargePointVendor":"Autel","firmwareVersion":"CAQoSPAGNL"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012310555900000001",{"currentTime":"2022-01-23T10:56:00.123Z","interval":10,"status":"Accepted"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012310560000000002","StatusNotification",{"connectorId":0,"status":"Available","errorCode":"NoError"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012310560000000002",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012310560000000003","StatusNotification",{"connectorId":1,"status":"Preparing","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012310560000000003",{}]
[INFO test_Recurrent_cpVoltN.py:69] 稍等5秒，等桩连上后台
[INFO test_Recurrent_cpVoltN.py:31] ========这是第8次开始执行========
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"7151fdf1-9d73-4424-8882-cdad3fbcb691","RemoteStartTransaction",{"idTag":"AE0022A1GM9C00066K","connectorId":1,"chargingProfile":{"chargingProfileId":1,"transactionId":1,"stackLevel":1,"chargingProfilePurpose":"ChargePointMaxProfile","chargingProfileKind":"Absolute","recurrencyKind":"Daily","validFrom":"date-time","validTo":"date-time","chargingSchedule":{"duration":10,"startSchedule":"date-time","chargingRateUnit":"W","chargingSchedulePeriod":[{"startPeriod":1,"limit":1.5,"numberPhases":1}],"minChargingRate":1.5}}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"7151fdf1-9d73-4424-8882-cdad3fbcb691",{"status":"Accepted"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012310560700000004","Authorize",{"idTag":"AE0022A1GM9C00066K"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012310560700000004",{"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012310561000000005","StatusNotification",{"connectorId":1,"status":"Charging","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012310561000000005",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012310561100000006","StartTransaction",{"connectorId":1,"idTag":"AE0022A1GM9C00066K","meterStart":528242,"timestamp":"2022-01-23T10:56:10.000Z"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012310561100000006",{"transactionId":1,"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012310561200000007","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T10:56:12.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"210.970000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.310000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.950000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012310561200000007",{}]
[INFO test_Recurrent_cpVoltN.py:52] ********正在充电********稍等约1分钟********
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"b58e785f-8b59-4555-808a-ba98e3ac147d","RemoteStopTransaction",{"transactionId":1}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012310562200000008","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T10:56:22.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"211.180000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.320000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.950000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012310562200000008",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012310563300000009","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T10:56:53.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"211.240000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.330000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.950000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012310563300000009",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"b58e785f-8b59-4555-808a-ba98e3ac147d",{"status":"Accepted"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231057120000000F","StopTransaction",{"idTag":"AE0022A1GM9C00066K","transactionId":1,"meterStop":528242,"timestamp":"2022-01-23T10:57:11.000Z","reason":"Remote"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231057120000000F",{"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231056430000000A","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T10:57:23.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231056430000000A",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231056530000000B","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T10:57:24.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231056530000000B",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231057030000000C","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T10:57:24.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231057030000000C",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231057040000000D","StatusNotification",{"connectorId":1,"status":"Preparing","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231057040000000D",{}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"ffdb93ed-3f27-4b27-b1d3-04671dc11f6b","Reset",{"type":"Soft"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"ffdb93ed-3f27-4b27-b1d3-04671dc11f6b",{"status":"Accepted"}]
[ERROR server.py:233] connection handler failed
Traceback (most recent call last):
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 944, in transfer_data
    message = await self.read_message()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1013, in read_message
    frame = await self.read_data_frame(max_size=self.max_size)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1089, in read_data_frame
    frame = await self.read_frame(max_size)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1148, in read_frame
    extensions=self.extensions,
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\framing.py", line 70, in read
    data = await reader(2)
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\streams.py", line 679, in readexactly
    await self._wait_for_data('readexactly')
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\streams.py", line 473, in _wait_for_data
    await self._waiter
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\selector_events.py", line 812, in _read_ready__data_received
    data = self._sock.recv(self.max_size)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\server.py", line 231, in handler
    await self.ws_handler(self)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\server.py", line 1137, in _ws_handler
    )(websocket, websocket.path)
  File "D:\workspace\ocpp_test\server\connect.py", line 156, in on_connect
    await Value.chargePoint.start()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\ocpp\charge_point.py", line 125, in start
    message = await self._connection.recv()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 552, in recv
    await self.ensure_open()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 920, in ensure_open
    raise self.connection_closed_exc()
websockets.exceptions.ConnectionClosedError: no close frame received or sent
[INFO server.py:259] connection closed
[INFO server.py:641] connection open
[INFO connect.py:146] Protocols Matched: ocpp1.6
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012310574800000001","BootNotification",{"chargePointModel":"MaxiChargerAC","chargePointVendor":"Autel","firmwareVersion":"CAQoSPAGNL"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012310574800000001",{"currentTime":"2022-01-23T10:57:49.123Z","interval":10,"status":"Accepted"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012310574900000002","StatusNotification",{"connectorId":0,"status":"Available","errorCode":"NoError"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012310574900000002",{}]
[INFO test_Recurrent_cpVoltN.py:69] 稍等5秒，等桩连上后台
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012310574900000003","StatusNotification",{"connectorId":1,"status":"Preparing","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012310574900000003",{}]
[INFO test_Recurrent_cpVoltN.py:31] ========这是第9次开始执行========
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"df20a5f9-fb6a-4365-b749-502f71e6c1af","RemoteStartTransaction",{"idTag":"AE0022A1GM9C00066K","connectorId":1,"chargingProfile":{"chargingProfileId":1,"transactionId":1,"stackLevel":1,"chargingProfilePurpose":"ChargePointMaxProfile","chargingProfileKind":"Absolute","recurrencyKind":"Daily","validFrom":"date-time","validTo":"date-time","chargingSchedule":{"duration":10,"startSchedule":"date-time","chargingRateUnit":"W","chargingSchedulePeriod":[{"startPeriod":1,"limit":1.5,"numberPhases":1}],"minChargingRate":1.5}}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"df20a5f9-fb6a-4365-b749-502f71e6c1af",{"status":"Accepted"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012310575800000004","Authorize",{"idTag":"AE0022A1GM9C00066K"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012310575800000004",{"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012310580000000005","StatusNotification",{"connectorId":1,"status":"Charging","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012310580000000005",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012310580100000006","StartTransaction",{"connectorId":1,"idTag":"AE0022A1GM9C00066K","meterStart":528242,"timestamp":"2022-01-23T10:58:00.000Z"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012310580100000006",{"transactionId":1,"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012310580200000007","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T10:58:02.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"211.100000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.320000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.950000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012310580200000007",{}]
[INFO test_Recurrent_cpVoltN.py:52] ********正在充电********稍等约1分钟********
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"89964e24-d3f8-4351-bf43-23c3d8663475","RemoteStopTransaction",{"transactionId":1}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012310581200000008","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T10:58:12.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"211.360000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.330000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.950000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012310581200000008",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012310582300000009","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T10:58:43.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"211.460000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.330000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.950000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012310582300000009",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"89964e24-d3f8-4351-bf43-23c3d8663475",{"status":"Accepted"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231059020000000F","StopTransaction",{"idTag":"AE0022A1GM9C00066K","transactionId":1,"meterStop":528242,"timestamp":"2022-01-23T10:59:01.000Z","reason":"Remote"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231059020000000F",{"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231058330000000A","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T10:59:13.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231058330000000A",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231058430000000B","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T10:59:13.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231058430000000B",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231058530000000C","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T10:59:14.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231058530000000C",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231058540000000D","StatusNotification",{"connectorId":1,"status":"Preparing","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231058540000000D",{}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"4eb4a5c6-4b07-4f98-9f0c-3eb0b9121e8d","Reset",{"type":"Soft"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"4eb4a5c6-4b07-4f98-9f0c-3eb0b9121e8d",{"status":"Accepted"}]
[ERROR server.py:233] connection handler failed
Traceback (most recent call last):
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 944, in transfer_data
    message = await self.read_message()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1013, in read_message
    frame = await self.read_data_frame(max_size=self.max_size)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1089, in read_data_frame
    frame = await self.read_frame(max_size)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1148, in read_frame
    extensions=self.extensions,
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\framing.py", line 70, in read
    data = await reader(2)
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\streams.py", line 679, in readexactly
    await self._wait_for_data('readexactly')
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\streams.py", line 473, in _wait_for_data
    await self._waiter
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\selector_events.py", line 812, in _read_ready__data_received
    data = self._sock.recv(self.max_size)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\server.py", line 231, in handler
    await self.ws_handler(self)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\server.py", line 1137, in _ws_handler
    )(websocket, websocket.path)
  File "D:\workspace\ocpp_test\server\connect.py", line 156, in on_connect
    await Value.chargePoint.start()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\ocpp\charge_point.py", line 125, in start
    message = await self._connection.recv()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 552, in recv
    await self.ensure_open()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 920, in ensure_open
    raise self.connection_closed_exc()
websockets.exceptions.ConnectionClosedError: no close frame received or sent
[INFO server.py:259] connection closed
[INFO server.py:641] connection open
[INFO connect.py:146] Protocols Matched: ocpp1.6
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012310593900000001","BootNotification",{"chargePointModel":"MaxiChargerAC","chargePointVendor":"Autel","firmwareVersion":"CAQoSPAGNL"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012310593900000001",{"currentTime":"2022-01-23T10:59:39.123Z","interval":10,"status":"Accepted"}]
[INFO test_Recurrent_cpVoltN.py:69] 稍等5秒，等桩连上后台
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012310593900000002","StatusNotification",{"connectorId":0,"status":"Available","errorCode":"NoError"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012310593900000002",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012310593900000003","StatusNotification",{"connectorId":1,"status":"Preparing","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012310593900000003",{}]
[INFO test_Recurrent_cpVoltN.py:31] ========这是第10次开始执行========
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"29084376-79f0-4a58-9eea-7f676b7c4374","RemoteStartTransaction",{"idTag":"AE0022A1GM9C00066K","connectorId":1,"chargingProfile":{"chargingProfileId":1,"transactionId":1,"stackLevel":1,"chargingProfilePurpose":"ChargePointMaxProfile","chargingProfileKind":"Absolute","recurrencyKind":"Daily","validFrom":"date-time","validTo":"date-time","chargingSchedule":{"duration":10,"startSchedule":"date-time","chargingRateUnit":"W","chargingSchedulePeriod":[{"startPeriod":1,"limit":1.5,"numberPhases":1}],"minChargingRate":1.5}}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"29084376-79f0-4a58-9eea-7f676b7c4374",{"status":"Accepted"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012310594800000004","Authorize",{"idTag":"AE0022A1GM9C00066K"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012310594800000004",{"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012310595000000005","StatusNotification",{"connectorId":1,"status":"Charging","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012310595000000005",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012310595100000006","StartTransaction",{"connectorId":1,"idTag":"AE0022A1GM9C00066K","meterStart":528242,"timestamp":"2022-01-23T10:59:50.000Z"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012310595100000006",{"transactionId":1,"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012310595200000007","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T10:59:52.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"211.760000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.350000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.950000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012310595200000007",{}]
[INFO test_Recurrent_cpVoltN.py:52] ********正在充电********稍等约1分钟********
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"6eadce3d-90fa-40db-8a4e-4158422c32df","RemoteStopTransaction",{"transactionId":1}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311000200000008","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T11:00:02.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"211.540000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.340000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.950000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311000200000008",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311001300000009","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T11:00:33.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"211.240000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.320000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.950000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311001300000009",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"6eadce3d-90fa-40db-8a4e-4158422c32df",{"status":"Accepted"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231100520000000F","StopTransaction",{"idTag":"AE0022A1GM9C00066K","transactionId":1,"meterStop":528242,"timestamp":"2022-01-23T11:00:51.000Z","reason":"Remote"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231100520000000F",{"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231100230000000A","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T11:01:03.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231100230000000A",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231100330000000B","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T11:01:03.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231100330000000B",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231100430000000C","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T11:01:04.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231100430000000C",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231100440000000D","StatusNotification",{"connectorId":1,"status":"Preparing","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231100440000000D",{}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"d04c9513-4806-4309-aa06-169bd00817c7","Reset",{"type":"Soft"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"d04c9513-4806-4309-aa06-169bd00817c7",{"status":"Accepted"}]
[ERROR server.py:233] connection handler failed
Traceback (most recent call last):
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 944, in transfer_data
    message = await self.read_message()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1013, in read_message
    frame = await self.read_data_frame(max_size=self.max_size)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1089, in read_data_frame
    frame = await self.read_frame(max_size)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1148, in read_frame
    extensions=self.extensions,
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\framing.py", line 70, in read
    data = await reader(2)
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\streams.py", line 679, in readexactly
    await self._wait_for_data('readexactly')
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\streams.py", line 473, in _wait_for_data
    await self._waiter
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\selector_events.py", line 812, in _read_ready__data_received
    data = self._sock.recv(self.max_size)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\server.py", line 231, in handler
    await self.ws_handler(self)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\server.py", line 1137, in _ws_handler
    )(websocket, websocket.path)
  File "D:\workspace\ocpp_test\server\connect.py", line 156, in on_connect
    await Value.chargePoint.start()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\ocpp\charge_point.py", line 125, in start
    message = await self._connection.recv()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 552, in recv
    await self.ensure_open()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 920, in ensure_open
    raise self.connection_closed_exc()
websockets.exceptions.ConnectionClosedError: no close frame received or sent
[INFO server.py:259] connection closed
[INFO server.py:641] connection open
[INFO connect.py:146] Protocols Matched: ocpp1.6
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311012800000001","BootNotification",{"chargePointModel":"MaxiChargerAC","chargePointVendor":"Autel","firmwareVersion":"CAQoSPAGNL"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311012800000001",{"currentTime":"2022-01-23T11:01:30.123Z","interval":10,"status":"Accepted"}]
[INFO test_Recurrent_cpVoltN.py:69] 稍等5秒，等桩连上后台
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311013000000002","StatusNotification",{"connectorId":0,"status":"Available","errorCode":"NoError"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311013000000002",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311013000000003","StatusNotification",{"connectorId":1,"status":"Preparing","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311013000000003",{}]
[INFO test_Recurrent_cpVoltN.py:31] ========这是第11次开始执行========
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"61fdbfab-6105-4790-b328-c25666689690","RemoteStartTransaction",{"idTag":"AE0022A1GM9C00066K","connectorId":1,"chargingProfile":{"chargingProfileId":1,"transactionId":1,"stackLevel":1,"chargingProfilePurpose":"ChargePointMaxProfile","chargingProfileKind":"Absolute","recurrencyKind":"Daily","validFrom":"date-time","validTo":"date-time","chargingSchedule":{"duration":10,"startSchedule":"date-time","chargingRateUnit":"W","chargingSchedulePeriod":[{"startPeriod":1,"limit":1.5,"numberPhases":1}],"minChargingRate":1.5}}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"61fdbfab-6105-4790-b328-c25666689690",{"status":"Accepted"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311013900000004","Authorize",{"idTag":"AE0022A1GM9C00066K"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311013900000004",{"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311014100000005","StatusNotification",{"connectorId":1,"status":"Charging","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311014100000005",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311014200000006","StartTransaction",{"connectorId":1,"idTag":"AE0022A1GM9C00066K","meterStart":528242,"timestamp":"2022-01-23T11:01:41.000Z"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311014200000006",{"transactionId":1,"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311014300000007","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T11:01:43.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"211.710000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.350000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.950000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311014300000007",{}]
[INFO test_Recurrent_cpVoltN.py:52] ********正在充电********稍等约1分钟********
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"aad13062-e84e-4764-afd2-4b5430c461f0","RemoteStopTransaction",{"transactionId":1}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311015400000008","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T11:01:54.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"211.700000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.350000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.950000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311015400000008",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311020400000009","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T11:02:24.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"211.680000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.340000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.950000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311020400000009",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"aad13062-e84e-4764-afd2-4b5430c461f0",{"status":"Accepted"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231102430000000F","StopTransaction",{"idTag":"AE0022A1GM9C00066K","transactionId":1,"meterStop":528242,"timestamp":"2022-01-23T11:02:42.000Z","reason":"Remote"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231102430000000F",{"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231102140000000A","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T11:02:54.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231102140000000A",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231102240000000B","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T11:02:55.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231102240000000B",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231102350000000C","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T11:02:55.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231102350000000C",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231102350000000D","StatusNotification",{"connectorId":1,"status":"Preparing","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231102350000000D",{}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"9856ca85-3de3-46f1-b026-f7f575b8494a","Reset",{"type":"Soft"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"9856ca85-3de3-46f1-b026-f7f575b8494a",{"status":"Accepted"}]
[ERROR server.py:233] connection handler failed
Traceback (most recent call last):
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 944, in transfer_data
    message = await self.read_message()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1013, in read_message
    frame = await self.read_data_frame(max_size=self.max_size)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1089, in read_data_frame
    frame = await self.read_frame(max_size)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1148, in read_frame
    extensions=self.extensions,
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\framing.py", line 70, in read
    data = await reader(2)
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\streams.py", line 679, in readexactly
    await self._wait_for_data('readexactly')
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\streams.py", line 473, in _wait_for_data
    await self._waiter
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\selector_events.py", line 812, in _read_ready__data_received
    data = self._sock.recv(self.max_size)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\server.py", line 231, in handler
    await self.ws_handler(self)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\server.py", line 1137, in _ws_handler
    )(websocket, websocket.path)
  File "D:\workspace\ocpp_test\server\connect.py", line 156, in on_connect
    await Value.chargePoint.start()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\ocpp\charge_point.py", line 125, in start
    message = await self._connection.recv()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 552, in recv
    await self.ensure_open()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 920, in ensure_open
    raise self.connection_closed_exc()
websockets.exceptions.ConnectionClosedError: no close frame received or sent
[INFO server.py:259] connection closed
[INFO server.py:641] connection open
[INFO connect.py:146] Protocols Matched: ocpp1.6
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311031900000001","BootNotification",{"chargePointModel":"MaxiChargerAC","chargePointVendor":"Autel","firmwareVersion":"CAQoSPAGNL"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311031900000001",{"currentTime":"2022-01-23T11:03:20.123Z","interval":10,"status":"Accepted"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311032000000002","StatusNotification",{"connectorId":0,"status":"Available","errorCode":"NoError"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311032000000002",{}]
[INFO test_Recurrent_cpVoltN.py:69] 稍等5秒，等桩连上后台
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311032000000003","StatusNotification",{"connectorId":1,"status":"Preparing","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311032000000003",{}]
[INFO test_Recurrent_cpVoltN.py:31] ========这是第12次开始执行========
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"4d3fc756-c9d9-4497-94e3-4b155a465c3d","RemoteStartTransaction",{"idTag":"AE0022A1GM9C00066K","connectorId":1,"chargingProfile":{"chargingProfileId":1,"transactionId":1,"stackLevel":1,"chargingProfilePurpose":"ChargePointMaxProfile","chargingProfileKind":"Absolute","recurrencyKind":"Daily","validFrom":"date-time","validTo":"date-time","chargingSchedule":{"duration":10,"startSchedule":"date-time","chargingRateUnit":"W","chargingSchedulePeriod":[{"startPeriod":1,"limit":1.5,"numberPhases":1}],"minChargingRate":1.5}}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"4d3fc756-c9d9-4497-94e3-4b155a465c3d",{"status":"Accepted"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311032900000004","Authorize",{"idTag":"AE0022A1GM9C00066K"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311032900000004",{"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311033100000006","StartTransaction",{"connectorId":1,"idTag":"AE0022A1GM9C00066K","meterStart":528242,"timestamp":"2022-01-23T11:03:31.000Z"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311033100000006",{"transactionId":1,"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311033100000005","StatusNotification",{"connectorId":1,"status":"Charging","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311033100000005",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311033300000007","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T11:03:33.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"211.570000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.340000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.950000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311033300000007",{}]
[INFO test_Recurrent_cpVoltN.py:52] ********正在充电********稍等约1分钟********
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"8d15a21d-722b-4664-807a-3aa349ede156","RemoteStopTransaction",{"transactionId":1}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311034300000008","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T11:03:43.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"211.720000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.350000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.950000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311034300000008",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311035400000009","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T11:04:14.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"211.670000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.340000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.950000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311035400000009",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"8d15a21d-722b-4664-807a-3aa349ede156",{"status":"Accepted"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231104330000000F","StopTransaction",{"idTag":"AE0022A1GM9C00066K","transactionId":1,"meterStop":528242,"timestamp":"2022-01-23T11:04:32.000Z","reason":"Remote"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231104330000000F",{"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231104040000000A","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T11:04:44.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231104040000000A",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231104140000000B","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T11:04:44.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231104140000000B",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231104240000000C","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T11:04:45.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231104240000000C",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231104250000000D","StatusNotification",{"connectorId":1,"status":"Preparing","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231104250000000D",{}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"358f3e5e-15e2-47dc-9344-233c954b3289","Reset",{"type":"Soft"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"358f3e5e-15e2-47dc-9344-233c954b3289",{"status":"Accepted"}]
[ERROR server.py:233] connection handler failed
Traceback (most recent call last):
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 944, in transfer_data
    message = await self.read_message()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1013, in read_message
    frame = await self.read_data_frame(max_size=self.max_size)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1089, in read_data_frame
    frame = await self.read_frame(max_size)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1148, in read_frame
    extensions=self.extensions,
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\framing.py", line 70, in read
    data = await reader(2)
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\streams.py", line 679, in readexactly
    await self._wait_for_data('readexactly')
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\streams.py", line 473, in _wait_for_data
    await self._waiter
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\selector_events.py", line 812, in _read_ready__data_received
    data = self._sock.recv(self.max_size)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\server.py", line 231, in handler
    await self.ws_handler(self)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\server.py", line 1137, in _ws_handler
    )(websocket, websocket.path)
  File "D:\workspace\ocpp_test\server\connect.py", line 156, in on_connect
    await Value.chargePoint.start()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\ocpp\charge_point.py", line 125, in start
    message = await self._connection.recv()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 552, in recv
    await self.ensure_open()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 920, in ensure_open
    raise self.connection_closed_exc()
websockets.exceptions.ConnectionClosedError: no close frame received or sent
[INFO server.py:259] connection closed
[INFO server.py:641] connection open
[INFO connect.py:146] Protocols Matched: ocpp1.6
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311051000000001","BootNotification",{"chargePointModel":"MaxiChargerAC","chargePointVendor":"Autel","firmwareVersion":"CAQoSPAGNL"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311051000000001",{"currentTime":"2022-01-23T11:05:11.123Z","interval":10,"status":"Accepted"}]
[INFO test_Recurrent_cpVoltN.py:69] 稍等5秒，等桩连上后台
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311051100000002","StatusNotification",{"connectorId":0,"status":"Available","errorCode":"NoError"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311051100000002",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311051100000003","StatusNotification",{"connectorId":1,"status":"Preparing","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311051100000003",{}]
[INFO test_Recurrent_cpVoltN.py:31] ========这是第13次开始执行========
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"6e9d8579-8e85-4ba8-bd7d-375ec4c1a2d4","RemoteStartTransaction",{"idTag":"AE0022A1GM9C00066K","connectorId":1,"chargingProfile":{"chargingProfileId":1,"transactionId":1,"stackLevel":1,"chargingProfilePurpose":"ChargePointMaxProfile","chargingProfileKind":"Absolute","recurrencyKind":"Daily","validFrom":"date-time","validTo":"date-time","chargingSchedule":{"duration":10,"startSchedule":"date-time","chargingRateUnit":"W","chargingSchedulePeriod":[{"startPeriod":1,"limit":1.5,"numberPhases":1}],"minChargingRate":1.5}}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"6e9d8579-8e85-4ba8-bd7d-375ec4c1a2d4",{"status":"Accepted"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311052000000004","Authorize",{"idTag":"AE0022A1GM9C00066K"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311052000000004",{"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311052200000005","StatusNotification",{"connectorId":1,"status":"Charging","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311052200000005",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311052300000006","StartTransaction",{"connectorId":1,"idTag":"AE0022A1GM9C00066K","meterStart":528242,"timestamp":"2022-01-23T11:05:22.000Z"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311052300000006",{"transactionId":1,"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311052400000007","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T11:05:24.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"211.570000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.340000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.950000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311052400000007",{}]
[INFO test_Recurrent_cpVoltN.py:52] ********正在充电********稍等约1分钟********
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"8c51d93b-9137-4902-b73e-e1e20fe58711","RemoteStopTransaction",{"transactionId":1}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311053400000008","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T11:05:34.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"211.430000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.340000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.950000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311053400000008",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311054400000009","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T11:06:04.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"211.660000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.340000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.950000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311054400000009",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"8c51d93b-9137-4902-b73e-e1e20fe58711",{"status":"Accepted"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231106240000000F","StopTransaction",{"idTag":"AE0022A1GM9C00066K","transactionId":1,"meterStop":528242,"timestamp":"2022-01-23T11:06:23.000Z","reason":"Remote"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231106240000000F",{"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231105550000000A","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T11:06:34.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231105550000000A",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231106050000000B","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T11:06:35.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231106050000000B",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231106150000000C","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T11:06:36.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231106150000000C",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231106160000000D","StatusNotification",{"connectorId":1,"status":"Preparing","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231106160000000D",{}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"79e7c99c-c423-426b-b75c-eb1b9a3d0f3e","Reset",{"type":"Soft"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"79e7c99c-c423-426b-b75c-eb1b9a3d0f3e",{"status":"Accepted"}]
[ERROR server.py:233] connection handler failed
Traceback (most recent call last):
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 944, in transfer_data
    message = await self.read_message()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1013, in read_message
    frame = await self.read_data_frame(max_size=self.max_size)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1089, in read_data_frame
    frame = await self.read_frame(max_size)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1148, in read_frame
    extensions=self.extensions,
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\framing.py", line 70, in read
    data = await reader(2)
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\streams.py", line 679, in readexactly
    await self._wait_for_data('readexactly')
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\streams.py", line 473, in _wait_for_data
    await self._waiter
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\selector_events.py", line 812, in _read_ready__data_received
    data = self._sock.recv(self.max_size)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\server.py", line 231, in handler
    await self.ws_handler(self)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\server.py", line 1137, in _ws_handler
    )(websocket, websocket.path)
  File "D:\workspace\ocpp_test\server\connect.py", line 156, in on_connect
    await Value.chargePoint.start()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\ocpp\charge_point.py", line 125, in start
    message = await self._connection.recv()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 552, in recv
    await self.ensure_open()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 920, in ensure_open
    raise self.connection_closed_exc()
websockets.exceptions.ConnectionClosedError: no close frame received or sent
[INFO server.py:259] connection closed
[INFO server.py:641] connection open
[INFO connect.py:146] Protocols Matched: ocpp1.6
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311070100000001","BootNotification",{"chargePointModel":"MaxiChargerAC","chargePointVendor":"Autel","firmwareVersion":"CAQoSPAGNL"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311070100000001",{"currentTime":"2022-01-23T11:07:02.123Z","interval":10,"status":"Accepted"}]
[INFO test_Recurrent_cpVoltN.py:69] 稍等5秒，等桩连上后台
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311070200000002","StatusNotification",{"connectorId":0,"status":"Available","errorCode":"NoError"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311070200000002",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311070200000003","StatusNotification",{"connectorId":1,"status":"Preparing","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311070200000003",{}]
[INFO test_Recurrent_cpVoltN.py:31] ========这是第14次开始执行========
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"5995ded4-35e5-4411-a07b-46dc6dc26476","RemoteStartTransaction",{"idTag":"AE0022A1GM9C00066K","connectorId":1,"chargingProfile":{"chargingProfileId":1,"transactionId":1,"stackLevel":1,"chargingProfilePurpose":"ChargePointMaxProfile","chargingProfileKind":"Absolute","recurrencyKind":"Daily","validFrom":"date-time","validTo":"date-time","chargingSchedule":{"duration":10,"startSchedule":"date-time","chargingRateUnit":"W","chargingSchedulePeriod":[{"startPeriod":1,"limit":1.5,"numberPhases":1}],"minChargingRate":1.5}}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"5995ded4-35e5-4411-a07b-46dc6dc26476",{"status":"Accepted"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311071000000004","Authorize",{"idTag":"AE0022A1GM9C00066K"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311071000000004",{"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311071300000005","StatusNotification",{"connectorId":1,"status":"Charging","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311071300000005",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311071400000006","StartTransaction",{"connectorId":1,"idTag":"AE0022A1GM9C00066K","meterStart":528242,"timestamp":"2022-01-23T11:07:13.000Z"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311071400000006",{"transactionId":1,"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311071500000007","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T11:07:15.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"211.590000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.330000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.950000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311071500000007",{}]
[INFO test_Recurrent_cpVoltN.py:52] ********正在充电********稍等约1分钟********
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"b0f7d760-5574-4185-afb4-fd5e6b6bf802","RemoteStopTransaction",{"transactionId":1}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311072500000008","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T11:07:25.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"211.560000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.330000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.950000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311072500000008",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311073600000009","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T11:07:56.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"211.910000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.350000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.950000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311073600000009",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"b0f7d760-5574-4185-afb4-fd5e6b6bf802",{"status":"Accepted"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231108140000000F","StopTransaction",{"idTag":"AE0022A1GM9C00066K","transactionId":1,"meterStop":528242,"timestamp":"2022-01-23T11:08:13.000Z","reason":"Remote"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231108140000000F",{"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231107460000000A","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T11:08:26.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231107460000000A",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231107560000000B","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T11:08:26.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231107560000000B",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231108060000000C","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T11:08:27.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231108060000000C",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231108070000000D","StatusNotification",{"connectorId":1,"status":"Preparing","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231108070000000D",{}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"05f73808-b356-4007-9e25-27379b3a0bb4","Reset",{"type":"Soft"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"05f73808-b356-4007-9e25-27379b3a0bb4",{"status":"Accepted"}]
[ERROR server.py:233] connection handler failed
Traceback (most recent call last):
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 944, in transfer_data
    message = await self.read_message()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1013, in read_message
    frame = await self.read_data_frame(max_size=self.max_size)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1089, in read_data_frame
    frame = await self.read_frame(max_size)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1148, in read_frame
    extensions=self.extensions,
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\framing.py", line 70, in read
    data = await reader(2)
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\streams.py", line 679, in readexactly
    await self._wait_for_data('readexactly')
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\streams.py", line 473, in _wait_for_data
    await self._waiter
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\selector_events.py", line 812, in _read_ready__data_received
    data = self._sock.recv(self.max_size)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\server.py", line 231, in handler
    await self.ws_handler(self)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\server.py", line 1137, in _ws_handler
    )(websocket, websocket.path)
  File "D:\workspace\ocpp_test\server\connect.py", line 156, in on_connect
    await Value.chargePoint.start()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\ocpp\charge_point.py", line 125, in start
    message = await self._connection.recv()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 552, in recv
    await self.ensure_open()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 920, in ensure_open
    raise self.connection_closed_exc()
websockets.exceptions.ConnectionClosedError: no close frame received or sent
[INFO server.py:259] connection closed
[INFO server.py:641] connection open
[INFO connect.py:146] Protocols Matched: ocpp1.6
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311085200000001","BootNotification",{"chargePointModel":"MaxiChargerAC","chargePointVendor":"Autel","firmwareVersion":"CAQoSPAGNL"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311085200000001",{"currentTime":"2022-01-23T11:08:52.123Z","interval":10,"status":"Accepted"}]
[INFO test_Recurrent_cpVoltN.py:69] 稍等5秒，等桩连上后台
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311085200000002","StatusNotification",{"connectorId":0,"status":"Available","errorCode":"NoError"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311085200000002",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311085200000003","StatusNotification",{"connectorId":1,"status":"Preparing","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311085200000003",{}]
[INFO test_Recurrent_cpVoltN.py:31] ========这是第15次开始执行========
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"47c4a16f-7f11-4ae3-bc79-4aaa0e514b62","RemoteStartTransaction",{"idTag":"AE0022A1GM9C00066K","connectorId":1,"chargingProfile":{"chargingProfileId":1,"transactionId":1,"stackLevel":1,"chargingProfilePurpose":"ChargePointMaxProfile","chargingProfileKind":"Absolute","recurrencyKind":"Daily","validFrom":"date-time","validTo":"date-time","chargingSchedule":{"duration":10,"startSchedule":"date-time","chargingRateUnit":"W","chargingSchedulePeriod":[{"startPeriod":1,"limit":1.5,"numberPhases":1}],"minChargingRate":1.5}}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"47c4a16f-7f11-4ae3-bc79-4aaa0e514b62",{"status":"Accepted"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311090000000004","Authorize",{"idTag":"AE0022A1GM9C00066K"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311090000000004",{"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311090300000005","StatusNotification",{"connectorId":1,"status":"Charging","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311090300000005",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311090400000006","StartTransaction",{"connectorId":1,"idTag":"AE0022A1GM9C00066K","meterStart":528242,"timestamp":"2022-01-23T11:09:03.000Z"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311090400000006",{"transactionId":1,"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311090500000007","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T11:09:05.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"211.660000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.340000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.950000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311090500000007",{}]
[INFO test_Recurrent_cpVoltN.py:52] ********正在充电********稍等约1分钟********
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"0bd6df04-277c-43e8-bdda-2906861d6a96","RemoteStopTransaction",{"transactionId":1}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311091500000008","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T11:09:15.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"211.540000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.330000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.950000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311091500000008",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311092500000009","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T11:09:46.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"211.690000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.350000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.960000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311092500000009",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"0bd6df04-277c-43e8-bdda-2906861d6a96",{"status":"Accepted"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231110050000000F","StopTransaction",{"idTag":"AE0022A1GM9C00066K","transactionId":1,"meterStop":528242,"timestamp":"2022-01-23T11:10:05.000Z","reason":"Remote"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231110050000000F",{"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231109360000000A","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T11:10:16.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231109360000000A",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231109460000000B","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T11:10:16.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231109460000000B",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231109560000000C","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T11:10:17.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231109560000000C",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231109570000000D","StatusNotification",{"connectorId":1,"status":"Preparing","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231109570000000D",{}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"b6f245d5-e19c-4637-a64b-98ef74734403","Reset",{"type":"Soft"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"b6f245d5-e19c-4637-a64b-98ef74734403",{"status":"Accepted"}]
[ERROR server.py:233] connection handler failed
Traceback (most recent call last):
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 944, in transfer_data
    message = await self.read_message()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1013, in read_message
    frame = await self.read_data_frame(max_size=self.max_size)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1089, in read_data_frame
    frame = await self.read_frame(max_size)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1148, in read_frame
    extensions=self.extensions,
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\framing.py", line 70, in read
    data = await reader(2)
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\streams.py", line 679, in readexactly
    await self._wait_for_data('readexactly')
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\streams.py", line 473, in _wait_for_data
    await self._waiter
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\selector_events.py", line 812, in _read_ready__data_received
    data = self._sock.recv(self.max_size)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\server.py", line 231, in handler
    await self.ws_handler(self)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\server.py", line 1137, in _ws_handler
    )(websocket, websocket.path)
  File "D:\workspace\ocpp_test\server\connect.py", line 156, in on_connect
    await Value.chargePoint.start()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\ocpp\charge_point.py", line 125, in start
    message = await self._connection.recv()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 552, in recv
    await self.ensure_open()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 920, in ensure_open
    raise self.connection_closed_exc()
websockets.exceptions.ConnectionClosedError: no close frame received or sent
[INFO server.py:259] connection closed
[INFO server.py:641] connection open
[INFO connect.py:146] Protocols Matched: ocpp1.6
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311104100000001","BootNotification",{"chargePointModel":"MaxiChargerAC","chargePointVendor":"Autel","firmwareVersion":"CAQoSPAGNL"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311104100000001",{"currentTime":"2022-01-23T11:10:42.123Z","interval":10,"status":"Accepted"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311104200000002","StatusNotification",{"connectorId":0,"status":"Available","errorCode":"NoError"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311104200000002",{}]
[INFO test_Recurrent_cpVoltN.py:69] 稍等5秒，等桩连上后台
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311104200000003","StatusNotification",{"connectorId":1,"status":"Preparing","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311104200000003",{}]
[INFO test_Recurrent_cpVoltN.py:31] ========这是第16次开始执行========
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"bab38e34-f0a9-48b5-b43f-0800cb7881f7","RemoteStartTransaction",{"idTag":"AE0022A1GM9C00066K","connectorId":1,"chargingProfile":{"chargingProfileId":1,"transactionId":1,"stackLevel":1,"chargingProfilePurpose":"ChargePointMaxProfile","chargingProfileKind":"Absolute","recurrencyKind":"Daily","validFrom":"date-time","validTo":"date-time","chargingSchedule":{"duration":10,"startSchedule":"date-time","chargingRateUnit":"W","chargingSchedulePeriod":[{"startPeriod":1,"limit":1.5,"numberPhases":1}],"minChargingRate":1.5}}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"bab38e34-f0a9-48b5-b43f-0800cb7881f7",{"status":"Accepted"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311105100000004","Authorize",{"idTag":"AE0022A1GM9C00066K"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311105100000004",{"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311105300000005","StatusNotification",{"connectorId":1,"status":"Charging","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311105300000005",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311105400000006","StartTransaction",{"connectorId":1,"idTag":"AE0022A1GM9C00066K","meterStart":528242,"timestamp":"2022-01-23T11:10:53.000Z"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311105400000006",{"transactionId":1,"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311105500000007","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T11:10:55.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"211.770000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.340000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.950000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311105500000007",{}]
[INFO test_Recurrent_cpVoltN.py:52] ********正在充电********稍等约1分钟********
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"5687d050-120d-407a-8c9e-c9972da48ced","RemoteStopTransaction",{"transactionId":1}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311110500000008","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T11:11:06.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"211.830000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.350000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.950000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311110500000008",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311111600000009","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T11:11:36.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"211.910000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.350000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.960000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311111600000009",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"5687d050-120d-407a-8c9e-c9972da48ced",{"status":"Accepted"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231111550000000F","StopTransaction",{"idTag":"AE0022A1GM9C00066K","transactionId":1,"meterStop":528242,"timestamp":"2022-01-23T11:11:54.000Z","reason":"Remote"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231111550000000F",{"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231111260000000A","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T11:12:06.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231111260000000A",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231111360000000B","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T11:12:07.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231111360000000B",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231111460000000C","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T11:12:07.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231111460000000C",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231111470000000D","StatusNotification",{"connectorId":1,"status":"Preparing","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231111470000000D",{}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"4393fbfb-69e1-4a6b-a00a-f95e9ec5972f","Reset",{"type":"Soft"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"4393fbfb-69e1-4a6b-a00a-f95e9ec5972f",{"status":"Accepted"}]
[ERROR server.py:233] connection handler failed
Traceback (most recent call last):
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 944, in transfer_data
    message = await self.read_message()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1013, in read_message
    frame = await self.read_data_frame(max_size=self.max_size)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1089, in read_data_frame
    frame = await self.read_frame(max_size)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1148, in read_frame
    extensions=self.extensions,
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\framing.py", line 70, in read
    data = await reader(2)
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\streams.py", line 679, in readexactly
    await self._wait_for_data('readexactly')
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\streams.py", line 473, in _wait_for_data
    await self._waiter
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\selector_events.py", line 812, in _read_ready__data_received
    data = self._sock.recv(self.max_size)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\server.py", line 231, in handler
    await self.ws_handler(self)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\server.py", line 1137, in _ws_handler
    )(websocket, websocket.path)
  File "D:\workspace\ocpp_test\server\connect.py", line 156, in on_connect
    await Value.chargePoint.start()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\ocpp\charge_point.py", line 125, in start
    message = await self._connection.recv()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 552, in recv
    await self.ensure_open()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 920, in ensure_open
    raise self.connection_closed_exc()
websockets.exceptions.ConnectionClosedError: no close frame received or sent
[INFO server.py:259] connection closed
[INFO server.py:641] connection open
[INFO connect.py:146] Protocols Matched: ocpp1.6
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311123200000001","BootNotification",{"chargePointModel":"MaxiChargerAC","chargePointVendor":"Autel","firmwareVersion":"CAQoSPAGNL"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311123200000001",{"currentTime":"2022-01-23T11:12:33.123Z","interval":10,"status":"Accepted"}]
[INFO test_Recurrent_cpVoltN.py:69] 稍等5秒，等桩连上后台
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311123300000002","StatusNotification",{"connectorId":0,"status":"Available","errorCode":"NoError"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311123300000002",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311123300000003","StatusNotification",{"connectorId":1,"status":"Preparing","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311123300000003",{}]
[INFO test_Recurrent_cpVoltN.py:31] ========这是第17次开始执行========
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"042a9e0f-6ad2-4213-8a84-6adb8f865fe0","RemoteStartTransaction",{"idTag":"AE0022A1GM9C00066K","connectorId":1,"chargingProfile":{"chargingProfileId":1,"transactionId":1,"stackLevel":1,"chargingProfilePurpose":"ChargePointMaxProfile","chargingProfileKind":"Absolute","recurrencyKind":"Daily","validFrom":"date-time","validTo":"date-time","chargingSchedule":{"duration":10,"startSchedule":"date-time","chargingRateUnit":"W","chargingSchedulePeriod":[{"startPeriod":1,"limit":1.5,"numberPhases":1}],"minChargingRate":1.5}}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"042a9e0f-6ad2-4213-8a84-6adb8f865fe0",{"status":"Accepted"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311124100000004","Authorize",{"idTag":"AE0022A1GM9C00066K"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311124100000004",{"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311124400000005","StatusNotification",{"connectorId":1,"status":"Charging","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311124400000005",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311124500000006","StartTransaction",{"connectorId":1,"idTag":"AE0022A1GM9C00066K","meterStart":528242,"timestamp":"2022-01-23T11:12:44.000Z"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311124500000006",{"transactionId":1,"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311124600000007","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T11:12:46.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"212.060000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.360000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.960000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311124600000007",{}]
[INFO test_Recurrent_cpVoltN.py:52] ********正在充电********稍等约1分钟********
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"70228455-3251-42ce-870e-bcddb9b03fb0","RemoteStopTransaction",{"transactionId":1}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311125600000008","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T11:12:56.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"212.100000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.360000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.960000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311125600000008",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311130700000009","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T11:13:27.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"211.910000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.350000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.960000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311130700000009",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"70228455-3251-42ce-870e-bcddb9b03fb0",{"status":"Accepted"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231113450000000F","StopTransaction",{"idTag":"AE0022A1GM9C00066K","transactionId":1,"meterStop":528242,"timestamp":"2022-01-23T11:13:44.000Z","reason":"Remote"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231113450000000F",{"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231113170000000A","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T11:13:57.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231113170000000A",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231113270000000B","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T11:13:58.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231113270000000B",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231113370000000C","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T11:13:58.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231113370000000C",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231113380000000D","StatusNotification",{"connectorId":1,"status":"Preparing","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231113380000000D",{}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"692c6bc9-0735-416a-a422-9a5f121e2255","Reset",{"type":"Soft"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"692c6bc9-0735-416a-a422-9a5f121e2255",{"status":"Accepted"}]
[ERROR server.py:233] connection handler failed
Traceback (most recent call last):
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 944, in transfer_data
    message = await self.read_message()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1013, in read_message
    frame = await self.read_data_frame(max_size=self.max_size)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1089, in read_data_frame
    frame = await self.read_frame(max_size)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1148, in read_frame
    extensions=self.extensions,
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\framing.py", line 70, in read
    data = await reader(2)
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\streams.py", line 679, in readexactly
    await self._wait_for_data('readexactly')
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\streams.py", line 473, in _wait_for_data
    await self._waiter
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\selector_events.py", line 812, in _read_ready__data_received
    data = self._sock.recv(self.max_size)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\server.py", line 231, in handler
    await self.ws_handler(self)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\server.py", line 1137, in _ws_handler
    )(websocket, websocket.path)
  File "D:\workspace\ocpp_test\server\connect.py", line 156, in on_connect
    await Value.chargePoint.start()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\ocpp\charge_point.py", line 125, in start
    message = await self._connection.recv()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 552, in recv
    await self.ensure_open()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 920, in ensure_open
    raise self.connection_closed_exc()
websockets.exceptions.ConnectionClosedError: no close frame received or sent
[INFO server.py:259] connection closed
[INFO server.py:641] connection open
[INFO connect.py:146] Protocols Matched: ocpp1.6
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311142300000001","BootNotification",{"chargePointModel":"MaxiChargerAC","chargePointVendor":"Autel","firmwareVersion":"CAQoSPAGNL"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311142300000001",{"currentTime":"2022-01-23T11:14:23.123Z","interval":10,"status":"Accepted"}]
[INFO test_Recurrent_cpVoltN.py:69] 稍等5秒，等桩连上后台
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311142300000002","StatusNotification",{"connectorId":0,"status":"Available","errorCode":"NoError"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311142300000002",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311142300000003","StatusNotification",{"connectorId":1,"status":"Preparing","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311142300000003",{}]
[INFO test_Recurrent_cpVoltN.py:31] ========这是第18次开始执行========
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"40261104-fd7b-48f2-b4ba-49f6b33b6fc4","RemoteStartTransaction",{"idTag":"AE0022A1GM9C00066K","connectorId":1,"chargingProfile":{"chargingProfileId":1,"transactionId":1,"stackLevel":1,"chargingProfilePurpose":"ChargePointMaxProfile","chargingProfileKind":"Absolute","recurrencyKind":"Daily","validFrom":"date-time","validTo":"date-time","chargingSchedule":{"duration":10,"startSchedule":"date-time","chargingRateUnit":"W","chargingSchedulePeriod":[{"startPeriod":1,"limit":1.5,"numberPhases":1}],"minChargingRate":1.5}}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"40261104-fd7b-48f2-b4ba-49f6b33b6fc4",{"status":"Accepted"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311143200000004","Authorize",{"idTag":"AE0022A1GM9C00066K"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311143200000004",{"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311143400000005","StatusNotification",{"connectorId":1,"status":"Charging","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311143400000005",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311143500000006","StartTransaction",{"connectorId":1,"idTag":"AE0022A1GM9C00066K","meterStart":528242,"timestamp":"2022-01-23T11:14:34.000Z"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311143500000006",{"transactionId":1,"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311143600000007","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T11:14:36.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"211.980000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.350000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.960000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311143600000007",{}]
[INFO test_Recurrent_cpVoltN.py:52] ********正在充电********稍等约1分钟********
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"27ba5d06-588b-4cbd-bd5e-a400940b1a1d","RemoteStopTransaction",{"transactionId":1}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311144700000008","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T11:14:47.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"212.070000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.360000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.960000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311144700000008",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311145700000009","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T11:15:17.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"211.860000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.350000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.960000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311145700000009",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"27ba5d06-588b-4cbd-bd5e-a400940b1a1d",{"status":"Accepted"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231115360000000F","StopTransaction",{"idTag":"AE0022A1GM9C00066K","transactionId":1,"meterStop":528242,"timestamp":"2022-01-23T11:15:35.000Z","reason":"Remote"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231115360000000F",{"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231115070000000A","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T11:15:47.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231115070000000A",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231115180000000B","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T11:15:48.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231115180000000B",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231115280000000C","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T11:15:48.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231115280000000C",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231115280000000D","StatusNotification",{"connectorId":1,"status":"Preparing","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231115280000000D",{}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"1585f0af-041e-40e2-86b8-fb6e5111995d","Reset",{"type":"Soft"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"1585f0af-041e-40e2-86b8-fb6e5111995d",{"status":"Accepted"}]
[ERROR server.py:233] connection handler failed
Traceback (most recent call last):
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 944, in transfer_data
    message = await self.read_message()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1013, in read_message
    frame = await self.read_data_frame(max_size=self.max_size)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1089, in read_data_frame
    frame = await self.read_frame(max_size)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1148, in read_frame
    extensions=self.extensions,
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\framing.py", line 70, in read
    data = await reader(2)
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\streams.py", line 679, in readexactly
    await self._wait_for_data('readexactly')
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\streams.py", line 473, in _wait_for_data
    await self._waiter
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\selector_events.py", line 812, in _read_ready__data_received
    data = self._sock.recv(self.max_size)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\server.py", line 231, in handler
    await self.ws_handler(self)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\server.py", line 1137, in _ws_handler
    )(websocket, websocket.path)
  File "D:\workspace\ocpp_test\server\connect.py", line 156, in on_connect
    await Value.chargePoint.start()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\ocpp\charge_point.py", line 125, in start
    message = await self._connection.recv()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 552, in recv
    await self.ensure_open()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 920, in ensure_open
    raise self.connection_closed_exc()
websockets.exceptions.ConnectionClosedError: no close frame received or sent
[INFO server.py:259] connection closed
[INFO server.py:641] connection open
[INFO connect.py:146] Protocols Matched: ocpp1.6
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311160600000001","BootNotification",{"chargePointModel":"MaxiChargerAC","chargePointVendor":"Autel","firmwareVersion":"CAQoSPAGNL"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311160600000001",{"currentTime":"2022-01-23T11:16:07.123Z","interval":10,"status":"Accepted"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311160700000002","StatusNotification",{"connectorId":0,"status":"Available","errorCode":"NoError"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311160700000002",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311160700000003","StatusNotification",{"connectorId":1,"status":"Preparing","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311160700000003",{}]
[INFO test_Recurrent_cpVoltN.py:69] 稍等5秒，等桩连上后台
[INFO test_Recurrent_cpVoltN.py:31] ========这是第19次开始执行========
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"4fc8e386-780a-4e41-85ea-a1f0de003599","RemoteStartTransaction",{"idTag":"AE0022A1GM9C00066K","connectorId":1,"chargingProfile":{"chargingProfileId":1,"transactionId":1,"stackLevel":1,"chargingProfilePurpose":"ChargePointMaxProfile","chargingProfileKind":"Absolute","recurrencyKind":"Daily","validFrom":"date-time","validTo":"date-time","chargingSchedule":{"duration":10,"startSchedule":"date-time","chargingRateUnit":"W","chargingSchedulePeriod":[{"startPeriod":1,"limit":1.5,"numberPhases":1}],"minChargingRate":1.5}}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"4fc8e386-780a-4e41-85ea-a1f0de003599",{"status":"Accepted"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311161300000004","Authorize",{"idTag":"AE0022A1GM9C00066K"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311161300000004",{"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311161600000005","StatusNotification",{"connectorId":1,"status":"Charging","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311161600000005",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311161700000006","StartTransaction",{"connectorId":1,"idTag":"AE0022A1GM9C00066K","meterStart":528242,"timestamp":"2022-01-23T11:16:15.000Z"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311161700000006",{"transactionId":1,"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311161800000007","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T11:16:18.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"211.880000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.350000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.960000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311161800000007",{}]
[INFO test_Recurrent_cpVoltN.py:52] ********正在充电********稍等约1分钟********
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"373bdd14-aa06-46b1-8121-bcd6939b94c9","RemoteStopTransaction",{"transactionId":1}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311162900000008","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T11:16:29.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"211.750000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.350000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.960000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311162900000008",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311163900000009","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T11:16:59.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"211.650000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.340000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.950000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311163900000009",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"373bdd14-aa06-46b1-8121-bcd6939b94c9",{"status":"Accepted"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231117180000000F","StopTransaction",{"idTag":"AE0022A1GM9C00066K","transactionId":1,"meterStop":528242,"timestamp":"2022-01-23T11:17:17.000Z","reason":"Remote"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231117180000000F",{"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231116490000000A","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T11:17:29.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231116490000000A",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231117000000000B","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T11:17:29.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231117000000000B",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231117100000000C","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T11:17:30.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231117100000000C",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231117100000000D","StatusNotification",{"connectorId":1,"status":"Preparing","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231117100000000D",{}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"c23bf46a-0fbe-4fed-86a1-abae4c229214","Reset",{"type":"Soft"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"c23bf46a-0fbe-4fed-86a1-abae4c229214",{"status":"Accepted"}]
[ERROR server.py:233] connection handler failed
Traceback (most recent call last):
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 944, in transfer_data
    message = await self.read_message()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1013, in read_message
    frame = await self.read_data_frame(max_size=self.max_size)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1089, in read_data_frame
    frame = await self.read_frame(max_size)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1148, in read_frame
    extensions=self.extensions,
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\framing.py", line 70, in read
    data = await reader(2)
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\streams.py", line 679, in readexactly
    await self._wait_for_data('readexactly')
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\streams.py", line 473, in _wait_for_data
    await self._waiter
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\selector_events.py", line 812, in _read_ready__data_received
    data = self._sock.recv(self.max_size)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\server.py", line 231, in handler
    await self.ws_handler(self)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\server.py", line 1137, in _ws_handler
    )(websocket, websocket.path)
  File "D:\workspace\ocpp_test\server\connect.py", line 156, in on_connect
    await Value.chargePoint.start()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\ocpp\charge_point.py", line 125, in start
    message = await self._connection.recv()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 552, in recv
    await self.ensure_open()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 920, in ensure_open
    raise self.connection_closed_exc()
websockets.exceptions.ConnectionClosedError: no close frame received or sent
[INFO server.py:259] connection closed
[INFO server.py:641] connection open
[INFO connect.py:146] Protocols Matched: ocpp1.6
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311175500000001","BootNotification",{"chargePointModel":"MaxiChargerAC","chargePointVendor":"Autel","firmwareVersion":"CAQoSPAGNL"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311175500000001",{"currentTime":"2022-01-23T11:17:56.123Z","interval":10,"status":"Accepted"}]
[INFO test_Recurrent_cpVoltN.py:69] 稍等5秒，等桩连上后台
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311175600000002","StatusNotification",{"connectorId":0,"status":"Available","errorCode":"NoError"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311175600000002",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311175600000003","StatusNotification",{"connectorId":1,"status":"Preparing","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311175600000003",{}]
[INFO test_Recurrent_cpVoltN.py:31] ========这是第20次开始执行========
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"4bf91c59-41b6-47f7-8f81-e55017396eca","RemoteStartTransaction",{"idTag":"AE0022A1GM9C00066K","connectorId":1,"chargingProfile":{"chargingProfileId":1,"transactionId":1,"stackLevel":1,"chargingProfilePurpose":"ChargePointMaxProfile","chargingProfileKind":"Absolute","recurrencyKind":"Daily","validFrom":"date-time","validTo":"date-time","chargingSchedule":{"duration":10,"startSchedule":"date-time","chargingRateUnit":"W","chargingSchedulePeriod":[{"startPeriod":1,"limit":1.5,"numberPhases":1}],"minChargingRate":1.5}}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"4bf91c59-41b6-47f7-8f81-e55017396eca",{"status":"Accepted"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311180400000004","Authorize",{"idTag":"AE0022A1GM9C00066K"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311180400000004",{"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311180700000005","StatusNotification",{"connectorId":1,"status":"Charging","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311180700000005",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311180800000006","StartTransaction",{"connectorId":1,"idTag":"AE0022A1GM9C00066K","meterStart":528242,"timestamp":"2022-01-23T11:18:07.000Z"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311180800000006",{"transactionId":1,"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311180900000007","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T11:18:09.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"211.940000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.350000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.960000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311180900000007",{}]
[INFO test_Recurrent_cpVoltN.py:52] ********正在充电********稍等约1分钟********
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"1108f110-debc-4157-88d5-03da4b2c63cd","RemoteStopTransaction",{"transactionId":1}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311181900000008","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T11:18:19.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"211.950000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.350000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.960000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311181900000008",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311182900000009","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T11:18:50.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"211.790000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.340000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.960000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311182900000009",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"1108f110-debc-4157-88d5-03da4b2c63cd",{"status":"Accepted"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231119090000000F","StopTransaction",{"idTag":"AE0022A1GM9C00066K","transactionId":1,"meterStop":528242,"timestamp":"2022-01-23T11:19:08.000Z","reason":"Remote"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231119090000000F",{"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231118400000000A","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T11:19:20.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231118400000000A",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231118500000000B","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T11:19:20.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231118500000000B",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231119000000000C","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T11:19:21.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231119000000000C",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231119010000000D","StatusNotification",{"connectorId":1,"status":"Preparing","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231119010000000D",{}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"3afda2d6-0cd7-4bff-8386-516be0049cf0","Reset",{"type":"Soft"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"3afda2d6-0cd7-4bff-8386-516be0049cf0",{"status":"Accepted"}]
[ERROR server.py:233] connection handler failed
Traceback (most recent call last):
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 944, in transfer_data
    message = await self.read_message()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1013, in read_message
    frame = await self.read_data_frame(max_size=self.max_size)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1089, in read_data_frame
    frame = await self.read_frame(max_size)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1148, in read_frame
    extensions=self.extensions,
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\framing.py", line 70, in read
    data = await reader(2)
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\streams.py", line 679, in readexactly
    await self._wait_for_data('readexactly')
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\streams.py", line 473, in _wait_for_data
    await self._waiter
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\selector_events.py", line 812, in _read_ready__data_received
    data = self._sock.recv(self.max_size)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\server.py", line 231, in handler
    await self.ws_handler(self)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\server.py", line 1137, in _ws_handler
    )(websocket, websocket.path)
  File "D:\workspace\ocpp_test\server\connect.py", line 156, in on_connect
    await Value.chargePoint.start()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\ocpp\charge_point.py", line 125, in start
    message = await self._connection.recv()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 552, in recv
    await self.ensure_open()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 920, in ensure_open
    raise self.connection_closed_exc()
websockets.exceptions.ConnectionClosedError: no close frame received or sent
[INFO server.py:259] connection closed
[INFO server.py:641] connection open
[INFO connect.py:146] Protocols Matched: ocpp1.6
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311194500000001","BootNotification",{"chargePointModel":"MaxiChargerAC","chargePointVendor":"Autel","firmwareVersion":"CAQoSPAGNL"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311194500000001",{"currentTime":"2022-01-23T11:19:46.123Z","interval":10,"status":"Accepted"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311194600000002","StatusNotification",{"connectorId":0,"status":"Available","errorCode":"NoError"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311194600000002",{}]
[INFO test_Recurrent_cpVoltN.py:69] 稍等5秒，等桩连上后台
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311194600000003","StatusNotification",{"connectorId":1,"status":"Preparing","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311194600000003",{}]
[INFO test_Recurrent_cpVoltN.py:31] ========这是第21次开始执行========
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"dca905af-d2ab-4b91-8d61-a622d7fcd8e3","RemoteStartTransaction",{"idTag":"AE0022A1GM9C00066K","connectorId":1,"chargingProfile":{"chargingProfileId":1,"transactionId":1,"stackLevel":1,"chargingProfilePurpose":"ChargePointMaxProfile","chargingProfileKind":"Absolute","recurrencyKind":"Daily","validFrom":"date-time","validTo":"date-time","chargingSchedule":{"duration":10,"startSchedule":"date-time","chargingRateUnit":"W","chargingSchedulePeriod":[{"startPeriod":1,"limit":1.5,"numberPhases":1}],"minChargingRate":1.5}}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"dca905af-d2ab-4b91-8d61-a622d7fcd8e3",{"status":"Accepted"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311195500000004","Authorize",{"idTag":"AE0022A1GM9C00066K"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311195500000004",{"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311195700000005","StatusNotification",{"connectorId":1,"status":"Charging","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311195700000005",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311195800000006","StartTransaction",{"connectorId":1,"idTag":"AE0022A1GM9C00066K","meterStart":528242,"timestamp":"2022-01-23T11:19:57.000Z"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311195800000006",{"transactionId":1,"idTagInfo":{"status":"Accepted"}}]
[INFO test_Recurrent_cpVoltN.py:52] ********正在充电********稍等约1分钟********
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"4badd669-a8e4-4fdb-bd63-d18548fcc794","RemoteStopTransaction",{"transactionId":1}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311195900000007","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T11:19:59.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"211.710000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.340000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.950000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311195900000007",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311200900000008","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T11:20:29.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"211.680000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.340000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.950000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311200900000008",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"4badd669-a8e4-4fdb-bd63-d18548fcc794",{"status":"Accepted"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231120560000000E","StopTransaction",{"idTag":"AE0022A1GM9C00066K","transactionId":1,"meterStop":528242,"timestamp":"2022-01-23T11:20:55.000Z","reason":"Remote"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231120560000000E",{"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311201900000009","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T11:20:59.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311201900000009",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231120300000000A","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T11:21:00.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231120300000000A",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231120400000000B","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T11:21:00.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231120400000000B",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231120480000000C","StatusNotification",{"connectorId":1,"status":"Preparing","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231120480000000C",{}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"07a0189e-0a80-419f-8f32-1835dcf10e07","Reset",{"type":"Soft"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"07a0189e-0a80-419f-8f32-1835dcf10e07",{"status":"Accepted"}]
[ERROR server.py:233] connection handler failed
Traceback (most recent call last):
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 944, in transfer_data
    message = await self.read_message()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1013, in read_message
    frame = await self.read_data_frame(max_size=self.max_size)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1089, in read_data_frame
    frame = await self.read_frame(max_size)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1148, in read_frame
    extensions=self.extensions,
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\framing.py", line 70, in read
    data = await reader(2)
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\streams.py", line 679, in readexactly
    await self._wait_for_data('readexactly')
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\streams.py", line 473, in _wait_for_data
    await self._waiter
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\selector_events.py", line 812, in _read_ready__data_received
    data = self._sock.recv(self.max_size)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\server.py", line 231, in handler
    await self.ws_handler(self)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\server.py", line 1137, in _ws_handler
    )(websocket, websocket.path)
  File "D:\workspace\ocpp_test\server\connect.py", line 156, in on_connect
    await Value.chargePoint.start()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\ocpp\charge_point.py", line 125, in start
    message = await self._connection.recv()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 552, in recv
    await self.ensure_open()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 920, in ensure_open
    raise self.connection_closed_exc()
websockets.exceptions.ConnectionClosedError: no close frame received or sent
[INFO server.py:259] connection closed
[INFO server.py:641] connection open
[INFO connect.py:146] Protocols Matched: ocpp1.6
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311212700000001","BootNotification",{"chargePointModel":"MaxiChargerAC","chargePointVendor":"Autel","firmwareVersion":"CAQoSPAGNL"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311212700000001",{"currentTime":"2022-01-23T11:21:27.123Z","interval":10,"status":"Accepted"}]
[INFO test_Recurrent_cpVoltN.py:69] 稍等5秒，等桩连上后台
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311212700000002","StatusNotification",{"connectorId":0,"status":"Available","errorCode":"NoError"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311212700000002",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311212700000003","StatusNotification",{"connectorId":1,"status":"Preparing","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311212700000003",{}]
[INFO test_Recurrent_cpVoltN.py:31] ========这是第22次开始执行========
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"506b7763-3993-4e96-9618-191a18be2efd","RemoteStartTransaction",{"idTag":"AE0022A1GM9C00066K","connectorId":1,"chargingProfile":{"chargingProfileId":1,"transactionId":1,"stackLevel":1,"chargingProfilePurpose":"ChargePointMaxProfile","chargingProfileKind":"Absolute","recurrencyKind":"Daily","validFrom":"date-time","validTo":"date-time","chargingSchedule":{"duration":10,"startSchedule":"date-time","chargingRateUnit":"W","chargingSchedulePeriod":[{"startPeriod":1,"limit":1.5,"numberPhases":1}],"minChargingRate":1.5}}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"506b7763-3993-4e96-9618-191a18be2efd",{"status":"Accepted"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311213500000004","Authorize",{"idTag":"AE0022A1GM9C00066K"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311213500000004",{"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311213800000005","StatusNotification",{"connectorId":1,"status":"Charging","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311213800000005",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311213900000006","StartTransaction",{"connectorId":1,"idTag":"AE0022A1GM9C00066K","meterStart":528242,"timestamp":"2022-01-23T11:21:38.000Z"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311213900000006",{"transactionId":1,"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311214000000007","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T11:21:40.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"211.850000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.350000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.950000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.010000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311214000000007",{}]
[INFO test_Recurrent_cpVoltN.py:52] ********正在充电********稍等约1分钟********
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"3f0724a0-a494-4c8a-bb98-d2bc482c161d","RemoteStopTransaction",{"transactionId":1}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311215100000008","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T11:21:51.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"211.840000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.350000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.950000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311215100000008",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311220100000009","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T11:22:21.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"211.740000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.340000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.950000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311220100000009",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"3f0724a0-a494-4c8a-bb98-d2bc482c161d",{"status":"Accepted"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231122390000000F","StopTransaction",{"idTag":"AE0022A1GM9C00066K","transactionId":1,"meterStop":528242,"timestamp":"2022-01-23T11:22:38.000Z","reason":"Remote"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231122390000000F",{"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231122110000000A","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T11:22:51.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231122110000000A",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231122210000000B","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T11:22:51.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231122210000000B",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231122310000000C","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T11:22:52.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231122310000000C",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231122320000000D","StatusNotification",{"connectorId":1,"status":"Preparing","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231122320000000D",{}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"874d8414-6aa8-4e29-8279-1edefb33c554","Reset",{"type":"Soft"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"874d8414-6aa8-4e29-8279-1edefb33c554",{"status":"Accepted"}]
[ERROR server.py:233] connection handler failed
Traceback (most recent call last):
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 944, in transfer_data
    message = await self.read_message()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1013, in read_message
    frame = await self.read_data_frame(max_size=self.max_size)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1089, in read_data_frame
    frame = await self.read_frame(max_size)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1148, in read_frame
    extensions=self.extensions,
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\framing.py", line 70, in read
    data = await reader(2)
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\streams.py", line 679, in readexactly
    await self._wait_for_data('readexactly')
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\streams.py", line 473, in _wait_for_data
    await self._waiter
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\selector_events.py", line 812, in _read_ready__data_received
    data = self._sock.recv(self.max_size)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\server.py", line 231, in handler
    await self.ws_handler(self)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\server.py", line 1137, in _ws_handler
    )(websocket, websocket.path)
  File "D:\workspace\ocpp_test\server\connect.py", line 156, in on_connect
    await Value.chargePoint.start()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\ocpp\charge_point.py", line 125, in start
    message = await self._connection.recv()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 552, in recv
    await self.ensure_open()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 920, in ensure_open
    raise self.connection_closed_exc()
websockets.exceptions.ConnectionClosedError: no close frame received or sent
[INFO server.py:259] connection closed
[INFO server.py:641] connection open
[INFO connect.py:146] Protocols Matched: ocpp1.6
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311231600000001","BootNotification",{"chargePointModel":"MaxiChargerAC","chargePointVendor":"Autel","firmwareVersion":"CAQoSPAGNL"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311231600000001",{"currentTime":"2022-01-23T11:23:17.123Z","interval":10,"status":"Accepted"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311231700000002","StatusNotification",{"connectorId":0,"status":"Available","errorCode":"NoError"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311231700000002",{}]
[INFO test_Recurrent_cpVoltN.py:69] 稍等5秒，等桩连上后台
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311231700000003","StatusNotification",{"connectorId":1,"status":"Preparing","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311231700000003",{}]
[INFO test_Recurrent_cpVoltN.py:31] ========这是第23次开始执行========
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"2b0ef75f-8278-47bb-ab0f-4ffb3d948b80","RemoteStartTransaction",{"idTag":"AE0022A1GM9C00066K","connectorId":1,"chargingProfile":{"chargingProfileId":1,"transactionId":1,"stackLevel":1,"chargingProfilePurpose":"ChargePointMaxProfile","chargingProfileKind":"Absolute","recurrencyKind":"Daily","validFrom":"date-time","validTo":"date-time","chargingSchedule":{"duration":10,"startSchedule":"date-time","chargingRateUnit":"W","chargingSchedulePeriod":[{"startPeriod":1,"limit":1.5,"numberPhases":1}],"minChargingRate":1.5}}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"2b0ef75f-8278-47bb-ab0f-4ffb3d948b80",{"status":"Accepted"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311232600000004","Authorize",{"idTag":"AE0022A1GM9C00066K"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311232600000004",{"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311232800000005","StatusNotification",{"connectorId":1,"status":"Charging","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311232800000005",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311232900000006","StartTransaction",{"connectorId":1,"idTag":"AE0022A1GM9C00066K","meterStart":528242,"timestamp":"2022-01-23T11:23:28.000Z"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311232900000006",{"transactionId":1,"idTagInfo":{"status":"Accepted"}}]
[INFO test_Recurrent_cpVoltN.py:52] ********正在充电********稍等约1分钟********
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"bfa23d4b-194a-4cce-8df2-6aa0075960db","RemoteStopTransaction",{"transactionId":1}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311233000000007","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T11:23:30.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"211.830000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.350000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.950000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311233000000007",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311234000000008","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T11:24:00.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"211.800000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.350000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.950000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311234000000008",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"bfa23d4b-194a-4cce-8df2-6aa0075960db",{"status":"Accepted"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231124270000000E","StopTransaction",{"idTag":"AE0022A1GM9C00066K","transactionId":1,"meterStop":528242,"timestamp":"2022-01-23T11:24:26.000Z","reason":"Remote"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231124270000000E",{"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311235100000009","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T11:24:30.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311235100000009",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231124010000000A","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T11:24:31.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231124010000000A",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231124110000000B","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T11:24:31.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.010000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231124110000000B",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231124190000000C","StatusNotification",{"connectorId":1,"status":"Preparing","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231124190000000C",{}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"bb802217-2fd1-4926-b6bb-1a1b7611640c","Reset",{"type":"Soft"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"bb802217-2fd1-4926-b6bb-1a1b7611640c",{"status":"Accepted"}]
[ERROR server.py:233] connection handler failed
Traceback (most recent call last):
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 944, in transfer_data
    message = await self.read_message()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1013, in read_message
    frame = await self.read_data_frame(max_size=self.max_size)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1089, in read_data_frame
    frame = await self.read_frame(max_size)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1148, in read_frame
    extensions=self.extensions,
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\framing.py", line 70, in read
    data = await reader(2)
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\streams.py", line 679, in readexactly
    await self._wait_for_data('readexactly')
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\streams.py", line 473, in _wait_for_data
    await self._waiter
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\selector_events.py", line 812, in _read_ready__data_received
    data = self._sock.recv(self.max_size)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\server.py", line 231, in handler
    await self.ws_handler(self)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\server.py", line 1137, in _ws_handler
    )(websocket, websocket.path)
  File "D:\workspace\ocpp_test\server\connect.py", line 156, in on_connect
    await Value.chargePoint.start()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\ocpp\charge_point.py", line 125, in start
    message = await self._connection.recv()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 552, in recv
    await self.ensure_open()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 920, in ensure_open
    raise self.connection_closed_exc()
websockets.exceptions.ConnectionClosedError: no close frame received or sent
[INFO server.py:259] connection closed
[INFO server.py:641] connection open
[INFO connect.py:146] Protocols Matched: ocpp1.6
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311245800000001","BootNotification",{"chargePointModel":"MaxiChargerAC","chargePointVendor":"Autel","firmwareVersion":"CAQoSPAGNL"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311245800000001",{"currentTime":"2022-01-23T11:24:59.123Z","interval":10,"status":"Accepted"}]
[INFO test_Recurrent_cpVoltN.py:69] 稍等5秒，等桩连上后台
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311245900000002","StatusNotification",{"connectorId":0,"status":"Available","errorCode":"NoError"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311245900000002",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311245900000003","StatusNotification",{"connectorId":1,"status":"Preparing","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311245900000003",{}]
[INFO test_Recurrent_cpVoltN.py:31] ========这是第24次开始执行========
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"dd509d1e-4bbf-442b-9c4a-a81164112459","RemoteStartTransaction",{"idTag":"AE0022A1GM9C00066K","connectorId":1,"chargingProfile":{"chargingProfileId":1,"transactionId":1,"stackLevel":1,"chargingProfilePurpose":"ChargePointMaxProfile","chargingProfileKind":"Absolute","recurrencyKind":"Daily","validFrom":"date-time","validTo":"date-time","chargingSchedule":{"duration":10,"startSchedule":"date-time","chargingRateUnit":"W","chargingSchedulePeriod":[{"startPeriod":1,"limit":1.5,"numberPhases":1}],"minChargingRate":1.5}}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"dd509d1e-4bbf-442b-9c4a-a81164112459",{"status":"Accepted"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311250800000004","Authorize",{"idTag":"AE0022A1GM9C00066K"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311250800000004",{"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311251000000006","StartTransaction",{"connectorId":1,"idTag":"AE0022A1GM9C00066K","meterStart":528242,"timestamp":"2022-01-23T11:25:10.000Z"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311251000000006",{"transactionId":1,"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311251000000005","StatusNotification",{"connectorId":1,"status":"Charging","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311251000000005",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311251200000007","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T11:25:12.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"211.500000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.330000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.950000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311251200000007",{}]
[INFO test_Recurrent_cpVoltN.py:52] ********正在充电********稍等约1分钟********
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"beff5d89-7de9-4aed-8c6e-0c908c132db5","RemoteStopTransaction",{"transactionId":1}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311252200000008","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T11:25:22.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"211.600000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.330000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.950000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311252200000008",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311253200000009","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T11:25:52.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"211.930000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.350000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.950000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311253200000009",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"beff5d89-7de9-4aed-8c6e-0c908c132db5",{"status":"Accepted"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231126120000000F","StopTransaction",{"idTag":"AE0022A1GM9C00066K","transactionId":1,"meterStop":528242,"timestamp":"2022-01-23T11:26:12.000Z","reason":"Remote"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231126120000000F",{"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231125430000000A","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T11:26:23.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231125430000000A",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231125530000000B","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T11:26:23.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231125530000000B",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231126030000000C","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T11:26:24.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231126030000000C",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231126040000000D","StatusNotification",{"connectorId":1,"status":"Preparing","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231126040000000D",{}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"ad92f8e6-a9dc-450c-96c7-2ca181f2b13c","Reset",{"type":"Soft"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"ad92f8e6-a9dc-450c-96c7-2ca181f2b13c",{"status":"Accepted"}]
[ERROR server.py:233] connection handler failed
Traceback (most recent call last):
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 944, in transfer_data
    message = await self.read_message()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1013, in read_message
    frame = await self.read_data_frame(max_size=self.max_size)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1089, in read_data_frame
    frame = await self.read_frame(max_size)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1148, in read_frame
    extensions=self.extensions,
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\framing.py", line 70, in read
    data = await reader(2)
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\streams.py", line 679, in readexactly
    await self._wait_for_data('readexactly')
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\streams.py", line 473, in _wait_for_data
    await self._waiter
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\selector_events.py", line 812, in _read_ready__data_received
    data = self._sock.recv(self.max_size)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\server.py", line 231, in handler
    await self.ws_handler(self)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\server.py", line 1137, in _ws_handler
    )(websocket, websocket.path)
  File "D:\workspace\ocpp_test\server\connect.py", line 156, in on_connect
    await Value.chargePoint.start()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\ocpp\charge_point.py", line 125, in start
    message = await self._connection.recv()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 552, in recv
    await self.ensure_open()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 920, in ensure_open
    raise self.connection_closed_exc()
websockets.exceptions.ConnectionClosedError: no close frame received or sent
[INFO server.py:259] connection closed
[INFO server.py:641] connection open
[INFO connect.py:146] Protocols Matched: ocpp1.6
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311264100000001","BootNotification",{"chargePointModel":"MaxiChargerAC","chargePointVendor":"Autel","firmwareVersion":"CAQoSPAGNL"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311264100000001",{"currentTime":"2022-01-23T11:26:42.123Z","interval":10,"status":"Accepted"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311264200000002","StatusNotification",{"connectorId":0,"status":"Available","errorCode":"NoError"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311264200000002",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311264200000003","StatusNotification",{"connectorId":1,"status":"Preparing","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311264200000003",{}]
[INFO test_Recurrent_cpVoltN.py:69] 稍等5秒，等桩连上后台
[INFO test_Recurrent_cpVoltN.py:31] ========这是第25次开始执行========
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"47f9163f-0da6-4186-ad24-add0cd565bee","RemoteStartTransaction",{"idTag":"AE0022A1GM9C00066K","connectorId":1,"chargingProfile":{"chargingProfileId":1,"transactionId":1,"stackLevel":1,"chargingProfilePurpose":"ChargePointMaxProfile","chargingProfileKind":"Absolute","recurrencyKind":"Daily","validFrom":"date-time","validTo":"date-time","chargingSchedule":{"duration":10,"startSchedule":"date-time","chargingRateUnit":"W","chargingSchedulePeriod":[{"startPeriod":1,"limit":1.5,"numberPhases":1}],"minChargingRate":1.5}}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"47f9163f-0da6-4186-ad24-add0cd565bee",{"status":"Accepted"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311264900000004","Authorize",{"idTag":"AE0022A1GM9C00066K"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311264900000004",{"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311265200000005","StatusNotification",{"connectorId":1,"status":"Charging","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311265200000005",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311265300000006","StartTransaction",{"connectorId":1,"idTag":"AE0022A1GM9C00066K","meterStart":528242,"timestamp":"2022-01-23T11:26:52.000Z"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311265300000006",{"transactionId":1,"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311265400000007","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T11:26:54.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"211.670000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.350000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.950000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311265400000007",{}]
[INFO test_Recurrent_cpVoltN.py:52] ********正在充电********稍等约1分钟********
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"eeaff35d-371d-4545-ac92-7d7cd8ec2072","RemoteStopTransaction",{"transactionId":1}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311270400000008","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T11:27:04.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"211.600000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.340000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.950000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311270400000008",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311271500000009","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T11:27:35.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"211.520000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.330000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.950000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311271500000009",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"eeaff35d-371d-4545-ac92-7d7cd8ec2072",{"status":"Accepted"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231127540000000F","StopTransaction",{"idTag":"AE0022A1GM9C00066K","transactionId":1,"meterStop":528242,"timestamp":"2022-01-23T11:27:53.000Z","reason":"Remote"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231127540000000F",{"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231127250000000A","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T11:28:05.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231127250000000A",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231127350000000B","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T11:28:05.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231127350000000B",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231127450000000C","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T11:28:06.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231127450000000C",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231127460000000D","StatusNotification",{"connectorId":1,"status":"Preparing","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231127460000000D",{}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"c6aac2d4-c77e-469b-a8c6-434bdf33b694","Reset",{"type":"Soft"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"c6aac2d4-c77e-469b-a8c6-434bdf33b694",{"status":"Accepted"}]
[ERROR server.py:233] connection handler failed
Traceback (most recent call last):
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 944, in transfer_data
    message = await self.read_message()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1013, in read_message
    frame = await self.read_data_frame(max_size=self.max_size)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1089, in read_data_frame
    frame = await self.read_frame(max_size)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1148, in read_frame
    extensions=self.extensions,
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\framing.py", line 70, in read
    data = await reader(2)
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\streams.py", line 679, in readexactly
    await self._wait_for_data('readexactly')
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\streams.py", line 473, in _wait_for_data
    await self._waiter
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\selector_events.py", line 812, in _read_ready__data_received
    data = self._sock.recv(self.max_size)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\server.py", line 231, in handler
    await self.ws_handler(self)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\server.py", line 1137, in _ws_handler
    )(websocket, websocket.path)
  File "D:\workspace\ocpp_test\server\connect.py", line 156, in on_connect
    await Value.chargePoint.start()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\ocpp\charge_point.py", line 125, in start
    message = await self._connection.recv()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 552, in recv
    await self.ensure_open()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 920, in ensure_open
    raise self.connection_closed_exc()
websockets.exceptions.ConnectionClosedError: no close frame received or sent
[INFO server.py:259] connection closed
[INFO server.py:641] connection open
[INFO connect.py:146] Protocols Matched: ocpp1.6
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311283100000001","BootNotification",{"chargePointModel":"MaxiChargerAC","chargePointVendor":"Autel","firmwareVersion":"CAQoSPAGNL"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311283100000001",{"currentTime":"2022-01-23T11:28:31.123Z","interval":10,"status":"Accepted"}]
[INFO test_Recurrent_cpVoltN.py:69] 稍等5秒，等桩连上后台
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311283100000002","StatusNotification",{"connectorId":0,"status":"Available","errorCode":"NoError"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311283100000002",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311283100000003","StatusNotification",{"connectorId":1,"status":"Preparing","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311283100000003",{}]
[INFO test_Recurrent_cpVoltN.py:31] ========这是第26次开始执行========
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"2bf38cdd-d2c0-47ff-b5c4-5c8c087fe567","RemoteStartTransaction",{"idTag":"AE0022A1GM9C00066K","connectorId":1,"chargingProfile":{"chargingProfileId":1,"transactionId":1,"stackLevel":1,"chargingProfilePurpose":"ChargePointMaxProfile","chargingProfileKind":"Absolute","recurrencyKind":"Daily","validFrom":"date-time","validTo":"date-time","chargingSchedule":{"duration":10,"startSchedule":"date-time","chargingRateUnit":"W","chargingSchedulePeriod":[{"startPeriod":1,"limit":1.5,"numberPhases":1}],"minChargingRate":1.5}}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"2bf38cdd-d2c0-47ff-b5c4-5c8c087fe567",{"status":"Accepted"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311283900000004","Authorize",{"idTag":"AE0022A1GM9C00066K"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311283900000004",{"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311284200000005","StatusNotification",{"connectorId":1,"status":"Charging","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311284200000005",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311284300000006","StartTransaction",{"connectorId":1,"idTag":"AE0022A1GM9C00066K","meterStart":528242,"timestamp":"2022-01-23T11:28:42.000Z"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311284300000006",{"transactionId":1,"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311284400000007","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T11:28:44.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"211.500000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.340000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.950000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311284400000007",{}]
[INFO test_Recurrent_cpVoltN.py:52] ********正在充电********稍等约1分钟********
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"461759d2-2f3f-4743-9633-9d2662cfe129","RemoteStopTransaction",{"transactionId":1}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311285400000008","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T11:28:54.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"211.480000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.330000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.950000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311285400000008",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311290500000009","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T11:29:25.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"211.890000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.340000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.950000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311290500000009",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"461759d2-2f3f-4743-9633-9d2662cfe129",{"status":"Accepted"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231129440000000F","StopTransaction",{"idTag":"AE0022A1GM9C00066K","transactionId":1,"meterStop":528242,"timestamp":"2022-01-23T11:29:43.000Z","reason":"Remote"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231129440000000F",{"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231129150000000A","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T11:29:55.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231129150000000A",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231129250000000B","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T11:29:56.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231129250000000B",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231129350000000C","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T11:29:56.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231129350000000C",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231129360000000D","StatusNotification",{"connectorId":1,"status":"Preparing","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231129360000000D",{}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"1955f909-7fa8-4ce3-bac4-d47b5e0e5975","Reset",{"type":"Soft"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"1955f909-7fa8-4ce3-bac4-d47b5e0e5975",{"status":"Accepted"}]
[ERROR server.py:233] connection handler failed
Traceback (most recent call last):
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 944, in transfer_data
    message = await self.read_message()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1013, in read_message
    frame = await self.read_data_frame(max_size=self.max_size)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1089, in read_data_frame
    frame = await self.read_frame(max_size)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1148, in read_frame
    extensions=self.extensions,
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\framing.py", line 70, in read
    data = await reader(2)
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\streams.py", line 679, in readexactly
    await self._wait_for_data('readexactly')
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\streams.py", line 473, in _wait_for_data
    await self._waiter
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\selector_events.py", line 812, in _read_ready__data_received
    data = self._sock.recv(self.max_size)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\server.py", line 231, in handler
    await self.ws_handler(self)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\server.py", line 1137, in _ws_handler
    )(websocket, websocket.path)
  File "D:\workspace\ocpp_test\server\connect.py", line 156, in on_connect
    await Value.chargePoint.start()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\ocpp\charge_point.py", line 125, in start
    message = await self._connection.recv()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 552, in recv
    await self.ensure_open()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 920, in ensure_open
    raise self.connection_closed_exc()
websockets.exceptions.ConnectionClosedError: no close frame received or sent
[INFO server.py:259] connection closed
[INFO server.py:641] connection open
[INFO connect.py:146] Protocols Matched: ocpp1.6
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311302100000001","BootNotification",{"chargePointModel":"MaxiChargerAC","chargePointVendor":"Autel","firmwareVersion":"CAQoSPAGNL"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311302100000001",{"currentTime":"2022-01-23T11:30:22.123Z","interval":10,"status":"Accepted"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311302200000002","StatusNotification",{"connectorId":0,"status":"Available","errorCode":"NoError"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311302200000002",{}]
[INFO test_Recurrent_cpVoltN.py:69] 稍等5秒，等桩连上后台
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311302200000003","StatusNotification",{"connectorId":1,"status":"Preparing","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311302200000003",{}]
[INFO test_Recurrent_cpVoltN.py:31] ========这是第27次开始执行========
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"1f613678-5d49-4c59-a236-cb25c0a39133","RemoteStartTransaction",{"idTag":"AE0022A1GM9C00066K","connectorId":1,"chargingProfile":{"chargingProfileId":1,"transactionId":1,"stackLevel":1,"chargingProfilePurpose":"ChargePointMaxProfile","chargingProfileKind":"Absolute","recurrencyKind":"Daily","validFrom":"date-time","validTo":"date-time","chargingSchedule":{"duration":10,"startSchedule":"date-time","chargingRateUnit":"W","chargingSchedulePeriod":[{"startPeriod":1,"limit":1.5,"numberPhases":1}],"minChargingRate":1.5}}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"1f613678-5d49-4c59-a236-cb25c0a39133",{"status":"Accepted"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311303100000004","Authorize",{"idTag":"AE0022A1GM9C00066K"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311303100000004",{"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311303300000005","StatusNotification",{"connectorId":1,"status":"Charging","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311303300000005",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311303400000006","StartTransaction",{"connectorId":1,"idTag":"AE0022A1GM9C00066K","meterStart":528242,"timestamp":"2022-01-23T11:30:33.000Z"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311303400000006",{"transactionId":1,"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311303600000007","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T11:30:36.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"211.860000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.350000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.950000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311303600000007",{}]
[INFO test_Recurrent_cpVoltN.py:52] ********正在充电********稍等约1分钟********
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"1e00a90a-b7cb-4de3-be8f-d3282913e248","RemoteStopTransaction",{"transactionId":1}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311304600000008","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T11:30:46.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"211.930000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.350000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.950000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311304600000008",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311305600000009","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T11:31:16.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"211.690000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.340000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.950000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311305600000009",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"1e00a90a-b7cb-4de3-be8f-d3282913e248",{"status":"Accepted"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231131350000000F","StopTransaction",{"idTag":"AE0022A1GM9C00066K","transactionId":1,"meterStop":528242,"timestamp":"2022-01-23T11:31:34.000Z","reason":"Remote"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231131350000000F",{"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231131060000000A","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T11:31:47.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231131060000000A",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231131170000000B","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T11:31:47.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231131170000000B",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231131270000000C","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T11:31:48.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231131270000000C",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231131270000000D","StatusNotification",{"connectorId":1,"status":"Preparing","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231131270000000D",{}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"4dbf6a35-55ce-4c46-85d7-4fb2d7eef124","Reset",{"type":"Soft"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"4dbf6a35-55ce-4c46-85d7-4fb2d7eef124",{"status":"Accepted"}]
[ERROR server.py:233] connection handler failed
Traceback (most recent call last):
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 944, in transfer_data
    message = await self.read_message()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1013, in read_message
    frame = await self.read_data_frame(max_size=self.max_size)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1089, in read_data_frame
    frame = await self.read_frame(max_size)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1148, in read_frame
    extensions=self.extensions,
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\framing.py", line 70, in read
    data = await reader(2)
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\streams.py", line 679, in readexactly
    await self._wait_for_data('readexactly')
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\streams.py", line 473, in _wait_for_data
    await self._waiter
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\selector_events.py", line 812, in _read_ready__data_received
    data = self._sock.recv(self.max_size)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\server.py", line 231, in handler
    await self.ws_handler(self)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\server.py", line 1137, in _ws_handler
    )(websocket, websocket.path)
  File "D:\workspace\ocpp_test\server\connect.py", line 156, in on_connect
    await Value.chargePoint.start()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\ocpp\charge_point.py", line 125, in start
    message = await self._connection.recv()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 552, in recv
    await self.ensure_open()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 920, in ensure_open
    raise self.connection_closed_exc()
websockets.exceptions.ConnectionClosedError: no close frame received or sent
[INFO server.py:259] connection closed
[INFO server.py:641] connection open
[INFO connect.py:146] Protocols Matched: ocpp1.6
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311321500000001","BootNotification",{"chargePointModel":"MaxiChargerAC","chargePointVendor":"Autel","firmwareVersion":"CAQoSPAGNL"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311321500000001",{"currentTime":"2022-01-23T11:32:15.123Z","interval":10,"status":"Accepted"}]
[INFO test_Recurrent_cpVoltN.py:69] 稍等5秒，等桩连上后台
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311321500000002","StatusNotification",{"connectorId":0,"status":"Available","errorCode":"NoError"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311321500000002",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311321500000003","StatusNotification",{"connectorId":1,"status":"Preparing","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311321500000003",{}]
[INFO test_Recurrent_cpVoltN.py:31] ========这是第28次开始执行========
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"0ef0aeed-4a81-457a-96a3-4741b34f5e43","RemoteStartTransaction",{"idTag":"AE0022A1GM9C00066K","connectorId":1,"chargingProfile":{"chargingProfileId":1,"transactionId":1,"stackLevel":1,"chargingProfilePurpose":"ChargePointMaxProfile","chargingProfileKind":"Absolute","recurrencyKind":"Daily","validFrom":"date-time","validTo":"date-time","chargingSchedule":{"duration":10,"startSchedule":"date-time","chargingRateUnit":"W","chargingSchedulePeriod":[{"startPeriod":1,"limit":1.5,"numberPhases":1}],"minChargingRate":1.5}}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"0ef0aeed-4a81-457a-96a3-4741b34f5e43",{"status":"Accepted"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311322300000004","Authorize",{"idTag":"AE0022A1GM9C00066K"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311322300000004",{"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311322600000005","StatusNotification",{"connectorId":1,"status":"Charging","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311322600000005",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311322700000006","StartTransaction",{"connectorId":1,"idTag":"AE0022A1GM9C00066K","meterStart":528242,"timestamp":"2022-01-23T11:32:26.000Z"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311322700000006",{"transactionId":1,"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311322800000007","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T11:32:28.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"211.850000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.350000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.950000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311322800000007",{}]
[INFO test_Recurrent_cpVoltN.py:52] ********正在充电********稍等约1分钟********
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"b071f5ad-aa5c-43b7-972a-f638bae2114a","RemoteStopTransaction",{"transactionId":1}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311323800000008","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T11:32:39.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"211.970000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.360000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.950000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311323800000008",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311324900000009","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T11:33:09.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"211.910000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.350000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.950000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311324900000009",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"b071f5ad-aa5c-43b7-972a-f638bae2114a",{"status":"Accepted"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231133270000000E","StopTransaction",{"idTag":"AE0022A1GM9C00066K","transactionId":1,"meterStop":528242,"timestamp":"2022-01-23T11:33:26.000Z","reason":"Remote"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231133270000000E",{"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231132590000000A","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T11:33:39.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231132590000000A",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231133090000000B","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T11:33:40.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231133090000000B",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231133200000000C","StatusNotification",{"connectorId":1,"status":"Preparing","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231133200000000C",{}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"1de26f3f-72ea-447e-85bd-8b0f8d873995","Reset",{"type":"Soft"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"1de26f3f-72ea-447e-85bd-8b0f8d873995",{"status":"Accepted"}]
[ERROR server.py:233] connection handler failed
Traceback (most recent call last):
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 944, in transfer_data
    message = await self.read_message()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1013, in read_message
    frame = await self.read_data_frame(max_size=self.max_size)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1089, in read_data_frame
    frame = await self.read_frame(max_size)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1148, in read_frame
    extensions=self.extensions,
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\framing.py", line 70, in read
    data = await reader(2)
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\streams.py", line 679, in readexactly
    await self._wait_for_data('readexactly')
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\streams.py", line 473, in _wait_for_data
    await self._waiter
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\selector_events.py", line 812, in _read_ready__data_received
    data = self._sock.recv(self.max_size)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\server.py", line 231, in handler
    await self.ws_handler(self)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\server.py", line 1137, in _ws_handler
    )(websocket, websocket.path)
  File "D:\workspace\ocpp_test\server\connect.py", line 156, in on_connect
    await Value.chargePoint.start()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\ocpp\charge_point.py", line 125, in start
    message = await self._connection.recv()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 552, in recv
    await self.ensure_open()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 920, in ensure_open
    raise self.connection_closed_exc()
websockets.exceptions.ConnectionClosedError: no close frame received or sent
[INFO server.py:259] connection closed
[INFO server.py:641] connection open
[INFO connect.py:146] Protocols Matched: ocpp1.6
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311340500000001","BootNotification",{"chargePointModel":"MaxiChargerAC","chargePointVendor":"Autel","firmwareVersion":"CAQoSPAGNL"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311340500000001",{"currentTime":"2022-01-23T11:34:06.123Z","interval":10,"status":"Accepted"}]
[INFO test_Recurrent_cpVoltN.py:69] 稍等5秒，等桩连上后台
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311340600000002","StatusNotification",{"connectorId":0,"status":"Available","errorCode":"NoError"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311340600000002",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311340600000003","StatusNotification",{"connectorId":1,"status":"Preparing","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311340600000003",{}]
[INFO test_Recurrent_cpVoltN.py:31] ========这是第29次开始执行========
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"5c694683-4935-4a63-a603-6295dfb9c8b4","RemoteStartTransaction",{"idTag":"AE0022A1GM9C00066K","connectorId":1,"chargingProfile":{"chargingProfileId":1,"transactionId":1,"stackLevel":1,"chargingProfilePurpose":"ChargePointMaxProfile","chargingProfileKind":"Absolute","recurrencyKind":"Daily","validFrom":"date-time","validTo":"date-time","chargingSchedule":{"duration":10,"startSchedule":"date-time","chargingRateUnit":"W","chargingSchedulePeriod":[{"startPeriod":1,"limit":1.5,"numberPhases":1}],"minChargingRate":1.5}}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"5c694683-4935-4a63-a603-6295dfb9c8b4",{"status":"Accepted"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311341400000004","Authorize",{"idTag":"AE0022A1GM9C00066K"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311341400000004",{"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311341700000005","StatusNotification",{"connectorId":1,"status":"Charging","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311341700000005",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311341800000006","StartTransaction",{"connectorId":1,"idTag":"AE0022A1GM9C00066K","meterStart":528242,"timestamp":"2022-01-23T11:34:17.000Z"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311341800000006",{"transactionId":1,"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311341900000007","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T11:34:19.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"211.650000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.340000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.950000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311341900000007",{}]
[INFO test_Recurrent_cpVoltN.py:52] ********正在充电********稍等约1分钟********
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"6a8af678-ce07-45f2-87a4-0e05cf9ea5ae","RemoteStopTransaction",{"transactionId":1}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311342900000008","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T11:34:29.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"211.810000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.350000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.950000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311342900000008",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311344000000009","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T11:35:00.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"212.030000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.360000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.950000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311344000000009",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"6a8af678-ce07-45f2-87a4-0e05cf9ea5ae",{"status":"Accepted"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231135180000000F","StopTransaction",{"idTag":"AE0022A1GM9C00066K","transactionId":1,"meterStop":528242,"timestamp":"2022-01-23T11:35:17.000Z","reason":"Remote"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231135180000000F",{"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231134500000000A","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T11:35:30.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231134500000000A",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231135000000000B","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T11:35:30.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231135000000000B",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231135100000000C","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T11:35:31.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231135100000000C",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231135100000000D","StatusNotification",{"connectorId":1,"status":"Preparing","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231135100000000D",{}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"83ce2a35-9603-4838-8353-ee45325edd51","Reset",{"type":"Soft"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"83ce2a35-9603-4838-8353-ee45325edd51",{"status":"Accepted"}]
[ERROR server.py:233] connection handler failed
Traceback (most recent call last):
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 944, in transfer_data
    message = await self.read_message()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1013, in read_message
    frame = await self.read_data_frame(max_size=self.max_size)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1089, in read_data_frame
    frame = await self.read_frame(max_size)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1148, in read_frame
    extensions=self.extensions,
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\framing.py", line 70, in read
    data = await reader(2)
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\streams.py", line 679, in readexactly
    await self._wait_for_data('readexactly')
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\streams.py", line 473, in _wait_for_data
    await self._waiter
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\selector_events.py", line 812, in _read_ready__data_received
    data = self._sock.recv(self.max_size)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\server.py", line 231, in handler
    await self.ws_handler(self)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\server.py", line 1137, in _ws_handler
    )(websocket, websocket.path)
  File "D:\workspace\ocpp_test\server\connect.py", line 156, in on_connect
    await Value.chargePoint.start()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\ocpp\charge_point.py", line 125, in start
    message = await self._connection.recv()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 552, in recv
    await self.ensure_open()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 920, in ensure_open
    raise self.connection_closed_exc()
websockets.exceptions.ConnectionClosedError: no close frame received or sent
[INFO server.py:259] connection closed
[INFO server.py:641] connection open
[INFO connect.py:146] Protocols Matched: ocpp1.6
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311355600000001","BootNotification",{"chargePointModel":"MaxiChargerAC","chargePointVendor":"Autel","firmwareVersion":"CAQoSPAGNL"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311355600000001",{"currentTime":"2022-01-23T11:35:57.123Z","interval":10,"status":"Accepted"}]
[INFO test_Recurrent_cpVoltN.py:69] 稍等5秒，等桩连上后台
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311355700000002","StatusNotification",{"connectorId":0,"status":"Available","errorCode":"NoError"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311355700000002",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311355700000003","StatusNotification",{"connectorId":1,"status":"Preparing","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311355700000003",{}]
[INFO test_Recurrent_cpVoltN.py:31] ========这是第30次开始执行========
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"e2607043-cbdc-451d-b480-733a9544c213","RemoteStartTransaction",{"idTag":"AE0022A1GM9C00066K","connectorId":1,"chargingProfile":{"chargingProfileId":1,"transactionId":1,"stackLevel":1,"chargingProfilePurpose":"ChargePointMaxProfile","chargingProfileKind":"Absolute","recurrencyKind":"Daily","validFrom":"date-time","validTo":"date-time","chargingSchedule":{"duration":10,"startSchedule":"date-time","chargingRateUnit":"W","chargingSchedulePeriod":[{"startPeriod":1,"limit":1.5,"numberPhases":1}],"minChargingRate":1.5}}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"e2607043-cbdc-451d-b480-733a9544c213",{"status":"Accepted"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311360500000004","Authorize",{"idTag":"AE0022A1GM9C00066K"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311360500000004",{"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311360800000005","StatusNotification",{"connectorId":1,"status":"Charging","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311360800000005",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311360900000006","StartTransaction",{"connectorId":1,"idTag":"AE0022A1GM9C00066K","meterStart":528242,"timestamp":"2022-01-23T11:36:08.000Z"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311360900000006",{"transactionId":1,"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311361000000007","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T11:36:10.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"211.460000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.340000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.950000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311361000000007",{}]
[INFO test_Recurrent_cpVoltN.py:52] ********正在充电********稍等约1分钟********
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"45a9c3e8-8ec0-4019-a92e-10501375ea95","RemoteStopTransaction",{"transactionId":1}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311362000000008","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T11:36:20.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"211.880000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.350000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.950000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311362000000008",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311363100000009","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T11:36:51.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"211.720000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.340000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.950000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311363100000009",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"45a9c3e8-8ec0-4019-a92e-10501375ea95",{"status":"Accepted"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231137090000000E","StopTransaction",{"idTag":"AE0022A1GM9C00066K","transactionId":1,"meterStop":528242,"timestamp":"2022-01-23T11:37:08.000Z","reason":"Remote"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231137090000000E",{"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231136410000000A","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T11:37:21.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231136410000000A",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231136510000000B","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T11:37:21.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231136510000000B",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231137020000000C","StatusNotification",{"connectorId":1,"status":"Preparing","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231137020000000C",{}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"16bc68fc-458c-410a-97a5-d5857cc10bbc","Reset",{"type":"Soft"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"16bc68fc-458c-410a-97a5-d5857cc10bbc",{"status":"Accepted"}]
[ERROR server.py:233] connection handler failed
Traceback (most recent call last):
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 944, in transfer_data
    message = await self.read_message()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1013, in read_message
    frame = await self.read_data_frame(max_size=self.max_size)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1089, in read_data_frame
    frame = await self.read_frame(max_size)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1148, in read_frame
    extensions=self.extensions,
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\framing.py", line 70, in read
    data = await reader(2)
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\streams.py", line 679, in readexactly
    await self._wait_for_data('readexactly')
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\streams.py", line 473, in _wait_for_data
    await self._waiter
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\selector_events.py", line 812, in _read_ready__data_received
    data = self._sock.recv(self.max_size)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\server.py", line 231, in handler
    await self.ws_handler(self)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\server.py", line 1137, in _ws_handler
    )(websocket, websocket.path)
  File "D:\workspace\ocpp_test\server\connect.py", line 156, in on_connect
    await Value.chargePoint.start()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\ocpp\charge_point.py", line 125, in start
    message = await self._connection.recv()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 552, in recv
    await self.ensure_open()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 920, in ensure_open
    raise self.connection_closed_exc()
websockets.exceptions.ConnectionClosedError: no close frame received or sent
[INFO server.py:259] connection closed
[INFO server.py:641] connection open
[INFO connect.py:146] Protocols Matched: ocpp1.6
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311374600000001","BootNotification",{"chargePointModel":"MaxiChargerAC","chargePointVendor":"Autel","firmwareVersion":"CAQoSPAGNL"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311374600000001",{"currentTime":"2022-01-23T11:37:47.123Z","interval":10,"status":"Accepted"}]
[INFO test_Recurrent_cpVoltN.py:69] 稍等5秒，等桩连上后台
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311374700000002","StatusNotification",{"connectorId":0,"status":"Available","errorCode":"NoError"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311374700000002",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311374700000003","StatusNotification",{"connectorId":1,"status":"Preparing","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311374700000003",{}]
[INFO test_Recurrent_cpVoltN.py:31] ========这是第31次开始执行========
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"785cd9cf-46ea-4646-91d1-29bbdfb1af5d","RemoteStartTransaction",{"idTag":"AE0022A1GM9C00066K","connectorId":1,"chargingProfile":{"chargingProfileId":1,"transactionId":1,"stackLevel":1,"chargingProfilePurpose":"ChargePointMaxProfile","chargingProfileKind":"Absolute","recurrencyKind":"Daily","validFrom":"date-time","validTo":"date-time","chargingSchedule":{"duration":10,"startSchedule":"date-time","chargingRateUnit":"W","chargingSchedulePeriod":[{"startPeriod":1,"limit":1.5,"numberPhases":1}],"minChargingRate":1.5}}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"785cd9cf-46ea-4646-91d1-29bbdfb1af5d",{"status":"Accepted"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311375500000004","Authorize",{"idTag":"AE0022A1GM9C00066K"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311375500000004",{"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311375800000005","StatusNotification",{"connectorId":1,"status":"Charging","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311375800000005",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311375900000006","StartTransaction",{"connectorId":1,"idTag":"AE0022A1GM9C00066K","meterStart":528242,"timestamp":"2022-01-23T11:37:58.000Z"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311375900000006",{"transactionId":1,"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311380000000007","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T11:38:01.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"211.660000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.340000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.950000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311380000000007",{}]
[INFO test_Recurrent_cpVoltN.py:52] ********正在充电********稍等约1分钟********
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"a4737d64-f10b-4be4-8738-65c28f727bbc","RemoteStopTransaction",{"transactionId":1}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311381100000008","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T11:38:11.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"212.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.360000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.960000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311381100000008",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311382100000009","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T11:38:41.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"211.880000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.350000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.950000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311382100000009",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"a4737d64-f10b-4be4-8738-65c28f727bbc",{"status":"Accepted"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231138590000000E","StopTransaction",{"idTag":"AE0022A1GM9C00066K","transactionId":1,"meterStop":528242,"timestamp":"2022-01-23T11:38:58.000Z","reason":"Remote"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231138590000000E",{"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231138310000000A","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T11:39:12.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231138310000000A",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231138420000000B","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T11:39:12.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231138420000000B",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231138520000000C","StatusNotification",{"connectorId":1,"status":"Preparing","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231138520000000C",{}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"960e0ba2-b36e-428b-8a79-54022897a1e7","Reset",{"type":"Soft"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"960e0ba2-b36e-428b-8a79-54022897a1e7",{"status":"Accepted"}]
[ERROR server.py:233] connection handler failed
Traceback (most recent call last):
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 944, in transfer_data
    message = await self.read_message()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1013, in read_message
    frame = await self.read_data_frame(max_size=self.max_size)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1089, in read_data_frame
    frame = await self.read_frame(max_size)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1148, in read_frame
    extensions=self.extensions,
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\framing.py", line 70, in read
    data = await reader(2)
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\streams.py", line 679, in readexactly
    await self._wait_for_data('readexactly')
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\streams.py", line 473, in _wait_for_data
    await self._waiter
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\selector_events.py", line 812, in _read_ready__data_received
    data = self._sock.recv(self.max_size)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\server.py", line 231, in handler
    await self.ws_handler(self)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\server.py", line 1137, in _ws_handler
    )(websocket, websocket.path)
  File "D:\workspace\ocpp_test\server\connect.py", line 156, in on_connect
    await Value.chargePoint.start()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\ocpp\charge_point.py", line 125, in start
    message = await self._connection.recv()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 552, in recv
    await self.ensure_open()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 920, in ensure_open
    raise self.connection_closed_exc()
websockets.exceptions.ConnectionClosedError: no close frame received or sent
[INFO server.py:259] connection closed
[INFO server.py:641] connection open
[INFO connect.py:146] Protocols Matched: ocpp1.6
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311393700000001","BootNotification",{"chargePointModel":"MaxiChargerAC","chargePointVendor":"Autel","firmwareVersion":"CAQoSPAGNL"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311393700000001",{"currentTime":"2022-01-23T11:39:37.123Z","interval":10,"status":"Accepted"}]
[INFO test_Recurrent_cpVoltN.py:69] 稍等5秒，等桩连上后台
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311393700000002","StatusNotification",{"connectorId":0,"status":"Available","errorCode":"NoError"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311393700000002",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311393700000003","StatusNotification",{"connectorId":1,"status":"Preparing","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311393700000003",{}]
[INFO test_Recurrent_cpVoltN.py:31] ========这是第32次开始执行========
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"2fbc4b50-0c5a-4738-bbfa-edfdc23c8249","RemoteStartTransaction",{"idTag":"AE0022A1GM9C00066K","connectorId":1,"chargingProfile":{"chargingProfileId":1,"transactionId":1,"stackLevel":1,"chargingProfilePurpose":"ChargePointMaxProfile","chargingProfileKind":"Absolute","recurrencyKind":"Daily","validFrom":"date-time","validTo":"date-time","chargingSchedule":{"duration":10,"startSchedule":"date-time","chargingRateUnit":"W","chargingSchedulePeriod":[{"startPeriod":1,"limit":1.5,"numberPhases":1}],"minChargingRate":1.5}}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"2fbc4b50-0c5a-4738-bbfa-edfdc23c8249",{"status":"Accepted"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311394600000004","Authorize",{"idTag":"AE0022A1GM9C00066K"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311394600000004",{"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311394800000005","StatusNotification",{"connectorId":1,"status":"Charging","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311394800000005",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311394900000006","StartTransaction",{"connectorId":1,"idTag":"AE0022A1GM9C00066K","meterStart":528242,"timestamp":"2022-01-23T11:39:48.000Z"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311394900000006",{"transactionId":1,"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311395000000007","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T11:39:50.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"211.930000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.340000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.950000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311395000000007",{}]
[INFO test_Recurrent_cpVoltN.py:52] ********正在充电********稍等约1分钟********
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"d4def20a-32ec-40c9-a2a9-2c2cd0022b18","RemoteStopTransaction",{"transactionId":1}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311400100000008","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T11:40:01.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"212.180000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.360000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.960000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311400100000008",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311401100000009","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T11:40:31.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"211.890000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.350000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.950000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311401100000009",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"d4def20a-32ec-40c9-a2a9-2c2cd0022b18",{"status":"Accepted"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231140510000000F","StopTransaction",{"idTag":"AE0022A1GM9C00066K","transactionId":1,"meterStop":528242,"timestamp":"2022-01-23T11:40:49.000Z","reason":"Remote"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231140510000000F",{"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231140210000000A","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T11:41:01.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231140210000000A",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231140320000000B","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T11:41:02.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231140320000000B",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231140420000000C","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T11:41:02.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231140420000000C",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231140420000000D","StatusNotification",{"connectorId":1,"status":"Preparing","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231140420000000D",{}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"3e1f88aa-7456-4f4e-bad8-25f316fdd852","Reset",{"type":"Soft"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"3e1f88aa-7456-4f4e-bad8-25f316fdd852",{"status":"Accepted"}]
[ERROR server.py:233] connection handler failed
Traceback (most recent call last):
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 944, in transfer_data
    message = await self.read_message()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1013, in read_message
    frame = await self.read_data_frame(max_size=self.max_size)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1089, in read_data_frame
    frame = await self.read_frame(max_size)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1148, in read_frame
    extensions=self.extensions,
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\framing.py", line 70, in read
    data = await reader(2)
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\streams.py", line 679, in readexactly
    await self._wait_for_data('readexactly')
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\streams.py", line 473, in _wait_for_data
    await self._waiter
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\selector_events.py", line 812, in _read_ready__data_received
    data = self._sock.recv(self.max_size)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\server.py", line 231, in handler
    await self.ws_handler(self)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\server.py", line 1137, in _ws_handler
    )(websocket, websocket.path)
  File "D:\workspace\ocpp_test\server\connect.py", line 156, in on_connect
    await Value.chargePoint.start()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\ocpp\charge_point.py", line 125, in start
    message = await self._connection.recv()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 552, in recv
    await self.ensure_open()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 920, in ensure_open
    raise self.connection_closed_exc()
websockets.exceptions.ConnectionClosedError: no close frame received or sent
[INFO server.py:259] connection closed
[INFO server.py:641] connection open
[INFO connect.py:146] Protocols Matched: ocpp1.6
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311412700000001","BootNotification",{"chargePointModel":"MaxiChargerAC","chargePointVendor":"Autel","firmwareVersion":"CAQoSPAGNL"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311412700000001",{"currentTime":"2022-01-23T11:41:28.123Z","interval":10,"status":"Accepted"}]
[INFO test_Recurrent_cpVoltN.py:69] 稍等5秒，等桩连上后台
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311412800000002","StatusNotification",{"connectorId":0,"status":"Available","errorCode":"NoError"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311412800000002",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311412800000003","StatusNotification",{"connectorId":1,"status":"Preparing","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311412800000003",{}]
[INFO test_Recurrent_cpVoltN.py:31] ========这是第33次开始执行========
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"67b849c4-6d62-41ed-908a-19b37eb6fe66","RemoteStartTransaction",{"idTag":"AE0022A1GM9C00066K","connectorId":1,"chargingProfile":{"chargingProfileId":1,"transactionId":1,"stackLevel":1,"chargingProfilePurpose":"ChargePointMaxProfile","chargingProfileKind":"Absolute","recurrencyKind":"Daily","validFrom":"date-time","validTo":"date-time","chargingSchedule":{"duration":10,"startSchedule":"date-time","chargingRateUnit":"W","chargingSchedulePeriod":[{"startPeriod":1,"limit":1.5,"numberPhases":1}],"minChargingRate":1.5}}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"67b849c4-6d62-41ed-908a-19b37eb6fe66",{"status":"Accepted"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311413600000004","Authorize",{"idTag":"AE0022A1GM9C00066K"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311413600000004",{"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311413900000005","StatusNotification",{"connectorId":1,"status":"Charging","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311413900000005",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311414000000006","StartTransaction",{"connectorId":1,"idTag":"AE0022A1GM9C00066K","meterStart":528242,"timestamp":"2022-01-23T11:41:39.000Z"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311414000000006",{"transactionId":1,"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311414100000007","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T11:41:41.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"212.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.350000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.950000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311414100000007",{}]
[INFO test_Recurrent_cpVoltN.py:52] ********正在充电********稍等约1分钟********
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"427cb45b-794c-4d17-9a73-b3f6f2288c9b","RemoteStopTransaction",{"transactionId":1}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311415200000008","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T11:41:52.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"212.120000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.360000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.950000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311415200000008",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311420200000009","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T11:42:22.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"212.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.360000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.950000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311420200000009",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"427cb45b-794c-4d17-9a73-b3f6f2288c9b",{"status":"Accepted"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231142400000000F","StopTransaction",{"idTag":"AE0022A1GM9C00066K","transactionId":1,"meterStop":528242,"timestamp":"2022-01-23T11:42:39.000Z","reason":"Remote"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231142400000000F",{"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231142120000000A","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T11:42:52.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231142120000000A",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231142220000000B","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T11:42:53.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231142220000000B",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231142320000000C","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T11:42:53.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231142320000000C",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231142330000000D","StatusNotification",{"connectorId":1,"status":"Preparing","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231142330000000D",{}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"3ba5ff1c-f7a0-4d40-afa8-8f69604214c1","Reset",{"type":"Soft"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"3ba5ff1c-f7a0-4d40-afa8-8f69604214c1",{"status":"Accepted"}]
[ERROR server.py:233] connection handler failed
Traceback (most recent call last):
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 944, in transfer_data
    message = await self.read_message()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1013, in read_message
    frame = await self.read_data_frame(max_size=self.max_size)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1089, in read_data_frame
    frame = await self.read_frame(max_size)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1148, in read_frame
    extensions=self.extensions,
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\framing.py", line 70, in read
    data = await reader(2)
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\streams.py", line 679, in readexactly
    await self._wait_for_data('readexactly')
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\streams.py", line 473, in _wait_for_data
    await self._waiter
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\selector_events.py", line 812, in _read_ready__data_received
    data = self._sock.recv(self.max_size)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\server.py", line 231, in handler
    await self.ws_handler(self)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\server.py", line 1137, in _ws_handler
    )(websocket, websocket.path)
  File "D:\workspace\ocpp_test\server\connect.py", line 156, in on_connect
    await Value.chargePoint.start()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\ocpp\charge_point.py", line 125, in start
    message = await self._connection.recv()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 552, in recv
    await self.ensure_open()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 920, in ensure_open
    raise self.connection_closed_exc()
websockets.exceptions.ConnectionClosedError: no close frame received or sent
[INFO server.py:259] connection closed
[INFO server.py:641] connection open
[INFO connect.py:146] Protocols Matched: ocpp1.6
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311432100000001","BootNotification",{"chargePointModel":"MaxiChargerAC","chargePointVendor":"Autel","firmwareVersion":"CAQoSPAGNL"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311432100000001",{"currentTime":"2022-01-23T11:43:22.123Z","interval":10,"status":"Accepted"}]
[INFO test_Recurrent_cpVoltN.py:69] 稍等5秒，等桩连上后台
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311432200000002","StatusNotification",{"connectorId":0,"status":"Available","errorCode":"NoError"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311432200000002",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311432200000003","StatusNotification",{"connectorId":1,"status":"Preparing","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311432200000003",{}]
[INFO test_Recurrent_cpVoltN.py:31] ========这是第34次开始执行========
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"b0ea39a7-4088-4cea-96be-663543cb6ec9","RemoteStartTransaction",{"idTag":"AE0022A1GM9C00066K","connectorId":1,"chargingProfile":{"chargingProfileId":1,"transactionId":1,"stackLevel":1,"chargingProfilePurpose":"ChargePointMaxProfile","chargingProfileKind":"Absolute","recurrencyKind":"Daily","validFrom":"date-time","validTo":"date-time","chargingSchedule":{"duration":10,"startSchedule":"date-time","chargingRateUnit":"W","chargingSchedulePeriod":[{"startPeriod":1,"limit":1.5,"numberPhases":1}],"minChargingRate":1.5}}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"b0ea39a7-4088-4cea-96be-663543cb6ec9",{"status":"Accepted"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311433000000004","Authorize",{"idTag":"AE0022A1GM9C00066K"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311433000000004",{"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311433300000005","StatusNotification",{"connectorId":1,"status":"Charging","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311433300000005",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311433400000006","StartTransaction",{"connectorId":1,"idTag":"AE0022A1GM9C00066K","meterStart":528242,"timestamp":"2022-01-23T11:43:33.000Z"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311433400000006",{"transactionId":1,"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311433500000007","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T11:43:35.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"212.230000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.360000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.950000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311433500000007",{}]
[INFO test_Recurrent_cpVoltN.py:52] ********正在充电********稍等约1分钟********
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"0e578c01-1e9b-4d4d-9a49-96c9c554f31e","RemoteStopTransaction",{"transactionId":1}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311434500000008","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T11:43:45.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"212.270000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.360000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.960000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311434500000008",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311435600000009","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T11:44:15.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"212.260000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.360000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.960000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311435600000009",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"0e578c01-1e9b-4d4d-9a49-96c9c554f31e",{"status":"Accepted"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231144340000000E","StopTransaction",{"idTag":"AE0022A1GM9C00066K","transactionId":1,"meterStop":528242,"timestamp":"2022-01-23T11:44:33.000Z","reason":"Remote"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231144340000000E",{"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231144060000000A","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T11:44:45.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231144060000000A",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231144160000000B","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T11:44:46.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231144160000000B",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231144270000000C","StatusNotification",{"connectorId":1,"status":"Preparing","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231144270000000C",{}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"1bb0bf75-fce6-4a1e-85ba-535350715f1f","Reset",{"type":"Soft"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"1bb0bf75-fce6-4a1e-85ba-535350715f1f",{"status":"Accepted"}]
[ERROR server.py:233] connection handler failed
Traceback (most recent call last):
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 944, in transfer_data
    message = await self.read_message()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1013, in read_message
    frame = await self.read_data_frame(max_size=self.max_size)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1089, in read_data_frame
    frame = await self.read_frame(max_size)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1148, in read_frame
    extensions=self.extensions,
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\framing.py", line 70, in read
    data = await reader(2)
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\streams.py", line 679, in readexactly
    await self._wait_for_data('readexactly')
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\streams.py", line 473, in _wait_for_data
    await self._waiter
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\selector_events.py", line 812, in _read_ready__data_received
    data = self._sock.recv(self.max_size)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\server.py", line 231, in handler
    await self.ws_handler(self)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\server.py", line 1137, in _ws_handler
    )(websocket, websocket.path)
  File "D:\workspace\ocpp_test\server\connect.py", line 156, in on_connect
    await Value.chargePoint.start()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\ocpp\charge_point.py", line 125, in start
    message = await self._connection.recv()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 552, in recv
    await self.ensure_open()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 920, in ensure_open
    raise self.connection_closed_exc()
websockets.exceptions.ConnectionClosedError: no close frame received or sent
[INFO server.py:259] connection closed
[INFO server.py:641] connection open
[INFO connect.py:146] Protocols Matched: ocpp1.6
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311451100000001","BootNotification",{"chargePointModel":"MaxiChargerAC","chargePointVendor":"Autel","firmwareVersion":"CAQoSPAGNL"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311451100000001",{"currentTime":"2022-01-23T11:45:12.123Z","interval":10,"status":"Accepted"}]
[INFO test_Recurrent_cpVoltN.py:69] 稍等5秒，等桩连上后台
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311451200000002","StatusNotification",{"connectorId":0,"status":"Available","errorCode":"NoError"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311451200000002",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311451200000003","StatusNotification",{"connectorId":1,"status":"Preparing","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311451200000003",{}]
[INFO test_Recurrent_cpVoltN.py:31] ========这是第35次开始执行========
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"c0b55b9e-da0b-46f7-b0ad-ebd4ae6f0b1a","RemoteStartTransaction",{"idTag":"AE0022A1GM9C00066K","connectorId":1,"chargingProfile":{"chargingProfileId":1,"transactionId":1,"stackLevel":1,"chargingProfilePurpose":"ChargePointMaxProfile","chargingProfileKind":"Absolute","recurrencyKind":"Daily","validFrom":"date-time","validTo":"date-time","chargingSchedule":{"duration":10,"startSchedule":"date-time","chargingRateUnit":"W","chargingSchedulePeriod":[{"startPeriod":1,"limit":1.5,"numberPhases":1}],"minChargingRate":1.5}}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"c0b55b9e-da0b-46f7-b0ad-ebd4ae6f0b1a",{"status":"Accepted"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311452000000004","Authorize",{"idTag":"AE0022A1GM9C00066K"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311452000000004",{"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311452300000006","StartTransaction",{"connectorId":1,"idTag":"AE0022A1GM9C00066K","meterStart":528242,"timestamp":"2022-01-23T11:45:23.000Z"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311452300000006",{"transactionId":1,"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311452300000005","StatusNotification",{"connectorId":1,"status":"Charging","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311452300000005",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311452400000007","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T11:45:25.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"212.030000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.350000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.950000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311452400000007",{}]
[INFO test_Recurrent_cpVoltN.py:52] ********正在充电********稍等约1分钟********
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"c771164e-792f-45b7-b0b1-bd5ccf1035bb","RemoteStopTransaction",{"transactionId":1}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311453500000008","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T11:45:35.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"212.260000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.360000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.950000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311453500000008",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311454500000009","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T11:46:05.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"212.330000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.370000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.960000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311454500000009",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"c771164e-792f-45b7-b0b1-bd5ccf1035bb",{"status":"Accepted"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231146240000000F","StopTransaction",{"idTag":"AE0022A1GM9C00066K","transactionId":1,"meterStop":528242,"timestamp":"2022-01-23T11:46:23.000Z","reason":"Remote"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231146240000000F",{"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231145550000000A","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T11:46:35.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231145550000000A",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231146050000000B","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T11:46:36.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231146050000000B",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231146160000000C","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T11:46:36.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231146160000000C",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231146170000000D","StatusNotification",{"connectorId":1,"status":"Preparing","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231146170000000D",{}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"d00edb99-fd2a-45fa-a0f7-9e6a35bd1569","Reset",{"type":"Soft"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"d00edb99-fd2a-45fa-a0f7-9e6a35bd1569",{"status":"Accepted"}]
[ERROR server.py:233] connection handler failed
Traceback (most recent call last):
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 944, in transfer_data
    message = await self.read_message()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1013, in read_message
    frame = await self.read_data_frame(max_size=self.max_size)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1089, in read_data_frame
    frame = await self.read_frame(max_size)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1148, in read_frame
    extensions=self.extensions,
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\framing.py", line 70, in read
    data = await reader(2)
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\streams.py", line 679, in readexactly
    await self._wait_for_data('readexactly')
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\streams.py", line 473, in _wait_for_data
    await self._waiter
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\selector_events.py", line 812, in _read_ready__data_received
    data = self._sock.recv(self.max_size)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\server.py", line 231, in handler
    await self.ws_handler(self)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\server.py", line 1137, in _ws_handler
    )(websocket, websocket.path)
  File "D:\workspace\ocpp_test\server\connect.py", line 156, in on_connect
    await Value.chargePoint.start()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\ocpp\charge_point.py", line 125, in start
    message = await self._connection.recv()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 552, in recv
    await self.ensure_open()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 920, in ensure_open
    raise self.connection_closed_exc()
websockets.exceptions.ConnectionClosedError: no close frame received or sent
[INFO server.py:259] connection closed
[INFO server.py:641] connection open
[INFO connect.py:146] Protocols Matched: ocpp1.6
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311470200000001","BootNotification",{"chargePointModel":"MaxiChargerAC","chargePointVendor":"Autel","firmwareVersion":"CAQoSPAGNL"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311470200000001",{"currentTime":"2022-01-23T11:47:02.123Z","interval":10,"status":"Accepted"}]
[INFO test_Recurrent_cpVoltN.py:69] 稍等5秒，等桩连上后台
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311470200000002","StatusNotification",{"connectorId":0,"status":"Available","errorCode":"NoError"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311470200000002",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311470200000003","StatusNotification",{"connectorId":1,"status":"Preparing","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311470200000003",{}]
[INFO test_Recurrent_cpVoltN.py:31] ========这是第36次开始执行========
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"1e2c9f95-e34f-45c2-83be-d543a7a26a31","RemoteStartTransaction",{"idTag":"AE0022A1GM9C00066K","connectorId":1,"chargingProfile":{"chargingProfileId":1,"transactionId":1,"stackLevel":1,"chargingProfilePurpose":"ChargePointMaxProfile","chargingProfileKind":"Absolute","recurrencyKind":"Daily","validFrom":"date-time","validTo":"date-time","chargingSchedule":{"duration":10,"startSchedule":"date-time","chargingRateUnit":"W","chargingSchedulePeriod":[{"startPeriod":1,"limit":1.5,"numberPhases":1}],"minChargingRate":1.5}}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"1e2c9f95-e34f-45c2-83be-d543a7a26a31",{"status":"Accepted"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311471000000004","Authorize",{"idTag":"AE0022A1GM9C00066K"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311471000000004",{"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311471300000005","StatusNotification",{"connectorId":1,"status":"Charging","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311471300000005",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311471400000006","StartTransaction",{"connectorId":1,"idTag":"AE0022A1GM9C00066K","meterStart":528242,"timestamp":"2022-01-23T11:47:13.000Z"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311471400000006",{"transactionId":1,"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311471500000007","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T11:47:15.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"211.980000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.350000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.950000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311471500000007",{}]
[INFO test_Recurrent_cpVoltN.py:52] ********正在充电********稍等约1分钟********
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"5440d596-02b5-482f-85de-ed5bfe63f019","RemoteStopTransaction",{"transactionId":1}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311472500000008","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T11:47:25.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"212.150000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.360000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.950000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311472500000008",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311473500000009","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T11:47:55.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"212.290000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.370000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.950000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311473500000009",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"5440d596-02b5-482f-85de-ed5bfe63f019",{"status":"Accepted"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231148150000000F","StopTransaction",{"idTag":"AE0022A1GM9C00066K","transactionId":1,"meterStop":528242,"timestamp":"2022-01-23T11:48:14.000Z","reason":"Remote"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231148150000000F",{"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231147460000000A","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T11:48:26.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231147460000000A",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231147560000000B","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T11:48:26.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231147560000000B",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231148060000000C","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T11:48:27.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231148060000000C",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231148070000000D","StatusNotification",{"connectorId":1,"status":"Preparing","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231148070000000D",{}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"795947e4-47d2-4293-a17e-222701aeabf8","Reset",{"type":"Soft"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"795947e4-47d2-4293-a17e-222701aeabf8",{"status":"Accepted"}]
[ERROR server.py:233] connection handler failed
Traceback (most recent call last):
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 944, in transfer_data
    message = await self.read_message()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1013, in read_message
    frame = await self.read_data_frame(max_size=self.max_size)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1089, in read_data_frame
    frame = await self.read_frame(max_size)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1148, in read_frame
    extensions=self.extensions,
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\framing.py", line 70, in read
    data = await reader(2)
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\streams.py", line 679, in readexactly
    await self._wait_for_data('readexactly')
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\streams.py", line 473, in _wait_for_data
    await self._waiter
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\selector_events.py", line 812, in _read_ready__data_received
    data = self._sock.recv(self.max_size)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\server.py", line 231, in handler
    await self.ws_handler(self)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\server.py", line 1137, in _ws_handler
    )(websocket, websocket.path)
  File "D:\workspace\ocpp_test\server\connect.py", line 156, in on_connect
    await Value.chargePoint.start()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\ocpp\charge_point.py", line 125, in start
    message = await self._connection.recv()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 552, in recv
    await self.ensure_open()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 920, in ensure_open
    raise self.connection_closed_exc()
websockets.exceptions.ConnectionClosedError: no close frame received or sent
[INFO server.py:259] connection closed
[INFO server.py:641] connection open
[INFO connect.py:146] Protocols Matched: ocpp1.6
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311485200000001","BootNotification",{"chargePointModel":"MaxiChargerAC","chargePointVendor":"Autel","firmwareVersion":"CAQoSPAGNL"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311485200000001",{"currentTime":"2022-01-23T11:48:53.123Z","interval":10,"status":"Accepted"}]
[INFO test_Recurrent_cpVoltN.py:69] 稍等5秒，等桩连上后台
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311485300000002","StatusNotification",{"connectorId":0,"status":"Available","errorCode":"NoError"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311485300000002",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311485300000003","StatusNotification",{"connectorId":1,"status":"Preparing","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311485300000003",{}]
[INFO test_Recurrent_cpVoltN.py:31] ========这是第37次开始执行========
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"98ca3fb7-0bf5-4d1e-b864-7595af21a1fb","RemoteStartTransaction",{"idTag":"AE0022A1GM9C00066K","connectorId":1,"chargingProfile":{"chargingProfileId":1,"transactionId":1,"stackLevel":1,"chargingProfilePurpose":"ChargePointMaxProfile","chargingProfileKind":"Absolute","recurrencyKind":"Daily","validFrom":"date-time","validTo":"date-time","chargingSchedule":{"duration":10,"startSchedule":"date-time","chargingRateUnit":"W","chargingSchedulePeriod":[{"startPeriod":1,"limit":1.5,"numberPhases":1}],"minChargingRate":1.5}}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"98ca3fb7-0bf5-4d1e-b864-7595af21a1fb",{"status":"Accepted"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311490100000004","Authorize",{"idTag":"AE0022A1GM9C00066K"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311490100000004",{"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311490400000005","StatusNotification",{"connectorId":1,"status":"Charging","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311490400000005",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311490500000006","StartTransaction",{"connectorId":1,"idTag":"AE0022A1GM9C00066K","meterStart":528242,"timestamp":"2022-01-23T11:49:04.000Z"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311490500000006",{"transactionId":1,"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311490600000007","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T11:49:06.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"212.110000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.350000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.950000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311490600000007",{}]
[INFO test_Recurrent_cpVoltN.py:52] ********正在充电********稍等约1分钟********
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"b80893ab-17c8-4033-9d19-c42c039e169e","RemoteStopTransaction",{"transactionId":1}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311491600000008","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T11:49:16.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"212.310000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.360000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.950000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311491600000008",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311492600000009","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T11:49:47.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"212.040000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.360000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.950000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311492600000009",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"b80893ab-17c8-4033-9d19-c42c039e169e",{"status":"Accepted"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231150050000000F","StopTransaction",{"idTag":"AE0022A1GM9C00066K","transactionId":1,"meterStop":528242,"timestamp":"2022-01-23T11:50:04.000Z","reason":"Remote"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231150050000000F",{"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231149360000000A","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T11:50:17.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231149360000000A",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231149470000000B","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T11:50:17.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231149470000000B",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231149570000000C","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T11:50:18.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231149570000000C",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231149580000000D","StatusNotification",{"connectorId":1,"status":"Preparing","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231149580000000D",{}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"8d3a3b3b-92c7-4e0b-8a44-ee9426e09f5c","Reset",{"type":"Soft"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"8d3a3b3b-92c7-4e0b-8a44-ee9426e09f5c",{"status":"Accepted"}]
[ERROR server.py:233] connection handler failed
Traceback (most recent call last):
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 944, in transfer_data
    message = await self.read_message()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1013, in read_message
    frame = await self.read_data_frame(max_size=self.max_size)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1089, in read_data_frame
    frame = await self.read_frame(max_size)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1148, in read_frame
    extensions=self.extensions,
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\framing.py", line 70, in read
    data = await reader(2)
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\streams.py", line 679, in readexactly
    await self._wait_for_data('readexactly')
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\streams.py", line 473, in _wait_for_data
    await self._waiter
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\selector_events.py", line 812, in _read_ready__data_received
    data = self._sock.recv(self.max_size)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\server.py", line 231, in handler
    await self.ws_handler(self)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\server.py", line 1137, in _ws_handler
    )(websocket, websocket.path)
  File "D:\workspace\ocpp_test\server\connect.py", line 156, in on_connect
    await Value.chargePoint.start()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\ocpp\charge_point.py", line 125, in start
    message = await self._connection.recv()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 552, in recv
    await self.ensure_open()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 920, in ensure_open
    raise self.connection_closed_exc()
websockets.exceptions.ConnectionClosedError: no close frame received or sent
[INFO server.py:259] connection closed
[INFO server.py:641] connection open
[INFO connect.py:146] Protocols Matched: ocpp1.6
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311504300000001","BootNotification",{"chargePointModel":"MaxiChargerAC","chargePointVendor":"Autel","firmwareVersion":"CAQoSPAGNL"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311504300000001",{"currentTime":"2022-01-23T11:50:43.123Z","interval":10,"status":"Accepted"}]
[INFO test_Recurrent_cpVoltN.py:69] 稍等5秒，等桩连上后台
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311504300000002","StatusNotification",{"connectorId":0,"status":"Available","errorCode":"NoError"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311504300000002",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311504300000003","StatusNotification",{"connectorId":1,"status":"Preparing","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311504300000003",{}]
[INFO test_Recurrent_cpVoltN.py:31] ========这是第38次开始执行========
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"5571af1f-dac2-47d2-8eac-0b91d26d0a27","RemoteStartTransaction",{"idTag":"AE0022A1GM9C00066K","connectorId":1,"chargingProfile":{"chargingProfileId":1,"transactionId":1,"stackLevel":1,"chargingProfilePurpose":"ChargePointMaxProfile","chargingProfileKind":"Absolute","recurrencyKind":"Daily","validFrom":"date-time","validTo":"date-time","chargingSchedule":{"duration":10,"startSchedule":"date-time","chargingRateUnit":"W","chargingSchedulePeriod":[{"startPeriod":1,"limit":1.5,"numberPhases":1}],"minChargingRate":1.5}}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"5571af1f-dac2-47d2-8eac-0b91d26d0a27",{"status":"Accepted"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311505100000004","Authorize",{"idTag":"AE0022A1GM9C00066K"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311505100000004",{"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311505400000005","StatusNotification",{"connectorId":1,"status":"Charging","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311505400000005",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311505500000006","StartTransaction",{"connectorId":1,"idTag":"AE0022A1GM9C00066K","meterStart":528242,"timestamp":"2022-01-23T11:50:54.000Z"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311505500000006",{"transactionId":1,"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311505600000007","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T11:50:56.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"212.220000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.350000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.950000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311505600000007",{}]
[INFO test_Recurrent_cpVoltN.py:52] ********正在充电********稍等约1分钟********
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"3a2eed37-7ab3-46e4-bc84-14243bf24808","RemoteStopTransaction",{"transactionId":1}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311510600000008","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T11:51:06.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"212.130000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.350000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.950000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311510600000008",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311511700000009","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T11:51:36.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"212.070000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.360000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.950000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311511700000009",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"3a2eed37-7ab3-46e4-bc84-14243bf24808",{"status":"Accepted"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231151560000000F","StopTransaction",{"idTag":"AE0022A1GM9C00066K","transactionId":1,"meterStop":528242,"timestamp":"2022-01-23T11:51:55.000Z","reason":"Remote"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231151560000000F",{"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231151270000000A","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T11:52:07.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231151270000000A",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231151370000000B","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T11:52:07.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231151370000000B",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231151470000000C","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T11:52:08.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231151470000000C",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231151480000000D","StatusNotification",{"connectorId":1,"status":"Preparing","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231151480000000D",{}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"66992082-ea04-442c-8acc-840df7fd9b0f","Reset",{"type":"Soft"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"66992082-ea04-442c-8acc-840df7fd9b0f",{"status":"Accepted"}]
[ERROR server.py:233] connection handler failed
Traceback (most recent call last):
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 944, in transfer_data
    message = await self.read_message()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1013, in read_message
    frame = await self.read_data_frame(max_size=self.max_size)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1089, in read_data_frame
    frame = await self.read_frame(max_size)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1148, in read_frame
    extensions=self.extensions,
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\framing.py", line 70, in read
    data = await reader(2)
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\streams.py", line 679, in readexactly
    await self._wait_for_data('readexactly')
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\streams.py", line 473, in _wait_for_data
    await self._waiter
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\selector_events.py", line 812, in _read_ready__data_received
    data = self._sock.recv(self.max_size)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\server.py", line 231, in handler
    await self.ws_handler(self)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\server.py", line 1137, in _ws_handler
    )(websocket, websocket.path)
  File "D:\workspace\ocpp_test\server\connect.py", line 156, in on_connect
    await Value.chargePoint.start()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\ocpp\charge_point.py", line 125, in start
    message = await self._connection.recv()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 552, in recv
    await self.ensure_open()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 920, in ensure_open
    raise self.connection_closed_exc()
websockets.exceptions.ConnectionClosedError: no close frame received or sent
[INFO server.py:259] connection closed
[INFO server.py:641] connection open
[INFO connect.py:146] Protocols Matched: ocpp1.6
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311523200000001","BootNotification",{"chargePointModel":"MaxiChargerAC","chargePointVendor":"Autel","firmwareVersion":"CAQoSPAGNL"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311523200000001",{"currentTime":"2022-01-23T11:52:34.123Z","interval":10,"status":"Accepted"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311523400000002","StatusNotification",{"connectorId":0,"status":"Available","errorCode":"NoError"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311523400000002",{}]
[INFO test_Recurrent_cpVoltN.py:69] 稍等5秒，等桩连上后台
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311523400000003","StatusNotification",{"connectorId":1,"status":"Preparing","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311523400000003",{}]
[INFO test_Recurrent_cpVoltN.py:31] ========这是第39次开始执行========
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"cabf2a0c-3593-4f53-a4e8-cd70796fce46","RemoteStartTransaction",{"idTag":"AE0022A1GM9C00066K","connectorId":1,"chargingProfile":{"chargingProfileId":1,"transactionId":1,"stackLevel":1,"chargingProfilePurpose":"ChargePointMaxProfile","chargingProfileKind":"Absolute","recurrencyKind":"Daily","validFrom":"date-time","validTo":"date-time","chargingSchedule":{"duration":10,"startSchedule":"date-time","chargingRateUnit":"W","chargingSchedulePeriod":[{"startPeriod":1,"limit":1.5,"numberPhases":1}],"minChargingRate":1.5}}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"cabf2a0c-3593-4f53-a4e8-cd70796fce46",{"status":"Accepted"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311524300000004","Authorize",{"idTag":"AE0022A1GM9C00066K"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311524300000004",{"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311524500000005","StatusNotification",{"connectorId":1,"status":"Charging","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311524500000005",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311524600000006","StartTransaction",{"connectorId":1,"idTag":"AE0022A1GM9C00066K","meterStart":528242,"timestamp":"2022-01-23T11:52:45.000Z"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311524600000006",{"transactionId":1,"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311524700000007","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T11:52:47.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"212.130000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.350000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.950000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311524700000007",{}]
[INFO test_Recurrent_cpVoltN.py:52] ********正在充电********稍等约1分钟********
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"c775a050-0ac1-4354-9550-2974a1f29fbe","RemoteStopTransaction",{"transactionId":1}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311525800000008","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T11:52:58.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"211.950000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.350000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.950000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311525800000008",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311530800000009","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T11:53:28.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"212.070000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.360000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.950000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311530800000009",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"c775a050-0ac1-4354-9550-2974a1f29fbe",{"status":"Accepted"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231153470000000F","StopTransaction",{"idTag":"AE0022A1GM9C00066K","transactionId":1,"meterStop":528242,"timestamp":"2022-01-23T11:53:46.000Z","reason":"Remote"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231153470000000F",{"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231153180000000A","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T11:53:58.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.010000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231153180000000A",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231153280000000B","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T11:53:58.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231153280000000B",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231153390000000C","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T11:53:59.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231153390000000C",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231153400000000D","StatusNotification",{"connectorId":1,"status":"Preparing","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231153400000000D",{}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"d8d7e4ed-b451-4765-bb55-bf73d2bef278","Reset",{"type":"Soft"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"d8d7e4ed-b451-4765-bb55-bf73d2bef278",{"status":"Accepted"}]
[ERROR server.py:233] connection handler failed
Traceback (most recent call last):
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 944, in transfer_data
    message = await self.read_message()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1013, in read_message
    frame = await self.read_data_frame(max_size=self.max_size)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1089, in read_data_frame
    frame = await self.read_frame(max_size)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1148, in read_frame
    extensions=self.extensions,
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\framing.py", line 70, in read
    data = await reader(2)
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\streams.py", line 679, in readexactly
    await self._wait_for_data('readexactly')
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\streams.py", line 473, in _wait_for_data
    await self._waiter
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\selector_events.py", line 812, in _read_ready__data_received
    data = self._sock.recv(self.max_size)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\server.py", line 231, in handler
    await self.ws_handler(self)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\server.py", line 1137, in _ws_handler
    )(websocket, websocket.path)
  File "D:\workspace\ocpp_test\server\connect.py", line 156, in on_connect
    await Value.chargePoint.start()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\ocpp\charge_point.py", line 125, in start
    message = await self._connection.recv()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 552, in recv
    await self.ensure_open()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 920, in ensure_open
    raise self.connection_closed_exc()
websockets.exceptions.ConnectionClosedError: no close frame received or sent
[INFO server.py:259] connection closed
[INFO server.py:641] connection open
[INFO connect.py:146] Protocols Matched: ocpp1.6
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311542300000001","BootNotification",{"chargePointModel":"MaxiChargerAC","chargePointVendor":"Autel","firmwareVersion":"CAQoSPAGNL"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311542300000001",{"currentTime":"2022-01-23T11:54:24.123Z","interval":10,"status":"Accepted"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311542400000002","StatusNotification",{"connectorId":0,"status":"Available","errorCode":"NoError"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311542400000002",{}]
[INFO test_Recurrent_cpVoltN.py:69] 稍等5秒，等桩连上后台
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311542400000003","StatusNotification",{"connectorId":1,"status":"Preparing","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311542400000003",{}]
[INFO test_Recurrent_cpVoltN.py:31] ========这是第40次开始执行========
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"dc77ab87-ed7e-4de6-aa92-534d8fa29ee9","RemoteStartTransaction",{"idTag":"AE0022A1GM9C00066K","connectorId":1,"chargingProfile":{"chargingProfileId":1,"transactionId":1,"stackLevel":1,"chargingProfilePurpose":"ChargePointMaxProfile","chargingProfileKind":"Absolute","recurrencyKind":"Daily","validFrom":"date-time","validTo":"date-time","chargingSchedule":{"duration":10,"startSchedule":"date-time","chargingRateUnit":"W","chargingSchedulePeriod":[{"startPeriod":1,"limit":1.5,"numberPhases":1}],"minChargingRate":1.5}}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"dc77ab87-ed7e-4de6-aa92-534d8fa29ee9",{"status":"Accepted"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311543300000004","Authorize",{"idTag":"AE0022A1GM9C00066K"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311543300000004",{"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311543500000005","StatusNotification",{"connectorId":1,"status":"Charging","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311543500000005",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311543600000006","StartTransaction",{"connectorId":1,"idTag":"AE0022A1GM9C00066K","meterStart":528242,"timestamp":"2022-01-23T11:54:35.000Z"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311543600000006",{"transactionId":1,"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311543800000007","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T11:54:38.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"212.160000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.360000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.950000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311543800000007",{}]
[INFO test_Recurrent_cpVoltN.py:52] ********正在充电********稍等约1分钟********
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"a510b8fc-09fc-41c2-ba21-042e02b6a264","RemoteStopTransaction",{"transactionId":1}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311544800000008","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T11:54:48.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"212.340000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.360000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.950000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311544800000008",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311545800000009","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T11:55:18.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"212.220000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.360000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.950000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311545800000009",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"a510b8fc-09fc-41c2-ba21-042e02b6a264",{"status":"Accepted"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231155370000000F","StopTransaction",{"idTag":"AE0022A1GM9C00066K","transactionId":1,"meterStop":528242,"timestamp":"2022-01-23T11:55:36.000Z","reason":"Remote"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231155370000000F",{"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231155080000000A","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T11:55:48.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231155080000000A",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231155190000000B","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T11:55:49.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231155190000000B",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231155290000000C","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T11:55:49.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231155290000000C",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231155290000000D","StatusNotification",{"connectorId":1,"status":"Preparing","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231155290000000D",{}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"91d2eed0-da00-4e2f-9e85-f67213d1419d","Reset",{"type":"Soft"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"91d2eed0-da00-4e2f-9e85-f67213d1419d",{"status":"Accepted"}]
[ERROR server.py:233] connection handler failed
Traceback (most recent call last):
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 944, in transfer_data
    message = await self.read_message()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1013, in read_message
    frame = await self.read_data_frame(max_size=self.max_size)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1089, in read_data_frame
    frame = await self.read_frame(max_size)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1148, in read_frame
    extensions=self.extensions,
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\framing.py", line 70, in read
    data = await reader(2)
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\streams.py", line 679, in readexactly
    await self._wait_for_data('readexactly')
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\streams.py", line 473, in _wait_for_data
    await self._waiter
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\selector_events.py", line 812, in _read_ready__data_received
    data = self._sock.recv(self.max_size)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\server.py", line 231, in handler
    await self.ws_handler(self)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\server.py", line 1137, in _ws_handler
    )(websocket, websocket.path)
  File "D:\workspace\ocpp_test\server\connect.py", line 156, in on_connect
    await Value.chargePoint.start()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\ocpp\charge_point.py", line 125, in start
    message = await self._connection.recv()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 552, in recv
    await self.ensure_open()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 920, in ensure_open
    raise self.connection_closed_exc()
websockets.exceptions.ConnectionClosedError: no close frame received or sent
[INFO server.py:259] connection closed
[INFO server.py:641] connection open
[INFO connect.py:146] Protocols Matched: ocpp1.6
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311560600000001","BootNotification",{"chargePointModel":"MaxiChargerAC","chargePointVendor":"Autel","firmwareVersion":"CAQoSPAGNL"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311560600000001",{"currentTime":"2022-01-23T11:56:07.123Z","interval":10,"status":"Accepted"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311560700000002","StatusNotification",{"connectorId":0,"status":"Available","errorCode":"NoError"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311560700000002",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311560700000003","StatusNotification",{"connectorId":1,"status":"Preparing","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311560700000003",{}]
[INFO test_Recurrent_cpVoltN.py:69] 稍等5秒，等桩连上后台
[INFO test_Recurrent_cpVoltN.py:31] ========这是第41次开始执行========
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"9d205d3d-a272-49fb-bbed-6f0800cf02a0","RemoteStartTransaction",{"idTag":"AE0022A1GM9C00066K","connectorId":1,"chargingProfile":{"chargingProfileId":1,"transactionId":1,"stackLevel":1,"chargingProfilePurpose":"ChargePointMaxProfile","chargingProfileKind":"Absolute","recurrencyKind":"Daily","validFrom":"date-time","validTo":"date-time","chargingSchedule":{"duration":10,"startSchedule":"date-time","chargingRateUnit":"W","chargingSchedulePeriod":[{"startPeriod":1,"limit":1.5,"numberPhases":1}],"minChargingRate":1.5}}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"9d205d3d-a272-49fb-bbed-6f0800cf02a0",{"status":"Accepted"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311561500000004","Authorize",{"idTag":"AE0022A1GM9C00066K"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311561500000004",{"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311561700000005","StatusNotification",{"connectorId":1,"status":"Charging","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311561700000005",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311561800000006","StartTransaction",{"connectorId":1,"idTag":"AE0022A1GM9C00066K","meterStart":528242,"timestamp":"2022-01-23T11:56:17.000Z"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311561800000006",{"transactionId":1,"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311561900000007","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T11:56:20.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"212.460000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.370000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.950000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311561900000007",{}]
[INFO test_Recurrent_cpVoltN.py:52] ********正在充电********稍等约1分钟********
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"36c0b745-a0f9-4185-a1ce-f65581f38396","RemoteStopTransaction",{"transactionId":1}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311563000000008","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T11:56:30.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"212.530000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.370000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.950000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311563000000008",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311564000000009","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T11:57:00.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"212.400000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.360000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.950000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311564000000009",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"36c0b745-a0f9-4185-a1ce-f65581f38396",{"status":"Accepted"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231157190000000F","StopTransaction",{"idTag":"AE0022A1GM9C00066K","transactionId":1,"meterStop":528242,"timestamp":"2022-01-23T11:57:17.000Z","reason":"Remote"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231157190000000F",{"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231156500000000A","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T11:57:30.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231156500000000A",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231157000000000B","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T11:57:31.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231157000000000B",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231157110000000C","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T11:57:31.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231157110000000C",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231157110000000D","StatusNotification",{"connectorId":1,"status":"Preparing","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231157110000000D",{}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"1b0bce82-c943-4166-bb03-507acd54d4c2","Reset",{"type":"Soft"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"1b0bce82-c943-4166-bb03-507acd54d4c2",{"status":"Accepted"}]
[ERROR server.py:233] connection handler failed
Traceback (most recent call last):
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 944, in transfer_data
    message = await self.read_message()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1013, in read_message
    frame = await self.read_data_frame(max_size=self.max_size)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1089, in read_data_frame
    frame = await self.read_frame(max_size)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1148, in read_frame
    extensions=self.extensions,
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\framing.py", line 70, in read
    data = await reader(2)
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\streams.py", line 679, in readexactly
    await self._wait_for_data('readexactly')
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\streams.py", line 473, in _wait_for_data
    await self._waiter
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\selector_events.py", line 812, in _read_ready__data_received
    data = self._sock.recv(self.max_size)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\server.py", line 231, in handler
    await self.ws_handler(self)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\server.py", line 1137, in _ws_handler
    )(websocket, websocket.path)
  File "D:\workspace\ocpp_test\server\connect.py", line 156, in on_connect
    await Value.chargePoint.start()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\ocpp\charge_point.py", line 125, in start
    message = await self._connection.recv()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 552, in recv
    await self.ensure_open()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 920, in ensure_open
    raise self.connection_closed_exc()
websockets.exceptions.ConnectionClosedError: no close frame received or sent
[INFO server.py:259] connection closed
[INFO server.py:641] connection open
[INFO connect.py:146] Protocols Matched: ocpp1.6
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311575800000001","BootNotification",{"chargePointModel":"MaxiChargerAC","chargePointVendor":"Autel","firmwareVersion":"CAQoSPAGNL"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311575800000001",{"currentTime":"2022-01-23T11:57:59.123Z","interval":10,"status":"Accepted"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311575900000002","StatusNotification",{"connectorId":0,"status":"Available","errorCode":"NoError"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311575900000002",{}]
[INFO test_Recurrent_cpVoltN.py:69] 稍等5秒，等桩连上后台
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311575900000003","StatusNotification",{"connectorId":1,"status":"Preparing","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311575900000003",{}]
[INFO test_Recurrent_cpVoltN.py:31] ========这是第42次开始执行========
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"e2c31476-e732-41c6-9a82-7af6c8641062","RemoteStartTransaction",{"idTag":"AE0022A1GM9C00066K","connectorId":1,"chargingProfile":{"chargingProfileId":1,"transactionId":1,"stackLevel":1,"chargingProfilePurpose":"ChargePointMaxProfile","chargingProfileKind":"Absolute","recurrencyKind":"Daily","validFrom":"date-time","validTo":"date-time","chargingSchedule":{"duration":10,"startSchedule":"date-time","chargingRateUnit":"W","chargingSchedulePeriod":[{"startPeriod":1,"limit":1.5,"numberPhases":1}],"minChargingRate":1.5}}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"e2c31476-e732-41c6-9a82-7af6c8641062",{"status":"Accepted"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311580800000004","Authorize",{"idTag":"AE0022A1GM9C00066K"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311580800000004",{"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311581000000005","StatusNotification",{"connectorId":1,"status":"Charging","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311581000000005",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311581100000006","StartTransaction",{"connectorId":1,"idTag":"AE0022A1GM9C00066K","meterStart":528242,"timestamp":"2022-01-23T11:58:10.000Z"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311581100000006",{"transactionId":1,"idTagInfo":{"status":"Accepted"}}]
[INFO test_Recurrent_cpVoltN.py:52] ********正在充电********稍等约1分钟********
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"ce3671c0-2534-4ea1-84b3-72f809a7efaf","RemoteStopTransaction",{"transactionId":1}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311581200000007","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T11:58:12.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"212.680000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.380000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.960000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311581200000007",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311582200000008","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T11:58:42.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"212.520000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.360000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.950000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311582200000008",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"ce3671c0-2534-4ea1-84b3-72f809a7efaf",{"status":"Accepted"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231159090000000E","StopTransaction",{"idTag":"AE0022A1GM9C00066K","transactionId":1,"meterStop":528242,"timestamp":"2022-01-23T11:59:08.000Z","reason":"Remote"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231159090000000E",{"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311583200000009","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T11:59:12.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311583200000009",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231158420000000A","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T11:59:13.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231158420000000A",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231158530000000B","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T11:59:13.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231158530000000B",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231159010000000C","StatusNotification",{"connectorId":1,"status":"Preparing","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231159010000000C",{}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"9c030de1-3a36-4891-a466-e637ee7b316e","Reset",{"type":"Soft"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"9c030de1-3a36-4891-a466-e637ee7b316e",{"status":"Accepted"}]
[ERROR server.py:233] connection handler failed
Traceback (most recent call last):
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 944, in transfer_data
    message = await self.read_message()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1013, in read_message
    frame = await self.read_data_frame(max_size=self.max_size)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1089, in read_data_frame
    frame = await self.read_frame(max_size)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1148, in read_frame
    extensions=self.extensions,
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\framing.py", line 70, in read
    data = await reader(2)
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\streams.py", line 679, in readexactly
    await self._wait_for_data('readexactly')
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\streams.py", line 473, in _wait_for_data
    await self._waiter
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\selector_events.py", line 812, in _read_ready__data_received
    data = self._sock.recv(self.max_size)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\server.py", line 231, in handler
    await self.ws_handler(self)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\server.py", line 1137, in _ws_handler
    )(websocket, websocket.path)
  File "D:\workspace\ocpp_test\server\connect.py", line 156, in on_connect
    await Value.chargePoint.start()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\ocpp\charge_point.py", line 125, in start
    message = await self._connection.recv()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 552, in recv
    await self.ensure_open()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 920, in ensure_open
    raise self.connection_closed_exc()
websockets.exceptions.ConnectionClosedError: no close frame received or sent
[INFO server.py:259] connection closed
[INFO server.py:641] connection open
[INFO connect.py:146] Protocols Matched: ocpp1.6
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311593200000001","BootNotification",{"chargePointModel":"MaxiChargerAC","chargePointVendor":"Autel","firmwareVersion":"CAQoSPAGNL"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311593200000001",{"currentTime":"2022-01-23T11:59:32.123Z","interval":10,"status":"Accepted"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311593200000002","StatusNotification",{"connectorId":0,"status":"Available","errorCode":"NoError"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311593200000002",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311593200000003","StatusNotification",{"connectorId":1,"status":"Preparing","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311593200000003",{}]
[INFO test_Recurrent_cpVoltN.py:69] 稍等5秒，等桩连上后台
[INFO test_Recurrent_cpVoltN.py:31] ========这是第43次开始执行========
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"29609184-d8f0-4803-b03e-613bbb6668da","RemoteStartTransaction",{"idTag":"AE0022A1GM9C00066K","connectorId":1,"chargingProfile":{"chargingProfileId":1,"transactionId":1,"stackLevel":1,"chargingProfilePurpose":"ChargePointMaxProfile","chargingProfileKind":"Absolute","recurrencyKind":"Daily","validFrom":"date-time","validTo":"date-time","chargingSchedule":{"duration":10,"startSchedule":"date-time","chargingRateUnit":"W","chargingSchedulePeriod":[{"startPeriod":1,"limit":1.5,"numberPhases":1}],"minChargingRate":1.5}}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"29609184-d8f0-4803-b03e-613bbb6668da",{"status":"Accepted"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311593900000004","Authorize",{"idTag":"AE0022A1GM9C00066K"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311593900000004",{"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311594200000005","StatusNotification",{"connectorId":1,"status":"Charging","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311594200000005",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311594300000006","StartTransaction",{"connectorId":1,"idTag":"AE0022A1GM9C00066K","meterStart":528242,"timestamp":"2022-01-23T11:59:42.000Z"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311594300000006",{"transactionId":1,"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311594400000007","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T11:59:44.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"212.540000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.370000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.960000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311594400000007",{}]
[INFO test_Recurrent_cpVoltN.py:52] ********正在充电********稍等约1分钟********
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"a9a68936-203e-40d4-8ffe-e8a237239d41","RemoteStopTransaction",{"transactionId":1}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012311595400000008","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T11:59:54.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"212.830000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.380000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.960000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012311595400000008",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312000500000009","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T12:00:24.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"212.760000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.370000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.950000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312000500000009",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"a9a68936-203e-40d4-8ffe-e8a237239d41",{"status":"Accepted"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231200440000000F","StopTransaction",{"idTag":"AE0022A1GM9C00066K","transactionId":1,"meterStop":528242,"timestamp":"2022-01-23T12:00:43.000Z","reason":"Remote"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231200440000000F",{"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231200150000000A","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T12:00:55.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231200150000000A",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231200250000000B","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T12:00:55.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231200250000000B",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231200360000000C","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T12:00:56.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231200360000000C",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231200360000000D","StatusNotification",{"connectorId":1,"status":"Preparing","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231200360000000D",{}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"8a0cc0c8-05e3-44ed-903f-78b7dab5c9fc","Reset",{"type":"Soft"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"8a0cc0c8-05e3-44ed-903f-78b7dab5c9fc",{"status":"Accepted"}]
[ERROR server.py:233] connection handler failed
Traceback (most recent call last):
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 944, in transfer_data
    message = await self.read_message()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1013, in read_message
    frame = await self.read_data_frame(max_size=self.max_size)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1089, in read_data_frame
    frame = await self.read_frame(max_size)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1148, in read_frame
    extensions=self.extensions,
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\framing.py", line 70, in read
    data = await reader(2)
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\streams.py", line 679, in readexactly
    await self._wait_for_data('readexactly')
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\streams.py", line 473, in _wait_for_data
    await self._waiter
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\selector_events.py", line 812, in _read_ready__data_received
    data = self._sock.recv(self.max_size)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\server.py", line 231, in handler
    await self.ws_handler(self)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\server.py", line 1137, in _ws_handler
    )(websocket, websocket.path)
  File "D:\workspace\ocpp_test\server\connect.py", line 156, in on_connect
    await Value.chargePoint.start()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\ocpp\charge_point.py", line 125, in start
    message = await self._connection.recv()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 552, in recv
    await self.ensure_open()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 920, in ensure_open
    raise self.connection_closed_exc()
websockets.exceptions.ConnectionClosedError: no close frame received or sent
[INFO server.py:259] connection closed
[INFO server.py:641] connection open
[INFO connect.py:146] Protocols Matched: ocpp1.6
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312012100000001","BootNotification",{"chargePointModel":"MaxiChargerAC","chargePointVendor":"Autel","firmwareVersion":"CAQoSPAGNL"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312012100000001",{"currentTime":"2022-01-23T12:01:22.123Z","interval":10,"status":"Accepted"}]
[INFO test_Recurrent_cpVoltN.py:69] 稍等5秒，等桩连上后台
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312012200000002","StatusNotification",{"connectorId":0,"status":"Available","errorCode":"NoError"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312012200000002",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312012200000003","StatusNotification",{"connectorId":1,"status":"Preparing","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312012200000003",{}]
[INFO test_Recurrent_cpVoltN.py:31] ========这是第44次开始执行========
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"8d6efecf-8026-4aaa-9709-9d38cfb64fa6","RemoteStartTransaction",{"idTag":"AE0022A1GM9C00066K","connectorId":1,"chargingProfile":{"chargingProfileId":1,"transactionId":1,"stackLevel":1,"chargingProfilePurpose":"ChargePointMaxProfile","chargingProfileKind":"Absolute","recurrencyKind":"Daily","validFrom":"date-time","validTo":"date-time","chargingSchedule":{"duration":10,"startSchedule":"date-time","chargingRateUnit":"W","chargingSchedulePeriod":[{"startPeriod":1,"limit":1.5,"numberPhases":1}],"minChargingRate":1.5}}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"8d6efecf-8026-4aaa-9709-9d38cfb64fa6",{"status":"Accepted"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312013000000004","Authorize",{"idTag":"AE0022A1GM9C00066K"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312013000000004",{"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312013300000005","StatusNotification",{"connectorId":1,"status":"Charging","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312013300000005",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312013400000006","StartTransaction",{"connectorId":1,"idTag":"AE0022A1GM9C00066K","meterStart":528242,"timestamp":"2022-01-23T12:01:33.000Z"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312013400000006",{"transactionId":1,"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312013500000007","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T12:01:35.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"212.750000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.380000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.960000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312013500000007",{}]
[INFO test_Recurrent_cpVoltN.py:52] ********正在充电********稍等约1分钟********
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"926c6b47-c955-4638-b54b-2a88cd0f89fd","RemoteStopTransaction",{"transactionId":1}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312014600000008","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T12:01:46.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"212.790000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.380000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.960000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312014600000008",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312015600000009","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T12:02:16.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"212.720000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.380000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.950000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312015600000009",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"926c6b47-c955-4638-b54b-2a88cd0f89fd",{"status":"Accepted"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231202350000000F","StopTransaction",{"idTag":"AE0022A1GM9C00066K","transactionId":1,"meterStop":528242,"timestamp":"2022-01-23T12:02:34.000Z","reason":"Remote"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231202350000000F",{"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231202060000000A","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T12:02:46.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231202060000000A",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231202160000000B","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T12:02:47.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231202160000000B",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231202270000000C","StatusNotification",{"connectorId":1,"status":"Preparing","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231202270000000C",{}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"31367b9a-4813-4a89-bb23-8698474166bb","Reset",{"type":"Soft"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231202270000000D","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T12:02:48.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.010000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231202270000000D",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"31367b9a-4813-4a89-bb23-8698474166bb",{"status":"Accepted"}]
[ERROR server.py:233] connection handler failed
Traceback (most recent call last):
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 944, in transfer_data
    message = await self.read_message()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1013, in read_message
    frame = await self.read_data_frame(max_size=self.max_size)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1089, in read_data_frame
    frame = await self.read_frame(max_size)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1148, in read_frame
    extensions=self.extensions,
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\framing.py", line 70, in read
    data = await reader(2)
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\streams.py", line 679, in readexactly
    await self._wait_for_data('readexactly')
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\streams.py", line 473, in _wait_for_data
    await self._waiter
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\selector_events.py", line 812, in _read_ready__data_received
    data = self._sock.recv(self.max_size)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\server.py", line 231, in handler
    await self.ws_handler(self)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\server.py", line 1137, in _ws_handler
    )(websocket, websocket.path)
  File "D:\workspace\ocpp_test\server\connect.py", line 156, in on_connect
    await Value.chargePoint.start()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\ocpp\charge_point.py", line 125, in start
    message = await self._connection.recv()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 552, in recv
    await self.ensure_open()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 920, in ensure_open
    raise self.connection_closed_exc()
websockets.exceptions.ConnectionClosedError: no close frame received or sent
[INFO server.py:259] connection closed
[INFO server.py:641] connection open
[INFO connect.py:146] Protocols Matched: ocpp1.6
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312031200000001","BootNotification",{"chargePointModel":"MaxiChargerAC","chargePointVendor":"Autel","firmwareVersion":"CAQoSPAGNL"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312031200000001",{"currentTime":"2022-01-23T12:03:13.123Z","interval":10,"status":"Accepted"}]
[INFO test_Recurrent_cpVoltN.py:69] 稍等5秒，等桩连上后台
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312031300000002","StatusNotification",{"connectorId":0,"status":"Available","errorCode":"NoError"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312031300000002",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312031300000003","StatusNotification",{"connectorId":1,"status":"Preparing","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312031300000003",{}]
[INFO test_Recurrent_cpVoltN.py:31] ========这是第45次开始执行========
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"6d95c14f-a4d4-4c55-b770-f6c106e52e2f","RemoteStartTransaction",{"idTag":"AE0022A1GM9C00066K","connectorId":1,"chargingProfile":{"chargingProfileId":1,"transactionId":1,"stackLevel":1,"chargingProfilePurpose":"ChargePointMaxProfile","chargingProfileKind":"Absolute","recurrencyKind":"Daily","validFrom":"date-time","validTo":"date-time","chargingSchedule":{"duration":10,"startSchedule":"date-time","chargingRateUnit":"W","chargingSchedulePeriod":[{"startPeriod":1,"limit":1.5,"numberPhases":1}],"minChargingRate":1.5}}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"6d95c14f-a4d4-4c55-b770-f6c106e52e2f",{"status":"Accepted"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312032100000004","Authorize",{"idTag":"AE0022A1GM9C00066K"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312032100000004",{"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312032400000005","StatusNotification",{"connectorId":1,"status":"Charging","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312032400000005",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312032500000006","StartTransaction",{"connectorId":1,"idTag":"AE0022A1GM9C00066K","meterStart":528242,"timestamp":"2022-01-23T12:03:24.000Z"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312032500000006",{"transactionId":1,"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312032600000007","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T12:03:26.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"212.880000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.380000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.960000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.010000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312032600000007",{}]
[INFO test_Recurrent_cpVoltN.py:52] ********正在充电********稍等约1分钟********
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"764b9dd0-3bfb-4a7b-a603-0f41d2cb9448","RemoteStopTransaction",{"transactionId":1}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312033700000008","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T12:03:37.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"212.700000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.380000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.950000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312033700000008",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312034700000009","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T12:04:07.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"212.820000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.390000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.960000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312034700000009",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"764b9dd0-3bfb-4a7b-a603-0f41d2cb9448",{"status":"Accepted"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231204250000000F","StopTransaction",{"idTag":"AE0022A1GM9C00066K","transactionId":1,"meterStop":528242,"timestamp":"2022-01-23T12:04:24.000Z","reason":"Remote"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231204250000000F",{"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231203570000000A","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T12:04:37.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231203570000000A",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231204070000000B","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T12:04:38.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231204070000000B",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231204170000000C","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T12:04:38.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231204170000000C",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231204180000000D","StatusNotification",{"connectorId":1,"status":"Preparing","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231204180000000D",{}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"b8daf47e-a089-43ff-84aa-01765a551bbb","Reset",{"type":"Soft"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"b8daf47e-a089-43ff-84aa-01765a551bbb",{"status":"Accepted"}]
[ERROR server.py:233] connection handler failed
Traceback (most recent call last):
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 944, in transfer_data
    message = await self.read_message()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1013, in read_message
    frame = await self.read_data_frame(max_size=self.max_size)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1089, in read_data_frame
    frame = await self.read_frame(max_size)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1148, in read_frame
    extensions=self.extensions,
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\framing.py", line 70, in read
    data = await reader(2)
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\streams.py", line 679, in readexactly
    await self._wait_for_data('readexactly')
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\streams.py", line 473, in _wait_for_data
    await self._waiter
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\selector_events.py", line 812, in _read_ready__data_received
    data = self._sock.recv(self.max_size)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\server.py", line 231, in handler
    await self.ws_handler(self)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\server.py", line 1137, in _ws_handler
    )(websocket, websocket.path)
  File "D:\workspace\ocpp_test\server\connect.py", line 156, in on_connect
    await Value.chargePoint.start()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\ocpp\charge_point.py", line 125, in start
    message = await self._connection.recv()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 552, in recv
    await self.ensure_open()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 920, in ensure_open
    raise self.connection_closed_exc()
websockets.exceptions.ConnectionClosedError: no close frame received or sent
[INFO server.py:259] connection closed
[INFO server.py:641] connection open
[INFO connect.py:146] Protocols Matched: ocpp1.6
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312050500000001","BootNotification",{"chargePointModel":"MaxiChargerAC","chargePointVendor":"Autel","firmwareVersion":"CAQoSPAGNL"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312050500000001",{"currentTime":"2022-01-23T12:05:06.123Z","interval":10,"status":"Accepted"}]
[INFO test_Recurrent_cpVoltN.py:69] 稍等5秒，等桩连上后台
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312050600000002","StatusNotification",{"connectorId":0,"status":"Available","errorCode":"NoError"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312050600000002",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312050600000003","StatusNotification",{"connectorId":1,"status":"Preparing","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312050600000003",{}]
[INFO test_Recurrent_cpVoltN.py:31] ========这是第46次开始执行========
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"701dcff0-be7b-4071-a90d-bc895a777949","RemoteStartTransaction",{"idTag":"AE0022A1GM9C00066K","connectorId":1,"chargingProfile":{"chargingProfileId":1,"transactionId":1,"stackLevel":1,"chargingProfilePurpose":"ChargePointMaxProfile","chargingProfileKind":"Absolute","recurrencyKind":"Daily","validFrom":"date-time","validTo":"date-time","chargingSchedule":{"duration":10,"startSchedule":"date-time","chargingRateUnit":"W","chargingSchedulePeriod":[{"startPeriod":1,"limit":1.5,"numberPhases":1}],"minChargingRate":1.5}}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"701dcff0-be7b-4071-a90d-bc895a777949",{"status":"Accepted"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312051400000004","Authorize",{"idTag":"AE0022A1GM9C00066K"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312051400000004",{"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312051700000005","StatusNotification",{"connectorId":1,"status":"Charging","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312051700000005",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312051700000006","StartTransaction",{"connectorId":1,"idTag":"AE0022A1GM9C00066K","meterStart":528242,"timestamp":"2022-01-23T12:05:17.000Z"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312051700000006",{"transactionId":1,"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312051900000007","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T12:05:19.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"212.640000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.370000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.950000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.010000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312051900000007",{}]
[INFO test_Recurrent_cpVoltN.py:52] ********正在充电********稍等约1分钟********
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"72808bd7-a6de-43ff-86e0-582b0a6c0b33","RemoteStopTransaction",{"transactionId":1}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312052900000008","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T12:05:29.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"212.420000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.360000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.950000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312052900000008",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312054000000009","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T12:06:00.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"213.100000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.390000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.950000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312054000000009",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"72808bd7-a6de-43ff-86e0-582b0a6c0b33",{"status":"Accepted"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231206180000000E","StopTransaction",{"idTag":"AE0022A1GM9C00066K","transactionId":1,"meterStop":528242,"timestamp":"2022-01-23T12:06:17.000Z","reason":"Remote"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231206180000000E",{"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231205500000000A","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T12:06:30.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231205500000000A",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231206000000000B","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T12:06:31.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231206000000000B",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231206110000000C","StatusNotification",{"connectorId":1,"status":"Preparing","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231206110000000C",{}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"4d6e8eda-f134-49b6-b7d9-86f250b9df5a","Reset",{"type":"Soft"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"4d6e8eda-f134-49b6-b7d9-86f250b9df5a",{"status":"Accepted"}]
[ERROR server.py:233] connection handler failed
Traceback (most recent call last):
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 944, in transfer_data
    message = await self.read_message()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1013, in read_message
    frame = await self.read_data_frame(max_size=self.max_size)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1089, in read_data_frame
    frame = await self.read_frame(max_size)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1148, in read_frame
    extensions=self.extensions,
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\framing.py", line 70, in read
    data = await reader(2)
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\streams.py", line 679, in readexactly
    await self._wait_for_data('readexactly')
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\streams.py", line 473, in _wait_for_data
    await self._waiter
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\selector_events.py", line 812, in _read_ready__data_received
    data = self._sock.recv(self.max_size)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\server.py", line 231, in handler
    await self.ws_handler(self)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\server.py", line 1137, in _ws_handler
    )(websocket, websocket.path)
  File "D:\workspace\ocpp_test\server\connect.py", line 156, in on_connect
    await Value.chargePoint.start()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\ocpp\charge_point.py", line 125, in start
    message = await self._connection.recv()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 552, in recv
    await self.ensure_open()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 920, in ensure_open
    raise self.connection_closed_exc()
websockets.exceptions.ConnectionClosedError: no close frame received or sent
[INFO server.py:259] connection closed
[INFO server.py:641] connection open
[INFO connect.py:146] Protocols Matched: ocpp1.6
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312065500000001","BootNotification",{"chargePointModel":"MaxiChargerAC","chargePointVendor":"Autel","firmwareVersion":"CAQoSPAGNL"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312065500000001",{"currentTime":"2022-01-23T12:06:56.123Z","interval":10,"status":"Accepted"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312065600000002","StatusNotification",{"connectorId":0,"status":"Available","errorCode":"NoError"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312065600000002",{}]
[INFO test_Recurrent_cpVoltN.py:69] 稍等5秒，等桩连上后台
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312065600000003","StatusNotification",{"connectorId":1,"status":"Preparing","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312065600000003",{}]
[INFO test_Recurrent_cpVoltN.py:31] ========这是第47次开始执行========
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"0b65e810-99c0-4e21-aaea-1de571e3041b","RemoteStartTransaction",{"idTag":"AE0022A1GM9C00066K","connectorId":1,"chargingProfile":{"chargingProfileId":1,"transactionId":1,"stackLevel":1,"chargingProfilePurpose":"ChargePointMaxProfile","chargingProfileKind":"Absolute","recurrencyKind":"Daily","validFrom":"date-time","validTo":"date-time","chargingSchedule":{"duration":10,"startSchedule":"date-time","chargingRateUnit":"W","chargingSchedulePeriod":[{"startPeriod":1,"limit":1.5,"numberPhases":1}],"minChargingRate":1.5}}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"0b65e810-99c0-4e21-aaea-1de571e3041b",{"status":"Accepted"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312070500000004","Authorize",{"idTag":"AE0022A1GM9C00066K"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312070500000004",{"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312070700000005","StatusNotification",{"connectorId":1,"status":"Charging","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312070700000005",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312070700000006","StartTransaction",{"connectorId":1,"idTag":"AE0022A1GM9C00066K","meterStart":528242,"timestamp":"2022-01-23T12:07:07.000Z"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312070700000006",{"transactionId":1,"idTagInfo":{"status":"Accepted"}}]
[INFO test_Recurrent_cpVoltN.py:52] ********正在充电********稍等约1分钟********
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"a5fe4a66-1ca7-4a19-a5f2-40ec52766124","RemoteStopTransaction",{"transactionId":1}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312070900000007","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T12:07:09.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"212.780000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.380000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.950000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312070900000007",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312072000000008","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T12:07:39.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"212.820000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.380000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.950000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312072000000008",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"a5fe4a66-1ca7-4a19-a5f2-40ec52766124",{"status":"Accepted"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231208060000000E","StopTransaction",{"idTag":"AE0022A1GM9C00066K","transactionId":1,"meterStop":528242,"timestamp":"2022-01-23T12:08:05.000Z","reason":"Remote"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231208060000000E",{"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312073000000009","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T12:08:09.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312073000000009",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231207400000000A","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T12:08:10.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231207400000000A",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231207510000000B","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T12:08:11.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231207510000000B",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231207580000000C","StatusNotification",{"connectorId":1,"status":"Preparing","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231207580000000C",{}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"823c8f2a-5f6b-4e15-98f1-ff760788e539","Reset",{"type":"Soft"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"823c8f2a-5f6b-4e15-98f1-ff760788e539",{"status":"Accepted"}]
[ERROR server.py:233] connection handler failed
Traceback (most recent call last):
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 944, in transfer_data
    message = await self.read_message()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1013, in read_message
    frame = await self.read_data_frame(max_size=self.max_size)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1089, in read_data_frame
    frame = await self.read_frame(max_size)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1148, in read_frame
    extensions=self.extensions,
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\framing.py", line 70, in read
    data = await reader(2)
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\streams.py", line 679, in readexactly
    await self._wait_for_data('readexactly')
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\streams.py", line 473, in _wait_for_data
    await self._waiter
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\selector_events.py", line 812, in _read_ready__data_received
    data = self._sock.recv(self.max_size)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\server.py", line 231, in handler
    await self.ws_handler(self)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\server.py", line 1137, in _ws_handler
    )(websocket, websocket.path)
  File "D:\workspace\ocpp_test\server\connect.py", line 156, in on_connect
    await Value.chargePoint.start()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\ocpp\charge_point.py", line 125, in start
    message = await self._connection.recv()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 552, in recv
    await self.ensure_open()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 920, in ensure_open
    raise self.connection_closed_exc()
websockets.exceptions.ConnectionClosedError: no close frame received or sent
[INFO server.py:259] connection closed
[INFO server.py:641] connection open
[INFO connect.py:146] Protocols Matched: ocpp1.6
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312083700000001","BootNotification",{"chargePointModel":"MaxiChargerAC","chargePointVendor":"Autel","firmwareVersion":"CAQoSPAGNL"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312083700000001",{"currentTime":"2022-01-23T12:08:38.123Z","interval":10,"status":"Accepted"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312083800000002","StatusNotification",{"connectorId":0,"status":"Available","errorCode":"NoError"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312083800000002",{}]
[INFO test_Recurrent_cpVoltN.py:69] 稍等5秒，等桩连上后台
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312083800000003","StatusNotification",{"connectorId":1,"status":"Preparing","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312083800000003",{}]
[INFO test_Recurrent_cpVoltN.py:31] ========这是第48次开始执行========
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"03d1d432-f8b5-435e-935b-8bfd90af32c7","RemoteStartTransaction",{"idTag":"AE0022A1GM9C00066K","connectorId":1,"chargingProfile":{"chargingProfileId":1,"transactionId":1,"stackLevel":1,"chargingProfilePurpose":"ChargePointMaxProfile","chargingProfileKind":"Absolute","recurrencyKind":"Daily","validFrom":"date-time","validTo":"date-time","chargingSchedule":{"duration":10,"startSchedule":"date-time","chargingRateUnit":"W","chargingSchedulePeriod":[{"startPeriod":1,"limit":1.5,"numberPhases":1}],"minChargingRate":1.5}}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"03d1d432-f8b5-435e-935b-8bfd90af32c7",{"status":"Accepted"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312084700000004","Authorize",{"idTag":"AE0022A1GM9C00066K"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312084700000004",{"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312084900000005","StatusNotification",{"connectorId":1,"status":"Charging","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312084900000005",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312085000000006","StartTransaction",{"connectorId":1,"idTag":"AE0022A1GM9C00066K","meterStart":528242,"timestamp":"2022-01-23T12:08:49.000Z"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312085000000006",{"transactionId":1,"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312085100000007","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T12:08:51.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"212.950000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.390000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.950000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.010000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312085100000007",{}]
[INFO test_Recurrent_cpVoltN.py:52] ********正在充电********稍等约1分钟********
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"e3eedfdf-eb38-4975-bf8a-f19453cf3d0d","RemoteStopTransaction",{"transactionId":1}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312090100000008","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T12:09:01.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"212.990000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.390000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.950000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312090100000008",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312091200000009","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T12:09:32.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"212.780000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.370000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.950000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312091200000009",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"e3eedfdf-eb38-4975-bf8a-f19453cf3d0d",{"status":"Accepted"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231209510000000F","StopTransaction",{"idTag":"AE0022A1GM9C00066K","transactionId":1,"meterStop":528242,"timestamp":"2022-01-23T12:09:50.000Z","reason":"Remote"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231209510000000F",{"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231209220000000A","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T12:10:02.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231209220000000A",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231209320000000B","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T12:10:02.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231209320000000B",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231209420000000C","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T12:10:03.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231209420000000C",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231209430000000D","StatusNotification",{"connectorId":1,"status":"Preparing","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231209430000000D",{}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"90767192-dd94-4957-9738-cbb273cbb3a8","Reset",{"type":"Soft"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"90767192-dd94-4957-9738-cbb273cbb3a8",{"status":"Accepted"}]
[ERROR server.py:233] connection handler failed
Traceback (most recent call last):
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 944, in transfer_data
    message = await self.read_message()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1013, in read_message
    frame = await self.read_data_frame(max_size=self.max_size)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1089, in read_data_frame
    frame = await self.read_frame(max_size)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1148, in read_frame
    extensions=self.extensions,
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\framing.py", line 70, in read
    data = await reader(2)
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\streams.py", line 679, in readexactly
    await self._wait_for_data('readexactly')
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\streams.py", line 473, in _wait_for_data
    await self._waiter
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\selector_events.py", line 812, in _read_ready__data_received
    data = self._sock.recv(self.max_size)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\server.py", line 231, in handler
    await self.ws_handler(self)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\server.py", line 1137, in _ws_handler
    )(websocket, websocket.path)
  File "D:\workspace\ocpp_test\server\connect.py", line 156, in on_connect
    await Value.chargePoint.start()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\ocpp\charge_point.py", line 125, in start
    message = await self._connection.recv()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 552, in recv
    await self.ensure_open()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 920, in ensure_open
    raise self.connection_closed_exc()
websockets.exceptions.ConnectionClosedError: no close frame received or sent
[INFO server.py:259] connection closed
[INFO server.py:641] connection open
[INFO connect.py:146] Protocols Matched: ocpp1.6
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312102800000001","BootNotification",{"chargePointModel":"MaxiChargerAC","chargePointVendor":"Autel","firmwareVersion":"CAQoSPAGNL"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312102800000001",{"currentTime":"2022-01-23T12:10:28.123Z","interval":10,"status":"Accepted"}]
[INFO test_Recurrent_cpVoltN.py:69] 稍等5秒，等桩连上后台
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312102800000002","StatusNotification",{"connectorId":0,"status":"Available","errorCode":"NoError"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312102800000002",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312102800000003","StatusNotification",{"connectorId":1,"status":"Preparing","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312102800000003",{}]
[INFO test_Recurrent_cpVoltN.py:31] ========这是第49次开始执行========
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"e0f0cfff-b713-4f9b-9732-f656e6ab2ead","RemoteStartTransaction",{"idTag":"AE0022A1GM9C00066K","connectorId":1,"chargingProfile":{"chargingProfileId":1,"transactionId":1,"stackLevel":1,"chargingProfilePurpose":"ChargePointMaxProfile","chargingProfileKind":"Absolute","recurrencyKind":"Daily","validFrom":"date-time","validTo":"date-time","chargingSchedule":{"duration":10,"startSchedule":"date-time","chargingRateUnit":"W","chargingSchedulePeriod":[{"startPeriod":1,"limit":1.5,"numberPhases":1}],"minChargingRate":1.5}}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"e0f0cfff-b713-4f9b-9732-f656e6ab2ead",{"status":"Accepted"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312103700000004","Authorize",{"idTag":"AE0022A1GM9C00066K"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312103700000004",{"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312103900000005","StatusNotification",{"connectorId":1,"status":"Charging","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312103900000005",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312103900000006","StartTransaction",{"connectorId":1,"idTag":"AE0022A1GM9C00066K","meterStart":528242,"timestamp":"2022-01-23T12:10:39.000Z"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312103900000006",{"transactionId":1,"idTagInfo":{"status":"Accepted"}}]
[INFO test_Recurrent_cpVoltN.py:52] ********正在充电********稍等约1分钟********
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"a654c9e3-c629-4ff6-83fd-e773b3142109","RemoteStopTransaction",{"transactionId":1}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312104100000007","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T12:10:41.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"212.790000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.370000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.950000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312104100000007",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312105200000008","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T12:11:12.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"212.700000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.370000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.950000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312105200000008",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"a654c9e3-c629-4ff6-83fd-e773b3142109",{"status":"Accepted"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231211380000000E","StopTransaction",{"idTag":"AE0022A1GM9C00066K","transactionId":1,"meterStop":528242,"timestamp":"2022-01-23T12:11:37.000Z","reason":"Remote"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231211380000000E",{"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312110200000009","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T12:11:42.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312110200000009",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231211120000000A","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T12:11:42.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231211120000000A",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231211220000000B","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T12:11:43.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231211220000000B",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231211300000000C","StatusNotification",{"connectorId":1,"status":"Preparing","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231211300000000C",{}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"04477cb3-00fd-41c6-b56f-4c220151f5be","Reset",{"type":"Soft"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"04477cb3-00fd-41c6-b56f-4c220151f5be",{"status":"Accepted"}]
[ERROR server.py:233] connection handler failed
Traceback (most recent call last):
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 944, in transfer_data
    message = await self.read_message()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1013, in read_message
    frame = await self.read_data_frame(max_size=self.max_size)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1089, in read_data_frame
    frame = await self.read_frame(max_size)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1148, in read_frame
    extensions=self.extensions,
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\framing.py", line 70, in read
    data = await reader(2)
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\streams.py", line 679, in readexactly
    await self._wait_for_data('readexactly')
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\streams.py", line 473, in _wait_for_data
    await self._waiter
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\selector_events.py", line 812, in _read_ready__data_received
    data = self._sock.recv(self.max_size)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\server.py", line 231, in handler
    await self.ws_handler(self)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\server.py", line 1137, in _ws_handler
    )(websocket, websocket.path)
  File "D:\workspace\ocpp_test\server\connect.py", line 156, in on_connect
    await Value.chargePoint.start()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\ocpp\charge_point.py", line 125, in start
    message = await self._connection.recv()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 552, in recv
    await self.ensure_open()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 920, in ensure_open
    raise self.connection_closed_exc()
websockets.exceptions.ConnectionClosedError: no close frame received or sent
[INFO server.py:259] connection closed
[INFO server.py:641] connection open
[INFO connect.py:146] Protocols Matched: ocpp1.6
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312120800000001","BootNotification",{"chargePointModel":"MaxiChargerAC","chargePointVendor":"Autel","firmwareVersion":"CAQoSPAGNL"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312120800000001",{"currentTime":"2022-01-23T12:12:09.123Z","interval":10,"status":"Accepted"}]
[INFO test_Recurrent_cpVoltN.py:69] 稍等5秒，等桩连上后台
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312120900000002","StatusNotification",{"connectorId":0,"status":"Available","errorCode":"NoError"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312120900000002",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312120900000003","StatusNotification",{"connectorId":1,"status":"Preparing","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312120900000003",{}]
[INFO test_Recurrent_cpVoltN.py:31] ========这是第50次开始执行========
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"e924d027-bb8b-4fe5-a5e8-e01ee0913cbb","RemoteStartTransaction",{"idTag":"AE0022A1GM9C00066K","connectorId":1,"chargingProfile":{"chargingProfileId":1,"transactionId":1,"stackLevel":1,"chargingProfilePurpose":"ChargePointMaxProfile","chargingProfileKind":"Absolute","recurrencyKind":"Daily","validFrom":"date-time","validTo":"date-time","chargingSchedule":{"duration":10,"startSchedule":"date-time","chargingRateUnit":"W","chargingSchedulePeriod":[{"startPeriod":1,"limit":1.5,"numberPhases":1}],"minChargingRate":1.5}}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"e924d027-bb8b-4fe5-a5e8-e01ee0913cbb",{"status":"Accepted"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312121800000004","Authorize",{"idTag":"AE0022A1GM9C00066K"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312121800000004",{"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312122000000005","StatusNotification",{"connectorId":1,"status":"Charging","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312122000000005",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312122100000006","StartTransaction",{"connectorId":1,"idTag":"AE0022A1GM9C00066K","meterStart":528242,"timestamp":"2022-01-23T12:12:20.000Z"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312122100000006",{"transactionId":1,"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312122200000007","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T12:12:22.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"212.630000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.380000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.950000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312122200000007",{}]
[INFO test_Recurrent_cpVoltN.py:52] ********正在充电********稍等约1分钟********
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"2fe2691d-5445-430d-ac10-cb7c5b6cde86","RemoteStopTransaction",{"transactionId":1}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312123200000008","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T12:12:32.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"212.680000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.380000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.950000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312123200000008",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312124300000009","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T12:13:02.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"212.710000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.370000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.950000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312124300000009",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"2fe2691d-5445-430d-ac10-cb7c5b6cde86",{"status":"Accepted"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231213220000000F","StopTransaction",{"idTag":"AE0022A1GM9C00066K","transactionId":1,"meterStop":528242,"timestamp":"2022-01-23T12:13:21.000Z","reason":"Remote"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231213220000000F",{"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231212530000000A","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T12:13:33.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231212530000000A",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231213030000000B","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T12:13:33.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231213030000000B",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231213130000000C","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T12:13:34.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231213130000000C",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231213140000000D","StatusNotification",{"connectorId":1,"status":"Preparing","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231213140000000D",{}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"6d1c02cf-f175-4a2e-8ff0-9b959d6a2d2c","Reset",{"type":"Soft"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"6d1c02cf-f175-4a2e-8ff0-9b959d6a2d2c",{"status":"Accepted"}]
[ERROR server.py:233] connection handler failed
Traceback (most recent call last):
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 944, in transfer_data
    message = await self.read_message()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1013, in read_message
    frame = await self.read_data_frame(max_size=self.max_size)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1089, in read_data_frame
    frame = await self.read_frame(max_size)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1148, in read_frame
    extensions=self.extensions,
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\framing.py", line 70, in read
    data = await reader(2)
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\streams.py", line 679, in readexactly
    await self._wait_for_data('readexactly')
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\streams.py", line 473, in _wait_for_data
    await self._waiter
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\selector_events.py", line 812, in _read_ready__data_received
    data = self._sock.recv(self.max_size)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\server.py", line 231, in handler
    await self.ws_handler(self)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\server.py", line 1137, in _ws_handler
    )(websocket, websocket.path)
  File "D:\workspace\ocpp_test\server\connect.py", line 156, in on_connect
    await Value.chargePoint.start()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\ocpp\charge_point.py", line 125, in start
    message = await self._connection.recv()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 552, in recv
    await self.ensure_open()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 920, in ensure_open
    raise self.connection_closed_exc()
websockets.exceptions.ConnectionClosedError: no close frame received or sent
[INFO server.py:259] connection closed
[INFO server.py:641] connection open
[INFO connect.py:146] Protocols Matched: ocpp1.6
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312135800000001","BootNotification",{"chargePointModel":"MaxiChargerAC","chargePointVendor":"Autel","firmwareVersion":"CAQoSPAGNL"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312135800000001",{"currentTime":"2022-01-23T12:14:00.123Z","interval":10,"status":"Accepted"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312140000000002","StatusNotification",{"connectorId":0,"status":"Available","errorCode":"NoError"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312140000000002",{}]
[INFO test_Recurrent_cpVoltN.py:69] 稍等5秒，等桩连上后台
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312140000000003","StatusNotification",{"connectorId":1,"status":"Preparing","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312140000000003",{}]
[INFO test_Recurrent_cpVoltN.py:31] ========这是第51次开始执行========
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"8714b961-4ec3-4989-a79e-a34283231cc1","RemoteStartTransaction",{"idTag":"AE0022A1GM9C00066K","connectorId":1,"chargingProfile":{"chargingProfileId":1,"transactionId":1,"stackLevel":1,"chargingProfilePurpose":"ChargePointMaxProfile","chargingProfileKind":"Absolute","recurrencyKind":"Daily","validFrom":"date-time","validTo":"date-time","chargingSchedule":{"duration":10,"startSchedule":"date-time","chargingRateUnit":"W","chargingSchedulePeriod":[{"startPeriod":1,"limit":1.5,"numberPhases":1}],"minChargingRate":1.5}}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"8714b961-4ec3-4989-a79e-a34283231cc1",{"status":"Accepted"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312140900000004","Authorize",{"idTag":"AE0022A1GM9C00066K"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312140900000004",{"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312141100000005","StatusNotification",{"connectorId":1,"status":"Charging","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312141100000005",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312141200000006","StartTransaction",{"connectorId":1,"idTag":"AE0022A1GM9C00066K","meterStart":528242,"timestamp":"2022-01-23T12:14:11.000Z"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312141200000006",{"transactionId":1,"idTagInfo":{"status":"Accepted"}}]
[INFO test_Recurrent_cpVoltN.py:52] ********正在充电********稍等约1分钟********
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"34bf5d4e-3d66-418b-99bb-1559ebb207b0","RemoteStopTransaction",{"transactionId":1}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312141300000007","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T12:14:13.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"212.370000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.360000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.950000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312141300000007",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312142300000008","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T12:14:43.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"212.510000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.360000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.950000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312142300000008",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"34bf5d4e-3d66-418b-99bb-1559ebb207b0",{"status":"Accepted"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231215100000000E","StopTransaction",{"idTag":"AE0022A1GM9C00066K","transactionId":1,"meterStop":528242,"timestamp":"2022-01-23T12:15:09.000Z","reason":"Remote"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231215100000000E",{"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312143300000009","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T12:15:14.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312143300000009",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231214430000000A","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T12:15:14.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231214430000000A",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231214540000000B","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T12:15:15.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231214540000000B",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231215020000000C","StatusNotification",{"connectorId":1,"status":"Preparing","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231215020000000C",{}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"4e16ee37-0040-4e32-a00d-c519fe12aabb","Reset",{"type":"Soft"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"4e16ee37-0040-4e32-a00d-c519fe12aabb",{"status":"Accepted"}]
[ERROR server.py:233] connection handler failed
Traceback (most recent call last):
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 944, in transfer_data
    message = await self.read_message()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1013, in read_message
    frame = await self.read_data_frame(max_size=self.max_size)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1089, in read_data_frame
    frame = await self.read_frame(max_size)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1148, in read_frame
    extensions=self.extensions,
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\framing.py", line 70, in read
    data = await reader(2)
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\streams.py", line 679, in readexactly
    await self._wait_for_data('readexactly')
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\streams.py", line 473, in _wait_for_data
    await self._waiter
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\selector_events.py", line 812, in _read_ready__data_received
    data = self._sock.recv(self.max_size)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\server.py", line 231, in handler
    await self.ws_handler(self)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\server.py", line 1137, in _ws_handler
    )(websocket, websocket.path)
  File "D:\workspace\ocpp_test\server\connect.py", line 156, in on_connect
    await Value.chargePoint.start()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\ocpp\charge_point.py", line 125, in start
    message = await self._connection.recv()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 552, in recv
    await self.ensure_open()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 920, in ensure_open
    raise self.connection_closed_exc()
websockets.exceptions.ConnectionClosedError: no close frame received or sent
[INFO server.py:259] connection closed
[INFO server.py:641] connection open
[INFO connect.py:146] Protocols Matched: ocpp1.6
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312153300000001","BootNotification",{"chargePointModel":"MaxiChargerAC","chargePointVendor":"Autel","firmwareVersion":"CAQoSPAGNL"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312153300000001",{"currentTime":"2022-01-23T12:15:33.123Z","interval":10,"status":"Accepted"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312153300000002","StatusNotification",{"connectorId":0,"status":"Available","errorCode":"NoError"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312153300000002",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312153300000003","StatusNotification",{"connectorId":1,"status":"Preparing","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312153300000003",{}]
[INFO test_Recurrent_cpVoltN.py:69] 稍等5秒，等桩连上后台
[INFO test_Recurrent_cpVoltN.py:31] ========这是第52次开始执行========
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"cb0d673d-3d8b-4a49-bccd-be1887229257","RemoteStartTransaction",{"idTag":"AE0022A1GM9C00066K","connectorId":1,"chargingProfile":{"chargingProfileId":1,"transactionId":1,"stackLevel":1,"chargingProfilePurpose":"ChargePointMaxProfile","chargingProfileKind":"Absolute","recurrencyKind":"Daily","validFrom":"date-time","validTo":"date-time","chargingSchedule":{"duration":10,"startSchedule":"date-time","chargingRateUnit":"W","chargingSchedulePeriod":[{"startPeriod":1,"limit":1.5,"numberPhases":1}],"minChargingRate":1.5}}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"cb0d673d-3d8b-4a49-bccd-be1887229257",{"status":"Accepted"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312154000000004","Authorize",{"idTag":"AE0022A1GM9C00066K"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312154000000004",{"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312154300000005","StatusNotification",{"connectorId":1,"status":"Charging","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312154300000005",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312154400000006","StartTransaction",{"connectorId":1,"idTag":"AE0022A1GM9C00066K","meterStart":528242,"timestamp":"2022-01-23T12:15:43.000Z"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312154400000006",{"transactionId":1,"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312154500000007","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T12:15:45.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"212.410000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.370000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.950000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312154500000007",{}]
[INFO test_Recurrent_cpVoltN.py:52] ********正在充电********稍等约1分钟********
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"dd48444e-8fa0-45f7-8082-3f0e44eaf446","RemoteStopTransaction",{"transactionId":1}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312155500000008","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T12:15:56.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"212.450000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.370000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.950000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312155500000008",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312160600000009","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T12:16:26.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"212.480000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.370000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.950000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312160600000009",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"dd48444e-8fa0-45f7-8082-3f0e44eaf446",{"status":"Accepted"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231216440000000E","StopTransaction",{"idTag":"AE0022A1GM9C00066K","transactionId":1,"meterStop":528242,"timestamp":"2022-01-23T12:16:43.000Z","reason":"Remote"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231216440000000E",{"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231216160000000A","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T12:16:56.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231216160000000A",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231216260000000B","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T12:16:57.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231216260000000B",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231216360000000C","StatusNotification",{"connectorId":1,"status":"Preparing","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231216360000000C",{}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"5c4402c0-2143-4afe-9f00-e144f58c7662","Reset",{"type":"Soft"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"5c4402c0-2143-4afe-9f00-e144f58c7662",{"status":"Accepted"}]
[ERROR server.py:233] connection handler failed
Traceback (most recent call last):
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 944, in transfer_data
    message = await self.read_message()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1013, in read_message
    frame = await self.read_data_frame(max_size=self.max_size)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1089, in read_data_frame
    frame = await self.read_frame(max_size)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1148, in read_frame
    extensions=self.extensions,
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\framing.py", line 70, in read
    data = await reader(2)
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\streams.py", line 679, in readexactly
    await self._wait_for_data('readexactly')
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\streams.py", line 473, in _wait_for_data
    await self._waiter
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\selector_events.py", line 812, in _read_ready__data_received
    data = self._sock.recv(self.max_size)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\server.py", line 231, in handler
    await self.ws_handler(self)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\server.py", line 1137, in _ws_handler
    )(websocket, websocket.path)
  File "D:\workspace\ocpp_test\server\connect.py", line 156, in on_connect
    await Value.chargePoint.start()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\ocpp\charge_point.py", line 125, in start
    message = await self._connection.recv()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 552, in recv
    await self.ensure_open()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 920, in ensure_open
    raise self.connection_closed_exc()
websockets.exceptions.ConnectionClosedError: no close frame received or sent
[INFO server.py:259] connection closed
[INFO server.py:641] connection open
[INFO connect.py:146] Protocols Matched: ocpp1.6
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312172400000001","BootNotification",{"chargePointModel":"MaxiChargerAC","chargePointVendor":"Autel","firmwareVersion":"CAQoSPAGNL"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312172400000001",{"currentTime":"2022-01-23T12:17:25.123Z","interval":10,"status":"Accepted"}]
[INFO test_Recurrent_cpVoltN.py:69] 稍等5秒，等桩连上后台
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312172500000002","StatusNotification",{"connectorId":0,"status":"Available","errorCode":"NoError"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312172500000002",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312172500000003","StatusNotification",{"connectorId":1,"status":"Preparing","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312172500000003",{}]
[INFO test_Recurrent_cpVoltN.py:31] ========这是第53次开始执行========
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"df5dbd3c-4fa2-4df4-901e-95e460a66961","RemoteStartTransaction",{"idTag":"AE0022A1GM9C00066K","connectorId":1,"chargingProfile":{"chargingProfileId":1,"transactionId":1,"stackLevel":1,"chargingProfilePurpose":"ChargePointMaxProfile","chargingProfileKind":"Absolute","recurrencyKind":"Daily","validFrom":"date-time","validTo":"date-time","chargingSchedule":{"duration":10,"startSchedule":"date-time","chargingRateUnit":"W","chargingSchedulePeriod":[{"startPeriod":1,"limit":1.5,"numberPhases":1}],"minChargingRate":1.5}}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"df5dbd3c-4fa2-4df4-901e-95e460a66961",{"status":"Accepted"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312173300000004","Authorize",{"idTag":"AE0022A1GM9C00066K"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312173300000004",{"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312173600000005","StatusNotification",{"connectorId":1,"status":"Charging","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312173600000005",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312173600000006","StartTransaction",{"connectorId":1,"idTag":"AE0022A1GM9C00066K","meterStart":528242,"timestamp":"2022-01-23T12:17:36.000Z"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312173600000006",{"transactionId":1,"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312173800000007","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T12:17:38.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"212.430000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.370000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.950000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312173800000007",{}]
[INFO test_Recurrent_cpVoltN.py:52] ********正在充电********稍等约1分钟********
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"0860164e-154f-4aa5-83cc-8b7a901dd7bd","RemoteStopTransaction",{"transactionId":1}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312174800000008","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T12:17:48.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"212.610000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.370000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.950000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312174800000008",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312175800000009","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T12:18:18.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"212.440000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.360000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.950000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312175800000009",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"0860164e-154f-4aa5-83cc-8b7a901dd7bd",{"status":"Accepted"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231218370000000F","StopTransaction",{"idTag":"AE0022A1GM9C00066K","transactionId":1,"meterStop":528242,"timestamp":"2022-01-23T12:18:36.000Z","reason":"Remote"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231218370000000F",{"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231218090000000A","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T12:18:49.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231218090000000A",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231218190000000B","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T12:18:49.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231218190000000B",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231218290000000C","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T12:18:50.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231218290000000C",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231218300000000D","StatusNotification",{"connectorId":1,"status":"Preparing","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231218300000000D",{}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"ae9d15d8-da13-4b50-8804-304fb3071429","Reset",{"type":"Soft"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"ae9d15d8-da13-4b50-8804-304fb3071429",{"status":"Accepted"}]
[ERROR server.py:233] connection handler failed
Traceback (most recent call last):
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 944, in transfer_data
    message = await self.read_message()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1013, in read_message
    frame = await self.read_data_frame(max_size=self.max_size)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1089, in read_data_frame
    frame = await self.read_frame(max_size)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1148, in read_frame
    extensions=self.extensions,
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\framing.py", line 70, in read
    data = await reader(2)
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\streams.py", line 679, in readexactly
    await self._wait_for_data('readexactly')
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\streams.py", line 473, in _wait_for_data
    await self._waiter
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\selector_events.py", line 812, in _read_ready__data_received
    data = self._sock.recv(self.max_size)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\server.py", line 231, in handler
    await self.ws_handler(self)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\server.py", line 1137, in _ws_handler
    )(websocket, websocket.path)
  File "D:\workspace\ocpp_test\server\connect.py", line 156, in on_connect
    await Value.chargePoint.start()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\ocpp\charge_point.py", line 125, in start
    message = await self._connection.recv()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 552, in recv
    await self.ensure_open()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 920, in ensure_open
    raise self.connection_closed_exc()
websockets.exceptions.ConnectionClosedError: no close frame received or sent
[INFO server.py:259] connection closed
[INFO server.py:641] connection open
[INFO connect.py:146] Protocols Matched: ocpp1.6
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312190600000001","BootNotification",{"chargePointModel":"MaxiChargerAC","chargePointVendor":"Autel","firmwareVersion":"CAQoSPAGNL"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312190600000001",{"currentTime":"2022-01-23T12:19:08.123Z","interval":10,"status":"Accepted"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312190800000002","StatusNotification",{"connectorId":0,"status":"Available","errorCode":"NoError"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312190800000002",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312190800000003","StatusNotification",{"connectorId":1,"status":"Preparing","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312190800000003",{}]
[INFO test_Recurrent_cpVoltN.py:69] 稍等5秒，等桩连上后台
[INFO test_Recurrent_cpVoltN.py:31] ========这是第54次开始执行========
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"13527775-3d47-445b-9188-2d07f0e35b2c","RemoteStartTransaction",{"idTag":"AE0022A1GM9C00066K","connectorId":1,"chargingProfile":{"chargingProfileId":1,"transactionId":1,"stackLevel":1,"chargingProfilePurpose":"ChargePointMaxProfile","chargingProfileKind":"Absolute","recurrencyKind":"Daily","validFrom":"date-time","validTo":"date-time","chargingSchedule":{"duration":10,"startSchedule":"date-time","chargingRateUnit":"W","chargingSchedulePeriod":[{"startPeriod":1,"limit":1.5,"numberPhases":1}],"minChargingRate":1.5}}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"13527775-3d47-445b-9188-2d07f0e35b2c",{"status":"Accepted"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312191500000004","Authorize",{"idTag":"AE0022A1GM9C00066K"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312191500000004",{"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312191800000005","StatusNotification",{"connectorId":1,"status":"Charging","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312191800000005",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312191900000006","StartTransaction",{"connectorId":1,"idTag":"AE0022A1GM9C00066K","meterStart":528242,"timestamp":"2022-01-23T12:19:18.000Z"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312191900000006",{"transactionId":1,"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312192000000007","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T12:19:20.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"212.730000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.380000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.950000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312192000000007",{}]
[INFO test_Recurrent_cpVoltN.py:52] ********正在充电********稍等约1分钟********
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"4788ed5f-60a4-44df-9e57-73e64b0ee779","RemoteStopTransaction",{"transactionId":1}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312193000000008","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T12:19:30.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"212.800000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.380000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.950000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312193000000008",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312194000000009","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T12:20:01.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"212.540000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.360000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.950000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312194000000009",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"4788ed5f-60a4-44df-9e57-73e64b0ee779",{"status":"Accepted"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231220190000000F","StopTransaction",{"idTag":"AE0022A1GM9C00066K","transactionId":1,"meterStop":528242,"timestamp":"2022-01-23T12:20:18.000Z","reason":"Remote"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231220190000000F",{"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231219510000000A","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T12:20:31.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231219510000000A",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231220010000000B","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T12:20:31.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231220010000000B",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231220110000000C","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T12:20:32.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231220110000000C",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231220120000000D","StatusNotification",{"connectorId":1,"status":"Preparing","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231220120000000D",{}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"ac148aef-1c9e-45bb-9756-f7fc17d91e73","Reset",{"type":"Soft"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"ac148aef-1c9e-45bb-9756-f7fc17d91e73",{"status":"Accepted"}]
[ERROR server.py:233] connection handler failed
Traceback (most recent call last):
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 944, in transfer_data
    message = await self.read_message()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1013, in read_message
    frame = await self.read_data_frame(max_size=self.max_size)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1089, in read_data_frame
    frame = await self.read_frame(max_size)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1148, in read_frame
    extensions=self.extensions,
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\framing.py", line 70, in read
    data = await reader(2)
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\streams.py", line 679, in readexactly
    await self._wait_for_data('readexactly')
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\streams.py", line 473, in _wait_for_data
    await self._waiter
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\selector_events.py", line 812, in _read_ready__data_received
    data = self._sock.recv(self.max_size)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\server.py", line 231, in handler
    await self.ws_handler(self)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\server.py", line 1137, in _ws_handler
    )(websocket, websocket.path)
  File "D:\workspace\ocpp_test\server\connect.py", line 156, in on_connect
    await Value.chargePoint.start()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\ocpp\charge_point.py", line 125, in start
    message = await self._connection.recv()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 552, in recv
    await self.ensure_open()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 920, in ensure_open
    raise self.connection_closed_exc()
websockets.exceptions.ConnectionClosedError: no close frame received or sent
[INFO server.py:259] connection closed
[INFO server.py:641] connection open
[INFO connect.py:146] Protocols Matched: ocpp1.6
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312205700000001","BootNotification",{"chargePointModel":"MaxiChargerAC","chargePointVendor":"Autel","firmwareVersion":"CAQoSPAGNL"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312205700000001",{"currentTime":"2022-01-23T12:20:57.123Z","interval":10,"status":"Accepted"}]
[INFO test_Recurrent_cpVoltN.py:69] 稍等5秒，等桩连上后台
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312205700000002","StatusNotification",{"connectorId":0,"status":"Available","errorCode":"NoError"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312205700000002",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312205700000003","StatusNotification",{"connectorId":1,"status":"Preparing","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312205700000003",{}]
[INFO test_Recurrent_cpVoltN.py:31] ========这是第55次开始执行========
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"83c64bc3-7319-4aba-8f4c-592096849d09","RemoteStartTransaction",{"idTag":"AE0022A1GM9C00066K","connectorId":1,"chargingProfile":{"chargingProfileId":1,"transactionId":1,"stackLevel":1,"chargingProfilePurpose":"ChargePointMaxProfile","chargingProfileKind":"Absolute","recurrencyKind":"Daily","validFrom":"date-time","validTo":"date-time","chargingSchedule":{"duration":10,"startSchedule":"date-time","chargingRateUnit":"W","chargingSchedulePeriod":[{"startPeriod":1,"limit":1.5,"numberPhases":1}],"minChargingRate":1.5}}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"83c64bc3-7319-4aba-8f4c-592096849d09",{"status":"Accepted"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312210500000004","Authorize",{"idTag":"AE0022A1GM9C00066K"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312210500000004",{"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312210800000005","StatusNotification",{"connectorId":1,"status":"Charging","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312210800000005",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312210800000006","StartTransaction",{"connectorId":1,"idTag":"AE0022A1GM9C00066K","meterStart":528242,"timestamp":"2022-01-23T12:21:08.000Z"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312210800000006",{"transactionId":1,"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312211000000007","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T12:21:10.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"212.670000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.370000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.950000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312211000000007",{}]
[INFO test_Recurrent_cpVoltN.py:52] ********正在充电********稍等约1分钟********
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"f1e5a96c-d271-46af-beaf-62d33b0a8e0f","RemoteStopTransaction",{"transactionId":1}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312212000000008","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T12:21:20.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"212.790000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.380000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.950000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312212000000008",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312213000000009","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T12:21:51.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"212.890000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.380000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.950000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312213000000009",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"f1e5a96c-d271-46af-beaf-62d33b0a8e0f",{"status":"Accepted"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231222100000000F","StopTransaction",{"idTag":"AE0022A1GM9C00066K","transactionId":1,"meterStop":528242,"timestamp":"2022-01-23T12:22:09.000Z","reason":"Remote"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231222100000000F",{"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231221410000000A","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T12:22:21.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231221410000000A",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231221510000000B","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T12:22:21.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231221510000000B",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231222010000000C","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T12:22:22.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231222010000000C",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231222020000000D","StatusNotification",{"connectorId":1,"status":"Preparing","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231222020000000D",{}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"0ce7dfdf-43ff-4846-9698-b798558e161b","Reset",{"type":"Soft"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"0ce7dfdf-43ff-4846-9698-b798558e161b",{"status":"Accepted"}]
[ERROR server.py:233] connection handler failed
Traceback (most recent call last):
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 944, in transfer_data
    message = await self.read_message()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1013, in read_message
    frame = await self.read_data_frame(max_size=self.max_size)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1089, in read_data_frame
    frame = await self.read_frame(max_size)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1148, in read_frame
    extensions=self.extensions,
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\framing.py", line 70, in read
    data = await reader(2)
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\streams.py", line 679, in readexactly
    await self._wait_for_data('readexactly')
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\streams.py", line 473, in _wait_for_data
    await self._waiter
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\selector_events.py", line 812, in _read_ready__data_received
    data = self._sock.recv(self.max_size)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\server.py", line 231, in handler
    await self.ws_handler(self)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\server.py", line 1137, in _ws_handler
    )(websocket, websocket.path)
  File "D:\workspace\ocpp_test\server\connect.py", line 156, in on_connect
    await Value.chargePoint.start()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\ocpp\charge_point.py", line 125, in start
    message = await self._connection.recv()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 552, in recv
    await self.ensure_open()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 920, in ensure_open
    raise self.connection_closed_exc()
websockets.exceptions.ConnectionClosedError: no close frame received or sent
[INFO server.py:259] connection closed
[INFO server.py:641] connection open
[INFO connect.py:146] Protocols Matched: ocpp1.6
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312224600000001","BootNotification",{"chargePointModel":"MaxiChargerAC","chargePointVendor":"Autel","firmwareVersion":"CAQoSPAGNL"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312224600000001",{"currentTime":"2022-01-23T12:22:47.123Z","interval":10,"status":"Accepted"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312224700000002","StatusNotification",{"connectorId":0,"status":"Available","errorCode":"NoError"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312224700000002",{}]
[INFO test_Recurrent_cpVoltN.py:69] 稍等5秒，等桩连上后台
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312224700000003","StatusNotification",{"connectorId":1,"status":"Preparing","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312224700000003",{}]
[INFO test_Recurrent_cpVoltN.py:31] ========这是第56次开始执行========
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"a6f0eac6-98b1-452f-97a1-fe2a066edfa5","RemoteStartTransaction",{"idTag":"AE0022A1GM9C00066K","connectorId":1,"chargingProfile":{"chargingProfileId":1,"transactionId":1,"stackLevel":1,"chargingProfilePurpose":"ChargePointMaxProfile","chargingProfileKind":"Absolute","recurrencyKind":"Daily","validFrom":"date-time","validTo":"date-time","chargingSchedule":{"duration":10,"startSchedule":"date-time","chargingRateUnit":"W","chargingSchedulePeriod":[{"startPeriod":1,"limit":1.5,"numberPhases":1}],"minChargingRate":1.5}}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"a6f0eac6-98b1-452f-97a1-fe2a066edfa5",{"status":"Accepted"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312225600000004","Authorize",{"idTag":"AE0022A1GM9C00066K"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312225600000004",{"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312225800000005","StatusNotification",{"connectorId":1,"status":"Charging","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312225800000005",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312225900000006","StartTransaction",{"connectorId":1,"idTag":"AE0022A1GM9C00066K","meterStart":528242,"timestamp":"2022-01-23T12:22:58.000Z"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312225900000006",{"transactionId":1,"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312230000000007","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T12:23:00.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"212.880000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.380000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.950000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312230000000007",{}]
[INFO test_Recurrent_cpVoltN.py:52] ********正在充电********稍等约1分钟********
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"b8f0a0e9-29aa-4cac-8355-94db5364d0a5","RemoteStopTransaction",{"transactionId":1}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312231000000008","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T12:23:10.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"212.910000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.380000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.950000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312231000000008",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312232100000009","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T12:23:40.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"212.770000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.380000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.950000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312232100000009",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"b8f0a0e9-29aa-4cac-8355-94db5364d0a5",{"status":"Accepted"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231224000000000F","StopTransaction",{"idTag":"AE0022A1GM9C00066K","transactionId":1,"meterStop":528242,"timestamp":"2022-01-23T12:23:59.000Z","reason":"Remote"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231224000000000F",{"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231223310000000A","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T12:24:11.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231223310000000A",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231223410000000B","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T12:24:11.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231223410000000B",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231223510000000C","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T12:24:12.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231223510000000C",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231223520000000D","StatusNotification",{"connectorId":1,"status":"Preparing","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231223520000000D",{}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"4c4bd341-bc90-4458-a9ce-ff6da916e1b5","Reset",{"type":"Soft"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"4c4bd341-bc90-4458-a9ce-ff6da916e1b5",{"status":"Accepted"}]
[ERROR server.py:233] connection handler failed
Traceback (most recent call last):
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 944, in transfer_data
    message = await self.read_message()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1013, in read_message
    frame = await self.read_data_frame(max_size=self.max_size)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1089, in read_data_frame
    frame = await self.read_frame(max_size)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1148, in read_frame
    extensions=self.extensions,
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\framing.py", line 70, in read
    data = await reader(2)
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\streams.py", line 679, in readexactly
    await self._wait_for_data('readexactly')
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\streams.py", line 473, in _wait_for_data
    await self._waiter
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\selector_events.py", line 812, in _read_ready__data_received
    data = self._sock.recv(self.max_size)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\server.py", line 231, in handler
    await self.ws_handler(self)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\server.py", line 1137, in _ws_handler
    )(websocket, websocket.path)
  File "D:\workspace\ocpp_test\server\connect.py", line 156, in on_connect
    await Value.chargePoint.start()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\ocpp\charge_point.py", line 125, in start
    message = await self._connection.recv()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 552, in recv
    await self.ensure_open()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 920, in ensure_open
    raise self.connection_closed_exc()
websockets.exceptions.ConnectionClosedError: no close frame received or sent
[INFO server.py:259] connection closed
[INFO server.py:641] connection open
[INFO connect.py:146] Protocols Matched: ocpp1.6
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312243600000001","BootNotification",{"chargePointModel":"MaxiChargerAC","chargePointVendor":"Autel","firmwareVersion":"CAQoSPAGNL"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312243600000001",{"currentTime":"2022-01-23T12:24:37.123Z","interval":10,"status":"Accepted"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312243700000002","StatusNotification",{"connectorId":0,"status":"Available","errorCode":"NoError"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312243700000002",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312243700000003","StatusNotification",{"connectorId":1,"status":"Preparing","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312243700000003",{}]
[INFO test_Recurrent_cpVoltN.py:69] 稍等5秒，等桩连上后台
[INFO test_Recurrent_cpVoltN.py:31] ========这是第57次开始执行========
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"4bb2372e-4930-4ec2-9d28-559a6e404e14","RemoteStartTransaction",{"idTag":"AE0022A1GM9C00066K","connectorId":1,"chargingProfile":{"chargingProfileId":1,"transactionId":1,"stackLevel":1,"chargingProfilePurpose":"ChargePointMaxProfile","chargingProfileKind":"Absolute","recurrencyKind":"Daily","validFrom":"date-time","validTo":"date-time","chargingSchedule":{"duration":10,"startSchedule":"date-time","chargingRateUnit":"W","chargingSchedulePeriod":[{"startPeriod":1,"limit":1.5,"numberPhases":1}],"minChargingRate":1.5}}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"4bb2372e-4930-4ec2-9d28-559a6e404e14",{"status":"Accepted"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312244300000004","Authorize",{"idTag":"AE0022A1GM9C00066K"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312244300000004",{"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312244600000005","StatusNotification",{"connectorId":1,"status":"Charging","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312244600000005",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312244700000006","StartTransaction",{"connectorId":1,"idTag":"AE0022A1GM9C00066K","meterStart":528242,"timestamp":"2022-01-23T12:24:46.000Z"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312244700000006",{"transactionId":1,"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312244800000007","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T12:24:48.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"212.990000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.390000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.960000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312244800000007",{}]
[INFO test_Recurrent_cpVoltN.py:52] ********正在充电********稍等约1分钟********
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"966f498a-1848-41e4-ad36-d778dfb800ae","RemoteStopTransaction",{"transactionId":1}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312245800000008","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T12:24:58.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"212.880000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.380000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.950000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312245800000008",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312250900000009","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T12:25:28.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"212.930000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.380000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.960000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312250900000009",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"966f498a-1848-41e4-ad36-d778dfb800ae",{"status":"Accepted"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231225470000000F","StopTransaction",{"idTag":"AE0022A1GM9C00066K","transactionId":1,"meterStop":528242,"timestamp":"2022-01-23T12:25:46.000Z","reason":"Remote"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231225470000000F",{"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231225190000000A","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T12:25:58.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231225190000000A",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231225290000000B","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T12:25:59.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231225290000000B",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231225390000000C","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T12:25:59.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231225390000000C",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231225400000000D","StatusNotification",{"connectorId":1,"status":"Preparing","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231225400000000D",{}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"0f101b8d-69cd-4fbc-b81a-9e5b7b6634ac","Reset",{"type":"Soft"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"0f101b8d-69cd-4fbc-b81a-9e5b7b6634ac",{"status":"Accepted"}]
[ERROR server.py:233] connection handler failed
Traceback (most recent call last):
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 944, in transfer_data
    message = await self.read_message()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1013, in read_message
    frame = await self.read_data_frame(max_size=self.max_size)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1089, in read_data_frame
    frame = await self.read_frame(max_size)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1148, in read_frame
    extensions=self.extensions,
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\framing.py", line 70, in read
    data = await reader(2)
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\streams.py", line 679, in readexactly
    await self._wait_for_data('readexactly')
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\streams.py", line 473, in _wait_for_data
    await self._waiter
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\selector_events.py", line 812, in _read_ready__data_received
    data = self._sock.recv(self.max_size)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\server.py", line 231, in handler
    await self.ws_handler(self)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\server.py", line 1137, in _ws_handler
    )(websocket, websocket.path)
  File "D:\workspace\ocpp_test\server\connect.py", line 156, in on_connect
    await Value.chargePoint.start()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\ocpp\charge_point.py", line 125, in start
    message = await self._connection.recv()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 552, in recv
    await self.ensure_open()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 920, in ensure_open
    raise self.connection_closed_exc()
websockets.exceptions.ConnectionClosedError: no close frame received or sent
[INFO server.py:259] connection closed
[INFO server.py:641] connection open
[INFO connect.py:146] Protocols Matched: ocpp1.6
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312262400000001","BootNotification",{"chargePointModel":"MaxiChargerAC","chargePointVendor":"Autel","firmwareVersion":"CAQoSPAGNL"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312262400000001",{"currentTime":"2022-01-23T12:26:25.123Z","interval":10,"status":"Accepted"}]
[INFO test_Recurrent_cpVoltN.py:69] 稍等5秒，等桩连上后台
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312262500000002","StatusNotification",{"connectorId":0,"status":"Available","errorCode":"NoError"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312262500000002",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312262500000003","StatusNotification",{"connectorId":1,"status":"Preparing","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312262500000003",{}]
[INFO test_Recurrent_cpVoltN.py:31] ========这是第58次开始执行========
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"47497c05-f857-4e1f-9aaa-633c09ae1f6c","RemoteStartTransaction",{"idTag":"AE0022A1GM9C00066K","connectorId":1,"chargingProfile":{"chargingProfileId":1,"transactionId":1,"stackLevel":1,"chargingProfilePurpose":"ChargePointMaxProfile","chargingProfileKind":"Absolute","recurrencyKind":"Daily","validFrom":"date-time","validTo":"date-time","chargingSchedule":{"duration":10,"startSchedule":"date-time","chargingRateUnit":"W","chargingSchedulePeriod":[{"startPeriod":1,"limit":1.5,"numberPhases":1}],"minChargingRate":1.5}}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"47497c05-f857-4e1f-9aaa-633c09ae1f6c",{"status":"Accepted"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312263300000004","Authorize",{"idTag":"AE0022A1GM9C00066K"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312263300000004",{"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312263600000005","StatusNotification",{"connectorId":1,"status":"Charging","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312263600000005",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312263600000006","StartTransaction",{"connectorId":1,"idTag":"AE0022A1GM9C00066K","meterStart":528242,"timestamp":"2022-01-23T12:26:36.000Z"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312263600000006",{"transactionId":1,"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312263800000007","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T12:26:38.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"212.450000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.360000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.950000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312263800000007",{}]
[INFO test_Recurrent_cpVoltN.py:52] ********正在充电********稍等约1分钟********
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"22ebcb0d-0eec-498d-9fed-c5ff178cdb1f","RemoteStopTransaction",{"transactionId":1}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312264800000008","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T12:26:48.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"212.670000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.380000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.950000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312264800000008",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312265800000009","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T12:27:18.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"212.460000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.370000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.950000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312265800000009",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"22ebcb0d-0eec-498d-9fed-c5ff178cdb1f",{"status":"Accepted"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231227370000000F","StopTransaction",{"idTag":"AE0022A1GM9C00066K","transactionId":1,"meterStop":528242,"timestamp":"2022-01-23T12:27:36.000Z","reason":"Remote"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231227370000000F",{"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231227080000000A","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T12:27:48.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.010000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231227080000000A",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231227190000000B","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T12:27:49.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.010000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231227190000000B",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231227290000000C","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T12:27:50.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231227290000000C",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231227300000000D","StatusNotification",{"connectorId":1,"status":"Preparing","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231227300000000D",{}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"3005ecc7-8404-4bbb-bdfb-ab56ab3d74c9","Reset",{"type":"Soft"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"3005ecc7-8404-4bbb-bdfb-ab56ab3d74c9",{"status":"Accepted"}]
[ERROR server.py:233] connection handler failed
Traceback (most recent call last):
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 944, in transfer_data
    message = await self.read_message()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1013, in read_message
    frame = await self.read_data_frame(max_size=self.max_size)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1089, in read_data_frame
    frame = await self.read_frame(max_size)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1148, in read_frame
    extensions=self.extensions,
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\framing.py", line 70, in read
    data = await reader(2)
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\streams.py", line 679, in readexactly
    await self._wait_for_data('readexactly')
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\streams.py", line 473, in _wait_for_data
    await self._waiter
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\selector_events.py", line 812, in _read_ready__data_received
    data = self._sock.recv(self.max_size)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\server.py", line 231, in handler
    await self.ws_handler(self)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\server.py", line 1137, in _ws_handler
    )(websocket, websocket.path)
  File "D:\workspace\ocpp_test\server\connect.py", line 156, in on_connect
    await Value.chargePoint.start()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\ocpp\charge_point.py", line 125, in start
    message = await self._connection.recv()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 552, in recv
    await self.ensure_open()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 920, in ensure_open
    raise self.connection_closed_exc()
websockets.exceptions.ConnectionClosedError: no close frame received or sent
[INFO server.py:259] connection closed
[INFO server.py:641] connection open
[INFO connect.py:146] Protocols Matched: ocpp1.6
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312281500000001","BootNotification",{"chargePointModel":"MaxiChargerAC","chargePointVendor":"Autel","firmwareVersion":"CAQoSPAGNL"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312281500000001",{"currentTime":"2022-01-23T12:28:16.123Z","interval":10,"status":"Accepted"}]
[INFO test_Recurrent_cpVoltN.py:69] 稍等5秒，等桩连上后台
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312281600000002","StatusNotification",{"connectorId":0,"status":"Available","errorCode":"NoError"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312281600000002",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312281600000003","StatusNotification",{"connectorId":1,"status":"Preparing","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312281600000003",{}]
[INFO test_Recurrent_cpVoltN.py:31] ========这是第59次开始执行========
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"5271cfd4-bc75-48d0-bb07-802f3c4cdafe","RemoteStartTransaction",{"idTag":"AE0022A1GM9C00066K","connectorId":1,"chargingProfile":{"chargingProfileId":1,"transactionId":1,"stackLevel":1,"chargingProfilePurpose":"ChargePointMaxProfile","chargingProfileKind":"Absolute","recurrencyKind":"Daily","validFrom":"date-time","validTo":"date-time","chargingSchedule":{"duration":10,"startSchedule":"date-time","chargingRateUnit":"W","chargingSchedulePeriod":[{"startPeriod":1,"limit":1.5,"numberPhases":1}],"minChargingRate":1.5}}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"5271cfd4-bc75-48d0-bb07-802f3c4cdafe",{"status":"Accepted"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312282400000004","Authorize",{"idTag":"AE0022A1GM9C00066K"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312282400000004",{"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312282700000006","StartTransaction",{"connectorId":1,"idTag":"AE0022A1GM9C00066K","meterStart":528242,"timestamp":"2022-01-23T12:28:27.000Z"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312282700000006",{"transactionId":1,"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312282700000005","StatusNotification",{"connectorId":1,"status":"Charging","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312282700000005",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312282900000007","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T12:28:29.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"212.770000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.380000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.950000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312282900000007",{}]
[INFO test_Recurrent_cpVoltN.py:52] ********正在充电********稍等约1分钟********
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"35850c67-5757-4323-983b-54c9a5a59c47","RemoteStopTransaction",{"transactionId":1}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312283900000008","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T12:28:39.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"212.890000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.390000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.950000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312283900000008",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312284900000009","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T12:29:09.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"212.790000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.380000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.960000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312284900000009",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"35850c67-5757-4323-983b-54c9a5a59c47",{"status":"Accepted"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231229280000000F","StopTransaction",{"idTag":"AE0022A1GM9C00066K","transactionId":1,"meterStop":528242,"timestamp":"2022-01-23T12:29:27.000Z","reason":"Remote"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231229280000000F",{"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231229000000000A","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T12:29:39.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231229000000000A",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231229100000000B","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T12:29:40.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231229100000000B",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231229200000000C","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T12:29:40.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231229200000000C",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231229210000000D","StatusNotification",{"connectorId":1,"status":"Preparing","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231229210000000D",{}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"ddbe8de4-ae75-41a1-9688-3d52c9694be3","Reset",{"type":"Soft"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"ddbe8de4-ae75-41a1-9688-3d52c9694be3",{"status":"Accepted"}]
[ERROR server.py:233] connection handler failed
Traceback (most recent call last):
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 944, in transfer_data
    message = await self.read_message()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1013, in read_message
    frame = await self.read_data_frame(max_size=self.max_size)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1089, in read_data_frame
    frame = await self.read_frame(max_size)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1148, in read_frame
    extensions=self.extensions,
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\framing.py", line 70, in read
    data = await reader(2)
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\streams.py", line 679, in readexactly
    await self._wait_for_data('readexactly')
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\streams.py", line 473, in _wait_for_data
    await self._waiter
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\selector_events.py", line 812, in _read_ready__data_received
    data = self._sock.recv(self.max_size)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\server.py", line 231, in handler
    await self.ws_handler(self)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\server.py", line 1137, in _ws_handler
    )(websocket, websocket.path)
  File "D:\workspace\ocpp_test\server\connect.py", line 156, in on_connect
    await Value.chargePoint.start()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\ocpp\charge_point.py", line 125, in start
    message = await self._connection.recv()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 552, in recv
    await self.ensure_open()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 920, in ensure_open
    raise self.connection_closed_exc()
websockets.exceptions.ConnectionClosedError: no close frame received or sent
[INFO server.py:259] connection closed
[INFO server.py:641] connection open
[INFO connect.py:146] Protocols Matched: ocpp1.6
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312300500000001","BootNotification",{"chargePointModel":"MaxiChargerAC","chargePointVendor":"Autel","firmwareVersion":"CAQoSPAGNL"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312300500000001",{"currentTime":"2022-01-23T12:30:06.123Z","interval":10,"status":"Accepted"}]
[INFO test_Recurrent_cpVoltN.py:69] 稍等5秒，等桩连上后台
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312300600000002","StatusNotification",{"connectorId":0,"status":"Available","errorCode":"NoError"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312300600000002",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312300600000003","StatusNotification",{"connectorId":1,"status":"Preparing","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312300600000003",{}]
[INFO test_Recurrent_cpVoltN.py:31] ========这是第60次开始执行========
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"f9d7349c-bdde-4c55-b84e-7ca1552f050b","RemoteStartTransaction",{"idTag":"AE0022A1GM9C00066K","connectorId":1,"chargingProfile":{"chargingProfileId":1,"transactionId":1,"stackLevel":1,"chargingProfilePurpose":"ChargePointMaxProfile","chargingProfileKind":"Absolute","recurrencyKind":"Daily","validFrom":"date-time","validTo":"date-time","chargingSchedule":{"duration":10,"startSchedule":"date-time","chargingRateUnit":"W","chargingSchedulePeriod":[{"startPeriod":1,"limit":1.5,"numberPhases":1}],"minChargingRate":1.5}}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"f9d7349c-bdde-4c55-b84e-7ca1552f050b",{"status":"Accepted"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312301500000004","Authorize",{"idTag":"AE0022A1GM9C00066K"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312301500000004",{"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312301700000005","StatusNotification",{"connectorId":1,"status":"Charging","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312301700000005",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312301800000006","StartTransaction",{"connectorId":1,"idTag":"AE0022A1GM9C00066K","meterStart":528242,"timestamp":"2022-01-23T12:30:17.000Z"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312301800000006",{"transactionId":1,"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312301900000007","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T12:30:19.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"212.850000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.390000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.960000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312301900000007",{}]
[INFO test_Recurrent_cpVoltN.py:52] ********正在充电********稍等约1分钟********
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"4854014c-e8c6-4389-836c-ca2715b0a5bc","RemoteStopTransaction",{"transactionId":1}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312302900000008","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T12:30:29.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"212.770000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.380000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.960000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.010000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312302900000008",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312304000000009","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T12:31:00.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"212.740000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.380000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.960000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312304000000009",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"4854014c-e8c6-4389-836c-ca2715b0a5bc",{"status":"Accepted"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231231190000000F","StopTransaction",{"idTag":"AE0022A1GM9C00066K","transactionId":1,"meterStop":528242,"timestamp":"2022-01-23T12:31:18.000Z","reason":"Remote"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231231190000000F",{"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231230500000000A","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T12:31:30.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231230500000000A",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231231000000000B","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T12:31:31.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231231000000000B",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231231100000000C","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T12:31:31.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231231100000000C",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231231110000000D","StatusNotification",{"connectorId":1,"status":"Preparing","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231231110000000D",{}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"38b3714c-18be-4b46-b86f-1e0039ef0947","Reset",{"type":"Soft"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"38b3714c-18be-4b46-b86f-1e0039ef0947",{"status":"Accepted"}]
[ERROR server.py:233] connection handler failed
Traceback (most recent call last):
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 944, in transfer_data
    message = await self.read_message()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1013, in read_message
    frame = await self.read_data_frame(max_size=self.max_size)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1089, in read_data_frame
    frame = await self.read_frame(max_size)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1148, in read_frame
    extensions=self.extensions,
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\framing.py", line 70, in read
    data = await reader(2)
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\streams.py", line 679, in readexactly
    await self._wait_for_data('readexactly')
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\streams.py", line 473, in _wait_for_data
    await self._waiter
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\selector_events.py", line 812, in _read_ready__data_received
    data = self._sock.recv(self.max_size)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\server.py", line 231, in handler
    await self.ws_handler(self)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\server.py", line 1137, in _ws_handler
    )(websocket, websocket.path)
  File "D:\workspace\ocpp_test\server\connect.py", line 156, in on_connect
    await Value.chargePoint.start()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\ocpp\charge_point.py", line 125, in start
    message = await self._connection.recv()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 552, in recv
    await self.ensure_open()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 920, in ensure_open
    raise self.connection_closed_exc()
websockets.exceptions.ConnectionClosedError: no close frame received or sent
[INFO server.py:259] connection closed
[INFO server.py:641] connection open
[INFO connect.py:146] Protocols Matched: ocpp1.6
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312315600000001","BootNotification",{"chargePointModel":"MaxiChargerAC","chargePointVendor":"Autel","firmwareVersion":"CAQoSPAGNL"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312315600000001",{"currentTime":"2022-01-23T12:31:57.123Z","interval":10,"status":"Accepted"}]
[INFO test_Recurrent_cpVoltN.py:69] 稍等5秒，等桩连上后台
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312315700000002","StatusNotification",{"connectorId":0,"status":"Available","errorCode":"NoError"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312315700000002",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312315700000003","StatusNotification",{"connectorId":1,"status":"Preparing","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312315700000003",{}]
[INFO test_Recurrent_cpVoltN.py:31] ========这是第61次开始执行========
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"c8c84e20-c046-434d-8f7e-7bee4213efb2","RemoteStartTransaction",{"idTag":"AE0022A1GM9C00066K","connectorId":1,"chargingProfile":{"chargingProfileId":1,"transactionId":1,"stackLevel":1,"chargingProfilePurpose":"ChargePointMaxProfile","chargingProfileKind":"Absolute","recurrencyKind":"Daily","validFrom":"date-time","validTo":"date-time","chargingSchedule":{"duration":10,"startSchedule":"date-time","chargingRateUnit":"W","chargingSchedulePeriod":[{"startPeriod":1,"limit":1.5,"numberPhases":1}],"minChargingRate":1.5}}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"c8c84e20-c046-434d-8f7e-7bee4213efb2",{"status":"Accepted"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312320500000004","Authorize",{"idTag":"AE0022A1GM9C00066K"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312320500000004",{"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312320800000006","StartTransaction",{"connectorId":1,"idTag":"AE0022A1GM9C00066K","meterStart":528242,"timestamp":"2022-01-23T12:32:08.000Z"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312320800000006",{"transactionId":1,"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312320800000005","StatusNotification",{"connectorId":1,"status":"Charging","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312320800000005",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312321000000007","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T12:32:10.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"212.750000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.380000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.950000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312321000000007",{}]
[INFO test_Recurrent_cpVoltN.py:52] ********正在充电********稍等约1分钟********
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"a2cfe5bf-31f7-4e75-a85b-28601458778d","RemoteStopTransaction",{"transactionId":1}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312322000000008","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T12:32:20.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"212.970000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.390000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.960000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312322000000008",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312323000000009","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T12:32:50.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"212.920000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.380000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.960000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312323000000009",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"a2cfe5bf-31f7-4e75-a85b-28601458778d",{"status":"Accepted"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231233100000000F","StopTransaction",{"idTag":"AE0022A1GM9C00066K","transactionId":1,"meterStop":528242,"timestamp":"2022-01-23T12:33:09.000Z","reason":"Remote"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231233100000000F",{"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231232400000000A","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T12:33:20.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231232400000000A",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231232500000000B","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T12:33:21.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231232500000000B",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231233010000000C","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T12:33:21.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231233010000000C",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231233020000000D","StatusNotification",{"connectorId":1,"status":"Preparing","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231233020000000D",{}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"09c336d9-0e26-4ecc-9ee9-bcdee4405d80","Reset",{"type":"Soft"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"09c336d9-0e26-4ecc-9ee9-bcdee4405d80",{"status":"Accepted"}]
[ERROR server.py:233] connection handler failed
Traceback (most recent call last):
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 944, in transfer_data
    message = await self.read_message()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1013, in read_message
    frame = await self.read_data_frame(max_size=self.max_size)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1089, in read_data_frame
    frame = await self.read_frame(max_size)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1148, in read_frame
    extensions=self.extensions,
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\framing.py", line 70, in read
    data = await reader(2)
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\streams.py", line 679, in readexactly
    await self._wait_for_data('readexactly')
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\streams.py", line 473, in _wait_for_data
    await self._waiter
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\selector_events.py", line 812, in _read_ready__data_received
    data = self._sock.recv(self.max_size)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\server.py", line 231, in handler
    await self.ws_handler(self)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\server.py", line 1137, in _ws_handler
    )(websocket, websocket.path)
  File "D:\workspace\ocpp_test\server\connect.py", line 156, in on_connect
    await Value.chargePoint.start()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\ocpp\charge_point.py", line 125, in start
    message = await self._connection.recv()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 552, in recv
    await self.ensure_open()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 920, in ensure_open
    raise self.connection_closed_exc()
websockets.exceptions.ConnectionClosedError: no close frame received or sent
[INFO server.py:259] connection closed
[INFO server.py:641] connection open
[INFO connect.py:146] Protocols Matched: ocpp1.6
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312334600000001","BootNotification",{"chargePointModel":"MaxiChargerAC","chargePointVendor":"Autel","firmwareVersion":"CAQoSPAGNL"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312334600000001",{"currentTime":"2022-01-23T12:33:47.123Z","interval":10,"status":"Accepted"}]
[INFO test_Recurrent_cpVoltN.py:69] 稍等5秒，等桩连上后台
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312334700000002","StatusNotification",{"connectorId":0,"status":"Available","errorCode":"NoError"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312334700000002",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312334700000003","StatusNotification",{"connectorId":1,"status":"Preparing","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312334700000003",{}]
[INFO test_Recurrent_cpVoltN.py:31] ========这是第62次开始执行========
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"133fb897-9f91-4dca-bd79-4b5635510f90","RemoteStartTransaction",{"idTag":"AE0022A1GM9C00066K","connectorId":1,"chargingProfile":{"chargingProfileId":1,"transactionId":1,"stackLevel":1,"chargingProfilePurpose":"ChargePointMaxProfile","chargingProfileKind":"Absolute","recurrencyKind":"Daily","validFrom":"date-time","validTo":"date-time","chargingSchedule":{"duration":10,"startSchedule":"date-time","chargingRateUnit":"W","chargingSchedulePeriod":[{"startPeriod":1,"limit":1.5,"numberPhases":1}],"minChargingRate":1.5}}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"133fb897-9f91-4dca-bd79-4b5635510f90",{"status":"Accepted"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312335500000004","Authorize",{"idTag":"AE0022A1GM9C00066K"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312335500000004",{"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312335800000005","StatusNotification",{"connectorId":1,"status":"Charging","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312335800000005",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312335900000006","StartTransaction",{"connectorId":1,"idTag":"AE0022A1GM9C00066K","meterStart":528242,"timestamp":"2022-01-23T12:33:58.000Z"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312335900000006",{"transactionId":1,"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312340000000007","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T12:34:00.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"212.510000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.360000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.950000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312340000000007",{}]
[INFO test_Recurrent_cpVoltN.py:52] ********正在充电********稍等约1分钟********
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"be378fec-5bac-49ba-bab2-b58dba785ce8","RemoteStopTransaction",{"transactionId":1}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312341000000008","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T12:34:10.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"212.810000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.380000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.950000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312341000000008",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312342100000009","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T12:34:41.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"213.010000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.390000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.960000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312342100000009",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"be378fec-5bac-49ba-bab2-b58dba785ce8",{"status":"Accepted"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231234590000000E","StopTransaction",{"idTag":"AE0022A1GM9C00066K","transactionId":1,"meterStop":528242,"timestamp":"2022-01-23T12:34:58.000Z","reason":"Remote"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231234590000000E",{"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231234310000000A","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T12:35:11.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231234310000000A",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231234410000000B","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T12:35:12.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231234410000000B",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231234520000000C","StatusNotification",{"connectorId":1,"status":"Preparing","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231234520000000C",{}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"22a6ed54-b61d-4367-83b2-7acb676e9708","Reset",{"type":"Soft"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"22a6ed54-b61d-4367-83b2-7acb676e9708",{"status":"Accepted"}]
[ERROR server.py:233] connection handler failed
Traceback (most recent call last):
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 944, in transfer_data
    message = await self.read_message()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1013, in read_message
    frame = await self.read_data_frame(max_size=self.max_size)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1089, in read_data_frame
    frame = await self.read_frame(max_size)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1148, in read_frame
    extensions=self.extensions,
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\framing.py", line 70, in read
    data = await reader(2)
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\streams.py", line 679, in readexactly
    await self._wait_for_data('readexactly')
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\streams.py", line 473, in _wait_for_data
    await self._waiter
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\selector_events.py", line 812, in _read_ready__data_received
    data = self._sock.recv(self.max_size)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\server.py", line 231, in handler
    await self.ws_handler(self)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\server.py", line 1137, in _ws_handler
    )(websocket, websocket.path)
  File "D:\workspace\ocpp_test\server\connect.py", line 156, in on_connect
    await Value.chargePoint.start()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\ocpp\charge_point.py", line 125, in start
    message = await self._connection.recv()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 552, in recv
    await self.ensure_open()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 920, in ensure_open
    raise self.connection_closed_exc()
websockets.exceptions.ConnectionClosedError: no close frame received or sent
[INFO server.py:259] connection closed
[INFO server.py:641] connection open
[INFO connect.py:146] Protocols Matched: ocpp1.6
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312353700000001","BootNotification",{"chargePointModel":"MaxiChargerAC","chargePointVendor":"Autel","firmwareVersion":"CAQoSPAGNL"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312353700000001",{"currentTime":"2022-01-23T12:35:38.123Z","interval":10,"status":"Accepted"}]
[INFO test_Recurrent_cpVoltN.py:69] 稍等5秒，等桩连上后台
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312353800000002","StatusNotification",{"connectorId":0,"status":"Available","errorCode":"NoError"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312353800000002",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312353800000003","StatusNotification",{"connectorId":1,"status":"Preparing","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312353800000003",{}]
[INFO test_Recurrent_cpVoltN.py:31] ========这是第63次开始执行========
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"42ca126b-7506-4203-b091-e642335cde6f","RemoteStartTransaction",{"idTag":"AE0022A1GM9C00066K","connectorId":1,"chargingProfile":{"chargingProfileId":1,"transactionId":1,"stackLevel":1,"chargingProfilePurpose":"ChargePointMaxProfile","chargingProfileKind":"Absolute","recurrencyKind":"Daily","validFrom":"date-time","validTo":"date-time","chargingSchedule":{"duration":10,"startSchedule":"date-time","chargingRateUnit":"W","chargingSchedulePeriod":[{"startPeriod":1,"limit":1.5,"numberPhases":1}],"minChargingRate":1.5}}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"42ca126b-7506-4203-b091-e642335cde6f",{"status":"Accepted"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312354600000004","Authorize",{"idTag":"AE0022A1GM9C00066K"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312354600000004",{"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312354900000005","StatusNotification",{"connectorId":1,"status":"Charging","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312354900000005",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312354900000006","StartTransaction",{"connectorId":1,"idTag":"AE0022A1GM9C00066K","meterStart":528242,"timestamp":"2022-01-23T12:35:49.000Z"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312354900000006",{"transactionId":1,"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312355100000007","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T12:35:51.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"212.410000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.360000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.950000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312355100000007",{}]
[INFO test_Recurrent_cpVoltN.py:52] ********正在充电********稍等约1分钟********
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"b7fed427-6589-440c-bb9b-f812daab353a","RemoteStopTransaction",{"transactionId":1}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312360100000008","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T12:36:01.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"212.630000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.370000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.950000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312360100000008",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312361100000009","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T12:36:31.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"212.780000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.380000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.950000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.010000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312361100000009",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"b7fed427-6589-440c-bb9b-f812daab353a",{"status":"Accepted"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231236500000000F","StopTransaction",{"idTag":"AE0022A1GM9C00066K","transactionId":1,"meterStop":528242,"timestamp":"2022-01-23T12:36:49.000Z","reason":"Remote"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231236500000000F",{"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231236210000000A","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T12:37:01.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231236210000000A",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231236320000000B","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T12:37:02.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231236320000000B",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231236420000000C","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T12:37:02.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231236420000000C",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231236430000000D","StatusNotification",{"connectorId":1,"status":"Preparing","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231236430000000D",{}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"b8e7d3cf-df26-42c6-adef-1616391b5560","Reset",{"type":"Soft"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"b8e7d3cf-df26-42c6-adef-1616391b5560",{"status":"Accepted"}]
[ERROR server.py:233] connection handler failed
Traceback (most recent call last):
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 944, in transfer_data
    message = await self.read_message()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1013, in read_message
    frame = await self.read_data_frame(max_size=self.max_size)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1089, in read_data_frame
    frame = await self.read_frame(max_size)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1148, in read_frame
    extensions=self.extensions,
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\framing.py", line 70, in read
    data = await reader(2)
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\streams.py", line 679, in readexactly
    await self._wait_for_data('readexactly')
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\streams.py", line 473, in _wait_for_data
    await self._waiter
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\selector_events.py", line 812, in _read_ready__data_received
    data = self._sock.recv(self.max_size)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\server.py", line 231, in handler
    await self.ws_handler(self)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\server.py", line 1137, in _ws_handler
    )(websocket, websocket.path)
  File "D:\workspace\ocpp_test\server\connect.py", line 156, in on_connect
    await Value.chargePoint.start()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\ocpp\charge_point.py", line 125, in start
    message = await self._connection.recv()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 552, in recv
    await self.ensure_open()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 920, in ensure_open
    raise self.connection_closed_exc()
websockets.exceptions.ConnectionClosedError: no close frame received or sent
[INFO server.py:259] connection closed
[INFO server.py:641] connection open
[INFO connect.py:146] Protocols Matched: ocpp1.6
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312372800000001","BootNotification",{"chargePointModel":"MaxiChargerAC","chargePointVendor":"Autel","firmwareVersion":"CAQoSPAGNL"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312372800000001",{"currentTime":"2022-01-23T12:37:28.123Z","interval":10,"status":"Accepted"}]
[INFO test_Recurrent_cpVoltN.py:69] 稍等5秒，等桩连上后台
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312372800000002","StatusNotification",{"connectorId":0,"status":"Available","errorCode":"NoError"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312372800000002",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312372800000003","StatusNotification",{"connectorId":1,"status":"Preparing","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312372800000003",{}]
[INFO test_Recurrent_cpVoltN.py:31] ========这是第64次开始执行========
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"67c5c01a-c25c-4139-be91-2e92ed17da25","RemoteStartTransaction",{"idTag":"AE0022A1GM9C00066K","connectorId":1,"chargingProfile":{"chargingProfileId":1,"transactionId":1,"stackLevel":1,"chargingProfilePurpose":"ChargePointMaxProfile","chargingProfileKind":"Absolute","recurrencyKind":"Daily","validFrom":"date-time","validTo":"date-time","chargingSchedule":{"duration":10,"startSchedule":"date-time","chargingRateUnit":"W","chargingSchedulePeriod":[{"startPeriod":1,"limit":1.5,"numberPhases":1}],"minChargingRate":1.5}}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"67c5c01a-c25c-4139-be91-2e92ed17da25",{"status":"Accepted"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312373600000004","Authorize",{"idTag":"AE0022A1GM9C00066K"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312373600000004",{"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312373900000005","StatusNotification",{"connectorId":1,"status":"Charging","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312373900000005",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312374000000006","StartTransaction",{"connectorId":1,"idTag":"AE0022A1GM9C00066K","meterStart":528242,"timestamp":"2022-01-23T12:37:39.000Z"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312374000000006",{"transactionId":1,"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312374100000007","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T12:37:41.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"212.540000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.370000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.950000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.010000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312374100000007",{}]
[INFO test_Recurrent_cpVoltN.py:52] ********正在充电********稍等约1分钟********
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"e44dc3dd-eaa4-4aee-9261-4caf470353e8","RemoteStopTransaction",{"transactionId":1}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312375200000008","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T12:37:52.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"212.600000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.370000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.950000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312375200000008",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312380200000009","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T12:38:22.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"212.680000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.370000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.950000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312380200000009",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"e44dc3dd-eaa4-4aee-9261-4caf470353e8",{"status":"Accepted"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231238410000000F","StopTransaction",{"idTag":"AE0022A1GM9C00066K","transactionId":1,"meterStop":528242,"timestamp":"2022-01-23T12:38:40.000Z","reason":"Remote"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231238410000000F",{"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231238120000000A","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T12:38:52.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231238120000000A",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231238230000000B","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T12:38:52.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231238230000000B",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231238330000000C","StatusNotification",{"connectorId":1,"status":"Preparing","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231238330000000C",{}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"5af89ec0-3944-47dc-b59f-b05c53ca1830","Reset",{"type":"Soft"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231238330000000D","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T12:38:54.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231238330000000D",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"5af89ec0-3944-47dc-b59f-b05c53ca1830",{"status":"Accepted"}]
[ERROR server.py:233] connection handler failed
Traceback (most recent call last):
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 944, in transfer_data
    message = await self.read_message()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1013, in read_message
    frame = await self.read_data_frame(max_size=self.max_size)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1089, in read_data_frame
    frame = await self.read_frame(max_size)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1148, in read_frame
    extensions=self.extensions,
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\framing.py", line 70, in read
    data = await reader(2)
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\streams.py", line 679, in readexactly
    await self._wait_for_data('readexactly')
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\streams.py", line 473, in _wait_for_data
    await self._waiter
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\selector_events.py", line 812, in _read_ready__data_received
    data = self._sock.recv(self.max_size)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\server.py", line 231, in handler
    await self.ws_handler(self)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\server.py", line 1137, in _ws_handler
    )(websocket, websocket.path)
  File "D:\workspace\ocpp_test\server\connect.py", line 156, in on_connect
    await Value.chargePoint.start()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\ocpp\charge_point.py", line 125, in start
    message = await self._connection.recv()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 552, in recv
    await self.ensure_open()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 920, in ensure_open
    raise self.connection_closed_exc()
websockets.exceptions.ConnectionClosedError: no close frame received or sent
[INFO server.py:259] connection closed
[INFO server.py:641] connection open
[INFO connect.py:146] Protocols Matched: ocpp1.6
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312391000000001","BootNotification",{"chargePointModel":"MaxiChargerAC","chargePointVendor":"Autel","firmwareVersion":"CAQoSPAGNL"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312391000000001",{"currentTime":"2022-01-23T12:39:11.123Z","interval":10,"status":"Accepted"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312391100000002","StatusNotification",{"connectorId":0,"status":"Available","errorCode":"NoError"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312391100000002",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312391100000003","StatusNotification",{"connectorId":1,"status":"Preparing","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312391100000003",{}]
[INFO test_Recurrent_cpVoltN.py:69] 稍等5秒，等桩连上后台
[INFO test_Recurrent_cpVoltN.py:31] ========这是第65次开始执行========
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"a21dff6a-2b7d-42c7-ae6f-d02dcd28aeee","RemoteStartTransaction",{"idTag":"AE0022A1GM9C00066K","connectorId":1,"chargingProfile":{"chargingProfileId":1,"transactionId":1,"stackLevel":1,"chargingProfilePurpose":"ChargePointMaxProfile","chargingProfileKind":"Absolute","recurrencyKind":"Daily","validFrom":"date-time","validTo":"date-time","chargingSchedule":{"duration":10,"startSchedule":"date-time","chargingRateUnit":"W","chargingSchedulePeriod":[{"startPeriod":1,"limit":1.5,"numberPhases":1}],"minChargingRate":1.5}}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"a21dff6a-2b7d-42c7-ae6f-d02dcd28aeee",{"status":"Accepted"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312391800000004","Authorize",{"idTag":"AE0022A1GM9C00066K"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312391800000004",{"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312392100000005","StatusNotification",{"connectorId":1,"status":"Charging","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312392100000005",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312392200000006","StartTransaction",{"connectorId":1,"idTag":"AE0022A1GM9C00066K","meterStart":528242,"timestamp":"2022-01-23T12:39:21.000Z"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312392200000006",{"transactionId":1,"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312392300000007","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T12:39:23.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"212.520000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.370000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.950000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312392300000007",{}]
[INFO test_Recurrent_cpVoltN.py:52] ********正在充电********稍等约1分钟********
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"6abba2a7-3adf-4329-aea0-08ef19be93ef","RemoteStopTransaction",{"transactionId":1}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312393300000008","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T12:39:34.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"212.390000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.360000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.950000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312393300000008",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312394400000009","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T12:40:04.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"212.900000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.380000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.950000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312394400000009",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"6abba2a7-3adf-4329-aea0-08ef19be93ef",{"status":"Accepted"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231240220000000E","StopTransaction",{"idTag":"AE0022A1GM9C00066K","transactionId":1,"meterStop":528242,"timestamp":"2022-01-23T12:40:21.000Z","reason":"Remote"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231240220000000E",{"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231239540000000A","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T12:40:34.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231239540000000A",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231240050000000B","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T12:40:34.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231240050000000B",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231240140000000C","StatusNotification",{"connectorId":1,"status":"Preparing","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231240140000000C",{}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"2d4f8e3e-54b0-42d7-825c-bbf8ffe3dd64","Reset",{"type":"Soft"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"2d4f8e3e-54b0-42d7-825c-bbf8ffe3dd64",{"status":"Accepted"}]
[ERROR server.py:233] connection handler failed
Traceback (most recent call last):
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 944, in transfer_data
    message = await self.read_message()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1013, in read_message
    frame = await self.read_data_frame(max_size=self.max_size)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1089, in read_data_frame
    frame = await self.read_frame(max_size)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1148, in read_frame
    extensions=self.extensions,
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\framing.py", line 70, in read
    data = await reader(2)
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\streams.py", line 679, in readexactly
    await self._wait_for_data('readexactly')
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\streams.py", line 473, in _wait_for_data
    await self._waiter
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\selector_events.py", line 812, in _read_ready__data_received
    data = self._sock.recv(self.max_size)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\server.py", line 231, in handler
    await self.ws_handler(self)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\server.py", line 1137, in _ws_handler
    )(websocket, websocket.path)
  File "D:\workspace\ocpp_test\server\connect.py", line 156, in on_connect
    await Value.chargePoint.start()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\ocpp\charge_point.py", line 125, in start
    message = await self._connection.recv()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 552, in recv
    await self.ensure_open()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 920, in ensure_open
    raise self.connection_closed_exc()
websockets.exceptions.ConnectionClosedError: no close frame received or sent
[INFO server.py:259] connection closed
[INFO server.py:641] connection open
[INFO connect.py:146] Protocols Matched: ocpp1.6
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312405900000001","BootNotification",{"chargePointModel":"MaxiChargerAC","chargePointVendor":"Autel","firmwareVersion":"CAQoSPAGNL"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312405900000001",{"currentTime":"2022-01-23T12:41:00.123Z","interval":10,"status":"Accepted"}]
[INFO test_Recurrent_cpVoltN.py:69] 稍等5秒，等桩连上后台
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312410000000002","StatusNotification",{"connectorId":0,"status":"Available","errorCode":"NoError"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312410000000002",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312410000000003","StatusNotification",{"connectorId":1,"status":"Preparing","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312410000000003",{}]
[INFO test_Recurrent_cpVoltN.py:31] ========这是第66次开始执行========
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"1c7d7c2b-ca6d-4877-a314-fb15475b150e","RemoteStartTransaction",{"idTag":"AE0022A1GM9C00066K","connectorId":1,"chargingProfile":{"chargingProfileId":1,"transactionId":1,"stackLevel":1,"chargingProfilePurpose":"ChargePointMaxProfile","chargingProfileKind":"Absolute","recurrencyKind":"Daily","validFrom":"date-time","validTo":"date-time","chargingSchedule":{"duration":10,"startSchedule":"date-time","chargingRateUnit":"W","chargingSchedulePeriod":[{"startPeriod":1,"limit":1.5,"numberPhases":1}],"minChargingRate":1.5}}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"1c7d7c2b-ca6d-4877-a314-fb15475b150e",{"status":"Accepted"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312410800000004","Authorize",{"idTag":"AE0022A1GM9C00066K"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312410800000004",{"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312411100000006","StartTransaction",{"connectorId":1,"idTag":"AE0022A1GM9C00066K","meterStart":528242,"timestamp":"2022-01-23T12:41:11.000Z"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312411100000006",{"transactionId":1,"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312411100000005","StatusNotification",{"connectorId":1,"status":"Charging","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312411100000005",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312411300000007","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T12:41:13.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"212.810000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.370000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.950000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312411300000007",{}]
[INFO test_Recurrent_cpVoltN.py:52] ********正在充电********稍等约1分钟********
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"e4a729e7-d321-4454-87d5-d8527bfb3484","RemoteStopTransaction",{"transactionId":1}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312412300000008","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T12:41:23.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"213.020000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.380000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.950000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312412300000008",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312413300000009","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T12:41:53.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"212.810000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.380000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.960000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312413300000009",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"e4a729e7-d321-4454-87d5-d8527bfb3484",{"status":"Accepted"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231242130000000F","StopTransaction",{"idTag":"AE0022A1GM9C00066K","transactionId":1,"meterStop":528242,"timestamp":"2022-01-23T12:42:12.000Z","reason":"Remote"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231242130000000F",{"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231241440000000A","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T12:42:23.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231241440000000A",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231241540000000B","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T12:42:24.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231241540000000B",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231242040000000C","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T12:42:24.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231242040000000C",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231242050000000D","StatusNotification",{"connectorId":1,"status":"Preparing","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231242050000000D",{}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"a58d2423-8fb5-441a-aa1b-9079c09b2278","Reset",{"type":"Soft"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"a58d2423-8fb5-441a-aa1b-9079c09b2278",{"status":"Accepted"}]
[ERROR server.py:233] connection handler failed
Traceback (most recent call last):
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 944, in transfer_data
    message = await self.read_message()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1013, in read_message
    frame = await self.read_data_frame(max_size=self.max_size)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1089, in read_data_frame
    frame = await self.read_frame(max_size)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1148, in read_frame
    extensions=self.extensions,
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\framing.py", line 70, in read
    data = await reader(2)
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\streams.py", line 679, in readexactly
    await self._wait_for_data('readexactly')
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\streams.py", line 473, in _wait_for_data
    await self._waiter
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\selector_events.py", line 812, in _read_ready__data_received
    data = self._sock.recv(self.max_size)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\server.py", line 231, in handler
    await self.ws_handler(self)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\server.py", line 1137, in _ws_handler
    )(websocket, websocket.path)
  File "D:\workspace\ocpp_test\server\connect.py", line 156, in on_connect
    await Value.chargePoint.start()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\ocpp\charge_point.py", line 125, in start
    message = await self._connection.recv()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 552, in recv
    await self.ensure_open()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 920, in ensure_open
    raise self.connection_closed_exc()
websockets.exceptions.ConnectionClosedError: no close frame received or sent
[INFO server.py:259] connection closed
[INFO server.py:641] connection open
[INFO connect.py:146] Protocols Matched: ocpp1.6
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312424900000001","BootNotification",{"chargePointModel":"MaxiChargerAC","chargePointVendor":"Autel","firmwareVersion":"CAQoSPAGNL"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312424900000001",{"currentTime":"2022-01-23T12:42:50.123Z","interval":10,"status":"Accepted"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312425000000002","StatusNotification",{"connectorId":0,"status":"Available","errorCode":"NoError"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312425000000002",{}]
[INFO test_Recurrent_cpVoltN.py:69] 稍等5秒，等桩连上后台
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312425000000003","StatusNotification",{"connectorId":1,"status":"Preparing","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312425000000003",{}]
[INFO test_Recurrent_cpVoltN.py:31] ========这是第67次开始执行========
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"b44e35d3-cbcd-425e-a6a2-95ac39be8455","RemoteStartTransaction",{"idTag":"AE0022A1GM9C00066K","connectorId":1,"chargingProfile":{"chargingProfileId":1,"transactionId":1,"stackLevel":1,"chargingProfilePurpose":"ChargePointMaxProfile","chargingProfileKind":"Absolute","recurrencyKind":"Daily","validFrom":"date-time","validTo":"date-time","chargingSchedule":{"duration":10,"startSchedule":"date-time","chargingRateUnit":"W","chargingSchedulePeriod":[{"startPeriod":1,"limit":1.5,"numberPhases":1}],"minChargingRate":1.5}}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"b44e35d3-cbcd-425e-a6a2-95ac39be8455",{"status":"Accepted"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312425900000004","Authorize",{"idTag":"AE0022A1GM9C00066K"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312425900000004",{"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312430100000005","StatusNotification",{"connectorId":1,"status":"Charging","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312430100000005",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312430200000006","StartTransaction",{"connectorId":1,"idTag":"AE0022A1GM9C00066K","meterStart":528242,"timestamp":"2022-01-23T12:43:01.000Z"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312430200000006",{"transactionId":1,"idTagInfo":{"status":"Accepted"}}]
[INFO test_Recurrent_cpVoltN.py:52] ********正在充电********稍等约1分钟********
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"eecefc91-24d2-4b2f-ae78-8a2ba26bb631","RemoteStopTransaction",{"transactionId":1}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312430300000007","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T12:43:03.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"212.910000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.390000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.950000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312430300000007",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312431300000008","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T12:43:33.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"212.790000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.380000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.960000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312431300000008",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"eecefc91-24d2-4b2f-ae78-8a2ba26bb631",{"status":"Accepted"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231244000000000E","StopTransaction",{"idTag":"AE0022A1GM9C00066K","transactionId":1,"meterStop":528242,"timestamp":"2022-01-23T12:43:59.000Z","reason":"Remote"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231244000000000E",{"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312432300000009","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T12:44:03.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312432300000009",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231243340000000A","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T12:44:04.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231243340000000A",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231243440000000B","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T12:44:04.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231243440000000B",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231243520000000C","StatusNotification",{"connectorId":1,"status":"Preparing","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231243520000000C",{}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"7305b690-b74c-4371-aee9-675a99b08c4a","Reset",{"type":"Soft"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"7305b690-b74c-4371-aee9-675a99b08c4a",{"status":"Accepted"}]
[ERROR server.py:233] connection handler failed
Traceback (most recent call last):
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 944, in transfer_data
    message = await self.read_message()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1013, in read_message
    frame = await self.read_data_frame(max_size=self.max_size)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1089, in read_data_frame
    frame = await self.read_frame(max_size)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1148, in read_frame
    extensions=self.extensions,
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\framing.py", line 70, in read
    data = await reader(2)
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\streams.py", line 679, in readexactly
    await self._wait_for_data('readexactly')
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\streams.py", line 473, in _wait_for_data
    await self._waiter
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\selector_events.py", line 812, in _read_ready__data_received
    data = self._sock.recv(self.max_size)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\server.py", line 231, in handler
    await self.ws_handler(self)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\server.py", line 1137, in _ws_handler
    )(websocket, websocket.path)
  File "D:\workspace\ocpp_test\server\connect.py", line 156, in on_connect
    await Value.chargePoint.start()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\ocpp\charge_point.py", line 125, in start
    message = await self._connection.recv()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 552, in recv
    await self.ensure_open()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 920, in ensure_open
    raise self.connection_closed_exc()
websockets.exceptions.ConnectionClosedError: no close frame received or sent
[INFO server.py:259] connection closed
[INFO server.py:641] connection open
[INFO connect.py:146] Protocols Matched: ocpp1.6
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312443000000001","BootNotification",{"chargePointModel":"MaxiChargerAC","chargePointVendor":"Autel","firmwareVersion":"CAQoSPAGNL"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312443000000001",{"currentTime":"2022-01-23T12:44:31.123Z","interval":10,"status":"Accepted"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312443100000002","StatusNotification",{"connectorId":0,"status":"Available","errorCode":"NoError"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312443100000002",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312443100000003","StatusNotification",{"connectorId":1,"status":"Preparing","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312443100000003",{}]
[INFO test_Recurrent_cpVoltN.py:69] 稍等5秒，等桩连上后台
[INFO test_Recurrent_cpVoltN.py:31] ========这是第68次开始执行========
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"3c89599a-f57a-428e-82b9-269eb3f39fda","RemoteStartTransaction",{"idTag":"AE0022A1GM9C00066K","connectorId":1,"chargingProfile":{"chargingProfileId":1,"transactionId":1,"stackLevel":1,"chargingProfilePurpose":"ChargePointMaxProfile","chargingProfileKind":"Absolute","recurrencyKind":"Daily","validFrom":"date-time","validTo":"date-time","chargingSchedule":{"duration":10,"startSchedule":"date-time","chargingRateUnit":"W","chargingSchedulePeriod":[{"startPeriod":1,"limit":1.5,"numberPhases":1}],"minChargingRate":1.5}}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"3c89599a-f57a-428e-82b9-269eb3f39fda",{"status":"Accepted"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312443700000004","Authorize",{"idTag":"AE0022A1GM9C00066K"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312443700000004",{"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312444000000005","StatusNotification",{"connectorId":1,"status":"Charging","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312444000000005",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312444100000006","StartTransaction",{"connectorId":1,"idTag":"AE0022A1GM9C00066K","meterStart":528242,"timestamp":"2022-01-23T12:44:40.000Z"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312444100000006",{"transactionId":1,"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312444200000007","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T12:44:42.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"213.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.390000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.950000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312444200000007",{}]
[INFO test_Recurrent_cpVoltN.py:52] ********正在充电********稍等约1分钟********
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"8f98e4d7-c5c9-492a-b4a4-0563eb79e14c","RemoteStopTransaction",{"transactionId":1}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312445200000008","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T12:44:52.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"213.040000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.390000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.960000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312445200000008",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312450300000009","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T12:45:23.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"212.940000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.380000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.950000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312450300000009",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"8f98e4d7-c5c9-492a-b4a4-0563eb79e14c",{"status":"Accepted"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231245410000000F","StopTransaction",{"idTag":"AE0022A1GM9C00066K","transactionId":1,"meterStop":528242,"timestamp":"2022-01-23T12:45:40.000Z","reason":"Remote"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231245410000000F",{"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231245130000000A","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T12:45:53.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231245130000000A",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231245230000000B","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T12:45:53.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231245230000000B",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231245330000000C","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T12:45:54.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231245330000000C",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231245340000000D","StatusNotification",{"connectorId":1,"status":"Preparing","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231245340000000D",{}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"49b5fed4-1ef9-4859-8db5-3dcbbfc98141","Reset",{"type":"Soft"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"49b5fed4-1ef9-4859-8db5-3dcbbfc98141",{"status":"Accepted"}]
[ERROR server.py:233] connection handler failed
Traceback (most recent call last):
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 944, in transfer_data
    message = await self.read_message()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1013, in read_message
    frame = await self.read_data_frame(max_size=self.max_size)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1089, in read_data_frame
    frame = await self.read_frame(max_size)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1148, in read_frame
    extensions=self.extensions,
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\framing.py", line 70, in read
    data = await reader(2)
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\streams.py", line 679, in readexactly
    await self._wait_for_data('readexactly')
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\streams.py", line 473, in _wait_for_data
    await self._waiter
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\selector_events.py", line 812, in _read_ready__data_received
    data = self._sock.recv(self.max_size)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\server.py", line 231, in handler
    await self.ws_handler(self)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\server.py", line 1137, in _ws_handler
    )(websocket, websocket.path)
  File "D:\workspace\ocpp_test\server\connect.py", line 156, in on_connect
    await Value.chargePoint.start()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\ocpp\charge_point.py", line 125, in start
    message = await self._connection.recv()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 552, in recv
    await self.ensure_open()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 920, in ensure_open
    raise self.connection_closed_exc()
websockets.exceptions.ConnectionClosedError: no close frame received or sent
[INFO server.py:259] connection closed
[INFO server.py:641] connection open
[INFO connect.py:146] Protocols Matched: ocpp1.6
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312461900000001","BootNotification",{"chargePointModel":"MaxiChargerAC","chargePointVendor":"Autel","firmwareVersion":"CAQoSPAGNL"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312461900000001",{"currentTime":"2022-01-23T12:46:19.123Z","interval":10,"status":"Accepted"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312461900000002","StatusNotification",{"connectorId":0,"status":"Available","errorCode":"NoError"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312461900000002",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312461900000003","StatusNotification",{"connectorId":1,"status":"Preparing","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312461900000003",{}]
[INFO test_Recurrent_cpVoltN.py:69] 稍等5秒，等桩连上后台
[INFO test_Recurrent_cpVoltN.py:31] ========这是第69次开始执行========
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"9e9114b6-22a6-4a20-a679-f77b85ba3694","RemoteStartTransaction",{"idTag":"AE0022A1GM9C00066K","connectorId":1,"chargingProfile":{"chargingProfileId":1,"transactionId":1,"stackLevel":1,"chargingProfilePurpose":"ChargePointMaxProfile","chargingProfileKind":"Absolute","recurrencyKind":"Daily","validFrom":"date-time","validTo":"date-time","chargingSchedule":{"duration":10,"startSchedule":"date-time","chargingRateUnit":"W","chargingSchedulePeriod":[{"startPeriod":1,"limit":1.5,"numberPhases":1}],"minChargingRate":1.5}}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"9e9114b6-22a6-4a20-a679-f77b85ba3694",{"status":"Accepted"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312462700000004","Authorize",{"idTag":"AE0022A1GM9C00066K"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312462700000004",{"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312463000000005","StatusNotification",{"connectorId":1,"status":"Charging","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312463000000005",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312463000000006","StartTransaction",{"connectorId":1,"idTag":"AE0022A1GM9C00066K","meterStart":528242,"timestamp":"2022-01-23T12:46:29.000Z"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312463000000006",{"transactionId":1,"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312463200000007","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T12:46:32.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"212.900000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.390000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.950000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312463200000007",{}]
[INFO test_Recurrent_cpVoltN.py:52] ********正在充电********稍等约1分钟********
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"f773a9bf-9cf6-4cf4-9195-ba4fb20ccd0f","RemoteStopTransaction",{"transactionId":1}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312464200000008","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T12:46:42.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"213.020000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.390000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.960000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312464200000008",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312465200000009","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T12:47:12.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"212.780000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.380000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.950000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312465200000009",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"f773a9bf-9cf6-4cf4-9195-ba4fb20ccd0f",{"status":"Accepted"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231247310000000F","StopTransaction",{"idTag":"AE0022A1GM9C00066K","transactionId":1,"meterStop":528242,"timestamp":"2022-01-23T12:47:30.000Z","reason":"Remote"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231247310000000F",{"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231247020000000A","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T12:47:43.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231247020000000A",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231247120000000B","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T12:47:43.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231247120000000B",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231247230000000C","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T12:47:44.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231247230000000C",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231247230000000D","StatusNotification",{"connectorId":1,"status":"Preparing","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231247230000000D",{}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"f13c0c7c-41f2-4290-8f91-c0b553d8d383","Reset",{"type":"Soft"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"f13c0c7c-41f2-4290-8f91-c0b553d8d383",{"status":"Accepted"}]
[ERROR server.py:233] connection handler failed
Traceback (most recent call last):
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 944, in transfer_data
    message = await self.read_message()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1013, in read_message
    frame = await self.read_data_frame(max_size=self.max_size)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1089, in read_data_frame
    frame = await self.read_frame(max_size)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1148, in read_frame
    extensions=self.extensions,
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\framing.py", line 70, in read
    data = await reader(2)
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\streams.py", line 679, in readexactly
    await self._wait_for_data('readexactly')
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\streams.py", line 473, in _wait_for_data
    await self._waiter
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\selector_events.py", line 812, in _read_ready__data_received
    data = self._sock.recv(self.max_size)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\server.py", line 231, in handler
    await self.ws_handler(self)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\server.py", line 1137, in _ws_handler
    )(websocket, websocket.path)
  File "D:\workspace\ocpp_test\server\connect.py", line 156, in on_connect
    await Value.chargePoint.start()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\ocpp\charge_point.py", line 125, in start
    message = await self._connection.recv()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 552, in recv
    await self.ensure_open()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 920, in ensure_open
    raise self.connection_closed_exc()
websockets.exceptions.ConnectionClosedError: no close frame received or sent
[INFO server.py:259] connection closed
[INFO server.py:641] connection open
[INFO connect.py:146] Protocols Matched: ocpp1.6
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312480000000001","BootNotification",{"chargePointModel":"MaxiChargerAC","chargePointVendor":"Autel","firmwareVersion":"CAQoSPAGNL"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312480000000001",{"currentTime":"2022-01-23T12:48:02.123Z","interval":10,"status":"Accepted"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312480200000002","StatusNotification",{"connectorId":0,"status":"Available","errorCode":"NoError"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312480200000002",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312480200000003","StatusNotification",{"connectorId":1,"status":"Preparing","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312480200000003",{}]
[INFO test_Recurrent_cpVoltN.py:69] 稍等5秒，等桩连上后台
[INFO test_Recurrent_cpVoltN.py:31] ========这是第70次开始执行========
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"5d8068f0-5017-46f1-9de2-1e9d8876df4f","RemoteStartTransaction",{"idTag":"AE0022A1GM9C00066K","connectorId":1,"chargingProfile":{"chargingProfileId":1,"transactionId":1,"stackLevel":1,"chargingProfilePurpose":"ChargePointMaxProfile","chargingProfileKind":"Absolute","recurrencyKind":"Daily","validFrom":"date-time","validTo":"date-time","chargingSchedule":{"duration":10,"startSchedule":"date-time","chargingRateUnit":"W","chargingSchedulePeriod":[{"startPeriod":1,"limit":1.5,"numberPhases":1}],"minChargingRate":1.5}}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"5d8068f0-5017-46f1-9de2-1e9d8876df4f",{"status":"Accepted"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312480900000004","Authorize",{"idTag":"AE0022A1GM9C00066K"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312480900000004",{"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312481200000005","StatusNotification",{"connectorId":1,"status":"Charging","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312481200000005",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312481300000006","StartTransaction",{"connectorId":1,"idTag":"AE0022A1GM9C00066K","meterStart":528242,"timestamp":"2022-01-23T12:48:12.000Z"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312481300000006",{"transactionId":1,"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312481400000007","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T12:48:14.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"212.860000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.380000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.950000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312481400000007",{}]
[INFO test_Recurrent_cpVoltN.py:52] ********正在充电********稍等约1分钟********
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"a7562af4-da2f-41be-83c4-02de7f1e268f","RemoteStopTransaction",{"transactionId":1}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312482500000008","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T12:48:25.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"212.580000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.370000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.950000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312482500000008",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312483500000009","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T12:48:55.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"212.620000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.370000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.950000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312483500000009",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"a7562af4-da2f-41be-83c4-02de7f1e268f",{"status":"Accepted"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231249130000000E","StopTransaction",{"idTag":"AE0022A1GM9C00066K","transactionId":1,"meterStop":528242,"timestamp":"2022-01-23T12:49:12.000Z","reason":"Remote"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231249130000000E",{"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231248450000000A","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T12:49:25.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231248450000000A",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231248550000000B","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T12:49:26.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.010000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231248550000000B",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231249050000000C","StatusNotification",{"connectorId":1,"status":"Preparing","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231249050000000C",{}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"748c32f1-c12b-4cb8-b819-ef5316e36e7c","Reset",{"type":"Soft"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"748c32f1-c12b-4cb8-b819-ef5316e36e7c",{"status":"Accepted"}]
[ERROR server.py:233] connection handler failed
Traceback (most recent call last):
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 944, in transfer_data
    message = await self.read_message()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1013, in read_message
    frame = await self.read_data_frame(max_size=self.max_size)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1089, in read_data_frame
    frame = await self.read_frame(max_size)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1148, in read_frame
    extensions=self.extensions,
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\framing.py", line 70, in read
    data = await reader(2)
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\streams.py", line 679, in readexactly
    await self._wait_for_data('readexactly')
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\streams.py", line 473, in _wait_for_data
    await self._waiter
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\selector_events.py", line 812, in _read_ready__data_received
    data = self._sock.recv(self.max_size)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\server.py", line 231, in handler
    await self.ws_handler(self)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\server.py", line 1137, in _ws_handler
    )(websocket, websocket.path)
  File "D:\workspace\ocpp_test\server\connect.py", line 156, in on_connect
    await Value.chargePoint.start()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\ocpp\charge_point.py", line 125, in start
    message = await self._connection.recv()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 552, in recv
    await self.ensure_open()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 920, in ensure_open
    raise self.connection_closed_exc()
websockets.exceptions.ConnectionClosedError: no close frame received or sent
[INFO server.py:259] connection closed
[INFO server.py:641] connection open
[INFO connect.py:146] Protocols Matched: ocpp1.6
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312495300000001","BootNotification",{"chargePointModel":"MaxiChargerAC","chargePointVendor":"Autel","firmwareVersion":"CAQoSPAGNL"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312495300000001",{"currentTime":"2022-01-23T12:49:53.123Z","interval":10,"status":"Accepted"}]
[INFO test_Recurrent_cpVoltN.py:69] 稍等5秒，等桩连上后台
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312495300000002","StatusNotification",{"connectorId":0,"status":"Available","errorCode":"NoError"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312495300000002",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312495300000003","StatusNotification",{"connectorId":1,"status":"Preparing","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312495300000003",{}]
[INFO test_Recurrent_cpVoltN.py:31] ========这是第71次开始执行========
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"8ddd922a-1ccc-4ae5-b090-ea8cead01b58","RemoteStartTransaction",{"idTag":"AE0022A1GM9C00066K","connectorId":1,"chargingProfile":{"chargingProfileId":1,"transactionId":1,"stackLevel":1,"chargingProfilePurpose":"ChargePointMaxProfile","chargingProfileKind":"Absolute","recurrencyKind":"Daily","validFrom":"date-time","validTo":"date-time","chargingSchedule":{"duration":10,"startSchedule":"date-time","chargingRateUnit":"W","chargingSchedulePeriod":[{"startPeriod":1,"limit":1.5,"numberPhases":1}],"minChargingRate":1.5}}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"8ddd922a-1ccc-4ae5-b090-ea8cead01b58",{"status":"Accepted"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312500200000004","Authorize",{"idTag":"AE0022A1GM9C00066K"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312500200000004",{"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312500400000005","StatusNotification",{"connectorId":1,"status":"Charging","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312500400000005",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312500500000006","StartTransaction",{"connectorId":1,"idTag":"AE0022A1GM9C00066K","meterStart":528242,"timestamp":"2022-01-23T12:50:04.000Z"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312500500000006",{"transactionId":1,"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312500600000007","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T12:50:06.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"213.210000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.390000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.960000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312500600000007",{}]
[INFO test_Recurrent_cpVoltN.py:52] ********正在充电********稍等约1分钟********
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"d6aec24c-30c3-41c4-8357-c3511f887ae0","RemoteStopTransaction",{"transactionId":1}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312501700000008","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T12:50:17.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"213.110000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.390000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.960000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.010000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312501700000008",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312502700000009","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T12:50:47.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"213.120000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.400000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.960000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312502700000009",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"d6aec24c-30c3-41c4-8357-c3511f887ae0",{"status":"Accepted"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231251060000000F","StopTransaction",{"idTag":"AE0022A1GM9C00066K","transactionId":1,"meterStop":528242,"timestamp":"2022-01-23T12:51:05.000Z","reason":"Remote"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231251060000000F",{"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231250370000000A","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T12:51:17.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231250370000000A",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231250470000000B","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T12:51:18.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231250470000000B",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231250580000000C","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T12:51:18.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231250580000000C",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231250580000000D","StatusNotification",{"connectorId":1,"status":"Preparing","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231250580000000D",{}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"d75658c5-db88-415a-a91e-b589881e87b3","Reset",{"type":"Soft"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"d75658c5-db88-415a-a91e-b589881e87b3",{"status":"Accepted"}]
[ERROR server.py:233] connection handler failed
Traceback (most recent call last):
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 944, in transfer_data
    message = await self.read_message()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1013, in read_message
    frame = await self.read_data_frame(max_size=self.max_size)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1089, in read_data_frame
    frame = await self.read_frame(max_size)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1148, in read_frame
    extensions=self.extensions,
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\framing.py", line 70, in read
    data = await reader(2)
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\streams.py", line 679, in readexactly
    await self._wait_for_data('readexactly')
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\streams.py", line 473, in _wait_for_data
    await self._waiter
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\selector_events.py", line 812, in _read_ready__data_received
    data = self._sock.recv(self.max_size)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\server.py", line 231, in handler
    await self.ws_handler(self)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\server.py", line 1137, in _ws_handler
    )(websocket, websocket.path)
  File "D:\workspace\ocpp_test\server\connect.py", line 156, in on_connect
    await Value.chargePoint.start()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\ocpp\charge_point.py", line 125, in start
    message = await self._connection.recv()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 552, in recv
    await self.ensure_open()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 920, in ensure_open
    raise self.connection_closed_exc()
websockets.exceptions.ConnectionClosedError: no close frame received or sent
[INFO server.py:259] connection closed
[INFO server.py:641] connection open
[INFO connect.py:146] Protocols Matched: ocpp1.6
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312513400000001","BootNotification",{"chargePointModel":"MaxiChargerAC","chargePointVendor":"Autel","firmwareVersion":"CAQoSPAGNL"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312513400000001",{"currentTime":"2022-01-23T12:51:36.123Z","interval":10,"status":"Accepted"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312513600000002","StatusNotification",{"connectorId":0,"status":"Available","errorCode":"NoError"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312513600000002",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312513600000003","StatusNotification",{"connectorId":1,"status":"Preparing","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312513600000003",{}]
[INFO test_Recurrent_cpVoltN.py:69] 稍等5秒，等桩连上后台
[INFO test_Recurrent_cpVoltN.py:31] ========这是第72次开始执行========
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"ea922cea-003b-4d1e-b1c7-9290e6f2cad2","RemoteStartTransaction",{"idTag":"AE0022A1GM9C00066K","connectorId":1,"chargingProfile":{"chargingProfileId":1,"transactionId":1,"stackLevel":1,"chargingProfilePurpose":"ChargePointMaxProfile","chargingProfileKind":"Absolute","recurrencyKind":"Daily","validFrom":"date-time","validTo":"date-time","chargingSchedule":{"duration":10,"startSchedule":"date-time","chargingRateUnit":"W","chargingSchedulePeriod":[{"startPeriod":1,"limit":1.5,"numberPhases":1}],"minChargingRate":1.5}}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"ea922cea-003b-4d1e-b1c7-9290e6f2cad2",{"status":"Accepted"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312514400000004","Authorize",{"idTag":"AE0022A1GM9C00066K"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312514400000004",{"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312514700000005","StatusNotification",{"connectorId":1,"status":"Charging","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312514700000005",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312514700000006","StartTransaction",{"connectorId":1,"idTag":"AE0022A1GM9C00066K","meterStart":528242,"timestamp":"2022-01-23T12:51:46.000Z"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312514700000006",{"transactionId":1,"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312514900000007","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T12:51:49.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"213.180000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.390000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.960000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312514900000007",{}]
[INFO test_Recurrent_cpVoltN.py:52] ********正在充电********稍等约1分钟********
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"916442dc-2659-435b-abf3-240e46aee4a7","RemoteStopTransaction",{"transactionId":1}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312515900000008","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T12:51:59.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"212.800000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.380000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.960000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312515900000008",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312520900000009","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T12:52:30.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"212.860000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.380000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.960000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312520900000009",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"916442dc-2659-435b-abf3-240e46aee4a7",{"status":"Accepted"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231252470000000F","StopTransaction",{"idTag":"AE0022A1GM9C00066K","transactionId":1,"meterStop":528242,"timestamp":"2022-01-23T12:52:47.000Z","reason":"Remote"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231252470000000F",{"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231252190000000A","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T12:53:00.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231252190000000A",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231252290000000B","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T12:53:00.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231252290000000B",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231252400000000C","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T12:53:01.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231252400000000C",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231252400000000D","StatusNotification",{"connectorId":1,"status":"Preparing","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231252400000000D",{}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"1124afdd-1c00-4678-b121-f63be4a2f95c","Reset",{"type":"Soft"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"1124afdd-1c00-4678-b121-f63be4a2f95c",{"status":"Accepted"}]
[ERROR server.py:233] connection handler failed
Traceback (most recent call last):
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 944, in transfer_data
    message = await self.read_message()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1013, in read_message
    frame = await self.read_data_frame(max_size=self.max_size)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1089, in read_data_frame
    frame = await self.read_frame(max_size)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1148, in read_frame
    extensions=self.extensions,
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\framing.py", line 70, in read
    data = await reader(2)
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\streams.py", line 679, in readexactly
    await self._wait_for_data('readexactly')
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\streams.py", line 473, in _wait_for_data
    await self._waiter
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\selector_events.py", line 812, in _read_ready__data_received
    data = self._sock.recv(self.max_size)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\server.py", line 231, in handler
    await self.ws_handler(self)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\server.py", line 1137, in _ws_handler
    )(websocket, websocket.path)
  File "D:\workspace\ocpp_test\server\connect.py", line 156, in on_connect
    await Value.chargePoint.start()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\ocpp\charge_point.py", line 125, in start
    message = await self._connection.recv()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 552, in recv
    await self.ensure_open()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 920, in ensure_open
    raise self.connection_closed_exc()
websockets.exceptions.ConnectionClosedError: no close frame received or sent
[INFO server.py:259] connection closed
[INFO server.py:641] connection open
[INFO connect.py:146] Protocols Matched: ocpp1.6
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312532500000001","BootNotification",{"chargePointModel":"MaxiChargerAC","chargePointVendor":"Autel","firmwareVersion":"CAQoSPAGNL"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312532500000001",{"currentTime":"2022-01-23T12:53:25.123Z","interval":10,"status":"Accepted"}]
[INFO test_Recurrent_cpVoltN.py:69] 稍等5秒，等桩连上后台
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312532500000002","StatusNotification",{"connectorId":0,"status":"Available","errorCode":"NoError"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312532500000002",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312532500000003","StatusNotification",{"connectorId":1,"status":"Preparing","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312532500000003",{}]
[INFO test_Recurrent_cpVoltN.py:31] ========这是第73次开始执行========
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"b15d035d-a6da-43c4-9116-ea559713a677","RemoteStartTransaction",{"idTag":"AE0022A1GM9C00066K","connectorId":1,"chargingProfile":{"chargingProfileId":1,"transactionId":1,"stackLevel":1,"chargingProfilePurpose":"ChargePointMaxProfile","chargingProfileKind":"Absolute","recurrencyKind":"Daily","validFrom":"date-time","validTo":"date-time","chargingSchedule":{"duration":10,"startSchedule":"date-time","chargingRateUnit":"W","chargingSchedulePeriod":[{"startPeriod":1,"limit":1.5,"numberPhases":1}],"minChargingRate":1.5}}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"b15d035d-a6da-43c4-9116-ea559713a677",{"status":"Accepted"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312533400000004","Authorize",{"idTag":"AE0022A1GM9C00066K"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312533400000004",{"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312533600000005","StatusNotification",{"connectorId":1,"status":"Charging","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312533600000005",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312533700000006","StartTransaction",{"connectorId":1,"idTag":"AE0022A1GM9C00066K","meterStart":528242,"timestamp":"2022-01-23T12:53:36.000Z"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312533700000006",{"transactionId":1,"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312533800000007","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T12:53:38.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"212.990000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.390000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.950000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312533800000007",{}]
[INFO test_Recurrent_cpVoltN.py:52] ********正在充电********稍等约1分钟********
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"3695fb57-0136-4a47-8004-1afd5474ea6d","RemoteStopTransaction",{"transactionId":1}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312534800000008","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T12:53:48.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"213.120000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.390000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.960000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312534800000008",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312535900000009","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T12:54:19.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"213.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.380000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.950000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312535900000009",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"3695fb57-0136-4a47-8004-1afd5474ea6d",{"status":"Accepted"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231254380000000F","StopTransaction",{"idTag":"AE0022A1GM9C00066K","transactionId":1,"meterStop":528242,"timestamp":"2022-01-23T12:54:37.000Z","reason":"Remote"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231254380000000F",{"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231254090000000A","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T12:54:49.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231254090000000A",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231254190000000B","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T12:54:49.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231254190000000B",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231254290000000C","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T12:54:50.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231254290000000C",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231254300000000D","StatusNotification",{"connectorId":1,"status":"Preparing","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231254300000000D",{}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"d6981db9-195f-4927-a799-e112ddcacfdd","Reset",{"type":"Soft"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"d6981db9-195f-4927-a799-e112ddcacfdd",{"status":"Accepted"}]
[ERROR server.py:233] connection handler failed
Traceback (most recent call last):
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 944, in transfer_data
    message = await self.read_message()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1013, in read_message
    frame = await self.read_data_frame(max_size=self.max_size)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1089, in read_data_frame
    frame = await self.read_frame(max_size)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1148, in read_frame
    extensions=self.extensions,
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\framing.py", line 70, in read
    data = await reader(2)
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\streams.py", line 679, in readexactly
    await self._wait_for_data('readexactly')
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\streams.py", line 473, in _wait_for_data
    await self._waiter
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\selector_events.py", line 812, in _read_ready__data_received
    data = self._sock.recv(self.max_size)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\server.py", line 231, in handler
    await self.ws_handler(self)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\server.py", line 1137, in _ws_handler
    )(websocket, websocket.path)
  File "D:\workspace\ocpp_test\server\connect.py", line 156, in on_connect
    await Value.chargePoint.start()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\ocpp\charge_point.py", line 125, in start
    message = await self._connection.recv()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 552, in recv
    await self.ensure_open()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 920, in ensure_open
    raise self.connection_closed_exc()
websockets.exceptions.ConnectionClosedError: no close frame received or sent
[INFO server.py:259] connection closed
[INFO server.py:641] connection open
[INFO connect.py:146] Protocols Matched: ocpp1.6
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312551400000001","BootNotification",{"chargePointModel":"MaxiChargerAC","chargePointVendor":"Autel","firmwareVersion":"CAQoSPAGNL"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312551400000001",{"currentTime":"2022-01-23T12:55:16.123Z","interval":10,"status":"Accepted"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312551600000002","StatusNotification",{"connectorId":0,"status":"Available","errorCode":"NoError"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312551600000002",{}]
[INFO test_Recurrent_cpVoltN.py:69] 稍等5秒，等桩连上后台
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312551600000003","StatusNotification",{"connectorId":1,"status":"Preparing","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312551600000003",{}]
[INFO test_Recurrent_cpVoltN.py:31] ========这是第74次开始执行========
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"d9054487-6f65-4dc5-9021-55da470933c0","RemoteStartTransaction",{"idTag":"AE0022A1GM9C00066K","connectorId":1,"chargingProfile":{"chargingProfileId":1,"transactionId":1,"stackLevel":1,"chargingProfilePurpose":"ChargePointMaxProfile","chargingProfileKind":"Absolute","recurrencyKind":"Daily","validFrom":"date-time","validTo":"date-time","chargingSchedule":{"duration":10,"startSchedule":"date-time","chargingRateUnit":"W","chargingSchedulePeriod":[{"startPeriod":1,"limit":1.5,"numberPhases":1}],"minChargingRate":1.5}}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"d9054487-6f65-4dc5-9021-55da470933c0",{"status":"Accepted"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312552500000004","Authorize",{"idTag":"AE0022A1GM9C00066K"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312552500000004",{"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312552700000005","StatusNotification",{"connectorId":1,"status":"Charging","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312552700000005",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312552800000006","StartTransaction",{"connectorId":1,"idTag":"AE0022A1GM9C00066K","meterStart":528242,"timestamp":"2022-01-23T12:55:27.000Z"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312552800000006",{"transactionId":1,"idTagInfo":{"status":"Accepted"}}]
[INFO test_Recurrent_cpVoltN.py:52] ********正在充电********稍等约1分钟********
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"9b9eaab2-0fc4-4d3d-84c7-590cd96e1834","RemoteStopTransaction",{"transactionId":1}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312552900000007","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T12:55:29.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"212.880000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.380000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.950000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312552900000007",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312554000000008","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T12:56:00.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"212.750000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.370000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.950000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312554000000008",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"9b9eaab2-0fc4-4d3d-84c7-590cd96e1834",{"status":"Accepted"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231256260000000E","StopTransaction",{"idTag":"AE0022A1GM9C00066K","transactionId":1,"meterStop":528242,"timestamp":"2022-01-23T12:56:25.000Z","reason":"Remote"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231256260000000E",{"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312555000000009","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T12:56:30.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312555000000009",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231256000000000A","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T12:56:31.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231256000000000A",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231256100000000B","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T12:56:31.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231256100000000B",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231256180000000C","StatusNotification",{"connectorId":1,"status":"Preparing","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231256180000000C",{}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"d33ec5a6-1f2a-457e-865a-d82855efe29f","Reset",{"type":"Soft"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"d33ec5a6-1f2a-457e-865a-d82855efe29f",{"status":"Accepted"}]
[ERROR server.py:233] connection handler failed
Traceback (most recent call last):
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 944, in transfer_data
    message = await self.read_message()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1013, in read_message
    frame = await self.read_data_frame(max_size=self.max_size)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1089, in read_data_frame
    frame = await self.read_frame(max_size)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1148, in read_frame
    extensions=self.extensions,
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\framing.py", line 70, in read
    data = await reader(2)
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\streams.py", line 679, in readexactly
    await self._wait_for_data('readexactly')
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\streams.py", line 473, in _wait_for_data
    await self._waiter
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\selector_events.py", line 812, in _read_ready__data_received
    data = self._sock.recv(self.max_size)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\server.py", line 231, in handler
    await self.ws_handler(self)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\server.py", line 1137, in _ws_handler
    )(websocket, websocket.path)
  File "D:\workspace\ocpp_test\server\connect.py", line 156, in on_connect
    await Value.chargePoint.start()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\ocpp\charge_point.py", line 125, in start
    message = await self._connection.recv()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 552, in recv
    await self.ensure_open()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 920, in ensure_open
    raise self.connection_closed_exc()
websockets.exceptions.ConnectionClosedError: no close frame received or sent
[INFO server.py:259] connection closed
[INFO server.py:641] connection open
[INFO connect.py:146] Protocols Matched: ocpp1.6
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312565700000001","BootNotification",{"chargePointModel":"MaxiChargerAC","chargePointVendor":"Autel","firmwareVersion":"CAQoSPAGNL"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312565700000001",{"currentTime":"2022-01-23T12:56:57.123Z","interval":10,"status":"Accepted"}]
[INFO test_Recurrent_cpVoltN.py:69] 稍等5秒，等桩连上后台
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312565700000002","StatusNotification",{"connectorId":0,"status":"Available","errorCode":"NoError"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312565700000002",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312565700000003","StatusNotification",{"connectorId":1,"status":"Preparing","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312565700000003",{}]
[INFO test_Recurrent_cpVoltN.py:31] ========这是第75次开始执行========
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"ed5ac411-b85b-4ad1-b8db-1325d0588bb4","RemoteStartTransaction",{"idTag":"AE0022A1GM9C00066K","connectorId":1,"chargingProfile":{"chargingProfileId":1,"transactionId":1,"stackLevel":1,"chargingProfilePurpose":"ChargePointMaxProfile","chargingProfileKind":"Absolute","recurrencyKind":"Daily","validFrom":"date-time","validTo":"date-time","chargingSchedule":{"duration":10,"startSchedule":"date-time","chargingRateUnit":"W","chargingSchedulePeriod":[{"startPeriod":1,"limit":1.5,"numberPhases":1}],"minChargingRate":1.5}}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"ed5ac411-b85b-4ad1-b8db-1325d0588bb4",{"status":"Accepted"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312570500000004","Authorize",{"idTag":"AE0022A1GM9C00066K"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312570500000004",{"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312570800000005","StatusNotification",{"connectorId":1,"status":"Charging","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312570800000005",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312570900000006","StartTransaction",{"connectorId":1,"idTag":"AE0022A1GM9C00066K","meterStart":528242,"timestamp":"2022-01-23T12:57:08.000Z"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312570900000006",{"transactionId":1,"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312571000000007","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T12:57:10.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"212.850000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.390000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.960000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312571000000007",{}]
[INFO test_Recurrent_cpVoltN.py:52] ********正在充电********稍等约1分钟********
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"8ea40956-4506-4429-bcd1-dae9bd2e134c","RemoteStopTransaction",{"transactionId":1}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312572100000008","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T12:57:21.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"212.800000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.380000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.960000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312572100000008",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312573100000009","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T12:57:51.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"212.750000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.370000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.950000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.010000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312573100000009",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"8ea40956-4506-4429-bcd1-dae9bd2e134c",{"status":"Accepted"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231258100000000E","StopTransaction",{"idTag":"AE0022A1GM9C00066K","transactionId":1,"meterStop":528242,"timestamp":"2022-01-23T12:58:09.000Z","reason":"Remote"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231258100000000E",{"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231257410000000A","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T12:58:21.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231257410000000A",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231257520000000B","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T12:58:21.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231257520000000B",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231258020000000C","StatusNotification",{"connectorId":1,"status":"Preparing","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231258020000000C",{}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"df63e6f2-b5ba-4b5e-afc4-07beb8e7cb5d","Reset",{"type":"Soft"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"df63e6f2-b5ba-4b5e-afc4-07beb8e7cb5d",{"status":"Accepted"}]
[ERROR server.py:233] connection handler failed
Traceback (most recent call last):
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 944, in transfer_data
    message = await self.read_message()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1013, in read_message
    frame = await self.read_data_frame(max_size=self.max_size)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1089, in read_data_frame
    frame = await self.read_frame(max_size)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1148, in read_frame
    extensions=self.extensions,
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\framing.py", line 70, in read
    data = await reader(2)
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\streams.py", line 679, in readexactly
    await self._wait_for_data('readexactly')
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\streams.py", line 473, in _wait_for_data
    await self._waiter
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\selector_events.py", line 812, in _read_ready__data_received
    data = self._sock.recv(self.max_size)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\server.py", line 231, in handler
    await self.ws_handler(self)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\server.py", line 1137, in _ws_handler
    )(websocket, websocket.path)
  File "D:\workspace\ocpp_test\server\connect.py", line 156, in on_connect
    await Value.chargePoint.start()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\ocpp\charge_point.py", line 125, in start
    message = await self._connection.recv()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 552, in recv
    await self.ensure_open()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 920, in ensure_open
    raise self.connection_closed_exc()
websockets.exceptions.ConnectionClosedError: no close frame received or sent
[INFO server.py:259] connection closed
[INFO server.py:641] connection open
[INFO connect.py:146] Protocols Matched: ocpp1.6
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312584600000001","BootNotification",{"chargePointModel":"MaxiChargerAC","chargePointVendor":"Autel","firmwareVersion":"CAQoSPAGNL"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312584600000001",{"currentTime":"2022-01-23T12:58:47.123Z","interval":10,"status":"Accepted"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312584700000002","StatusNotification",{"connectorId":0,"status":"Available","errorCode":"NoError"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312584700000002",{}]
[INFO test_Recurrent_cpVoltN.py:69] 稍等5秒，等桩连上后台
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312584700000003","StatusNotification",{"connectorId":1,"status":"Preparing","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312584700000003",{}]
[INFO test_Recurrent_cpVoltN.py:31] ========这是第76次开始执行========
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"628f402b-98b2-4650-8624-c253623d9f23","RemoteStartTransaction",{"idTag":"AE0022A1GM9C00066K","connectorId":1,"chargingProfile":{"chargingProfileId":1,"transactionId":1,"stackLevel":1,"chargingProfilePurpose":"ChargePointMaxProfile","chargingProfileKind":"Absolute","recurrencyKind":"Daily","validFrom":"date-time","validTo":"date-time","chargingSchedule":{"duration":10,"startSchedule":"date-time","chargingRateUnit":"W","chargingSchedulePeriod":[{"startPeriod":1,"limit":1.5,"numberPhases":1}],"minChargingRate":1.5}}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"628f402b-98b2-4650-8624-c253623d9f23",{"status":"Accepted"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312585600000004","Authorize",{"idTag":"AE0022A1GM9C00066K"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312585600000004",{"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312585800000005","StatusNotification",{"connectorId":1,"status":"Charging","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312585800000005",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312585900000006","StartTransaction",{"connectorId":1,"idTag":"AE0022A1GM9C00066K","meterStart":528242,"timestamp":"2022-01-23T12:58:58.000Z"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312585900000006",{"transactionId":1,"idTagInfo":{"status":"Accepted"}}]
[INFO test_Recurrent_cpVoltN.py:52] ********正在充电********稍等约1分钟********
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"b0ccaf4d-1ef6-4984-ab96-ea40882c836c","RemoteStopTransaction",{"transactionId":1}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312590000000007","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T12:59:00.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"212.910000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.380000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.950000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312590000000007",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312591000000008","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T12:59:30.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"212.850000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.380000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.960000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312591000000008",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"b0ccaf4d-1ef6-4984-ab96-ea40882c836c",{"status":"Accepted"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231259570000000E","StopTransaction",{"idTag":"AE0022A1GM9C00066K","transactionId":1,"meterStop":528242,"timestamp":"2022-01-23T12:59:56.000Z","reason":"Remote"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231259570000000E",{"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012312592000000009","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T13:00:01.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012312592000000009",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231259310000000A","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T13:00:01.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231259310000000A",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231259410000000B","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T13:00:02.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231259410000000B",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231259490000000C","StatusNotification",{"connectorId":1,"status":"Preparing","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231259490000000C",{}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"98940fd9-1353-4b68-b439-b75c857ea011","Reset",{"type":"Soft"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"98940fd9-1353-4b68-b439-b75c857ea011",{"status":"Accepted"}]
[ERROR server.py:233] connection handler failed
Traceback (most recent call last):
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 944, in transfer_data
    message = await self.read_message()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1013, in read_message
    frame = await self.read_data_frame(max_size=self.max_size)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1089, in read_data_frame
    frame = await self.read_frame(max_size)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1148, in read_frame
    extensions=self.extensions,
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\framing.py", line 70, in read
    data = await reader(2)
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\streams.py", line 679, in readexactly
    await self._wait_for_data('readexactly')
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\streams.py", line 473, in _wait_for_data
    await self._waiter
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\selector_events.py", line 812, in _read_ready__data_received
    data = self._sock.recv(self.max_size)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\server.py", line 231, in handler
    await self.ws_handler(self)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\server.py", line 1137, in _ws_handler
    )(websocket, websocket.path)
  File "D:\workspace\ocpp_test\server\connect.py", line 156, in on_connect
    await Value.chargePoint.start()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\ocpp\charge_point.py", line 125, in start
    message = await self._connection.recv()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 552, in recv
    await self.ensure_open()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 920, in ensure_open
    raise self.connection_closed_exc()
websockets.exceptions.ConnectionClosedError: no close frame received or sent
[INFO server.py:259] connection closed
[INFO server.py:641] connection open
[INFO connect.py:146] Protocols Matched: ocpp1.6
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012313002100000001","BootNotification",{"chargePointModel":"MaxiChargerAC","chargePointVendor":"Autel","firmwareVersion":"CAQoSPAGNL"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012313002100000001",{"currentTime":"2022-01-23T13:00:22.123Z","interval":10,"status":"Accepted"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012313002200000002","StatusNotification",{"connectorId":0,"status":"Available","errorCode":"NoError"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012313002200000002",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012313002200000003","StatusNotification",{"connectorId":1,"status":"Preparing","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012313002200000003",{}]
[INFO test_Recurrent_cpVoltN.py:69] 稍等5秒，等桩连上后台
[INFO test_Recurrent_cpVoltN.py:31] ========这是第77次开始执行========
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"ae9cf768-4956-4602-a0ea-4cd28582d488","RemoteStartTransaction",{"idTag":"AE0022A1GM9C00066K","connectorId":1,"chargingProfile":{"chargingProfileId":1,"transactionId":1,"stackLevel":1,"chargingProfilePurpose":"ChargePointMaxProfile","chargingProfileKind":"Absolute","recurrencyKind":"Daily","validFrom":"date-time","validTo":"date-time","chargingSchedule":{"duration":10,"startSchedule":"date-time","chargingRateUnit":"W","chargingSchedulePeriod":[{"startPeriod":1,"limit":1.5,"numberPhases":1}],"minChargingRate":1.5}}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"ae9cf768-4956-4602-a0ea-4cd28582d488",{"status":"Accepted"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012313002900000004","Authorize",{"idTag":"AE0022A1GM9C00066K"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012313002900000004",{"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012313003200000005","StatusNotification",{"connectorId":1,"status":"Charging","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012313003200000005",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012313003300000006","StartTransaction",{"connectorId":1,"idTag":"AE0022A1GM9C00066K","meterStart":528242,"timestamp":"2022-01-23T13:00:32.000Z"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012313003300000006",{"transactionId":1,"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012313003400000007","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T13:00:34.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"213.020000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.380000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.960000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.010000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012313003400000007",{}]
[INFO test_Recurrent_cpVoltN.py:52] ********正在充电********稍等约1分钟********
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"43948e40-d381-4a65-bb05-138444e5328c","RemoteStopTransaction",{"transactionId":1}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012313004400000008","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T13:00:44.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"212.690000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.370000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.950000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012313004400000008",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012313005400000009","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T13:01:14.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"212.220000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.360000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.950000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012313005400000009",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"43948e40-d381-4a65-bb05-138444e5328c",{"status":"Accepted"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231301330000000F","StopTransaction",{"idTag":"AE0022A1GM9C00066K","transactionId":1,"meterStop":528242,"timestamp":"2022-01-23T13:01:32.000Z","reason":"Remote"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231301330000000F",{"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231301040000000A","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T13:01:45.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231301040000000A",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231301140000000B","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T13:01:45.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231301140000000B",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231301250000000C","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T13:01:46.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231301250000000C",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231301250000000D","StatusNotification",{"connectorId":1,"status":"Preparing","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231301250000000D",{}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"6633c519-d90a-451e-89a6-753324fb8543","Reset",{"type":"Soft"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"6633c519-d90a-451e-89a6-753324fb8543",{"status":"Accepted"}]
[ERROR server.py:233] connection handler failed
Traceback (most recent call last):
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 944, in transfer_data
    message = await self.read_message()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1013, in read_message
    frame = await self.read_data_frame(max_size=self.max_size)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1089, in read_data_frame
    frame = await self.read_frame(max_size)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1148, in read_frame
    extensions=self.extensions,
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\framing.py", line 70, in read
    data = await reader(2)
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\streams.py", line 679, in readexactly
    await self._wait_for_data('readexactly')
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\streams.py", line 473, in _wait_for_data
    await self._waiter
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\selector_events.py", line 812, in _read_ready__data_received
    data = self._sock.recv(self.max_size)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\server.py", line 231, in handler
    await self.ws_handler(self)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\server.py", line 1137, in _ws_handler
    )(websocket, websocket.path)
  File "D:\workspace\ocpp_test\server\connect.py", line 156, in on_connect
    await Value.chargePoint.start()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\ocpp\charge_point.py", line 125, in start
    message = await self._connection.recv()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 552, in recv
    await self.ensure_open()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 920, in ensure_open
    raise self.connection_closed_exc()
websockets.exceptions.ConnectionClosedError: no close frame received or sent
[INFO server.py:259] connection closed
[INFO server.py:641] connection open
[INFO connect.py:146] Protocols Matched: ocpp1.6
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012313021300000001","BootNotification",{"chargePointModel":"MaxiChargerAC","chargePointVendor":"Autel","firmwareVersion":"CAQoSPAGNL"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012313021300000001",{"currentTime":"2022-01-23T13:02:13.123Z","interval":10,"status":"Accepted"}]
[INFO test_Recurrent_cpVoltN.py:69] 稍等5秒，等桩连上后台
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012313021300000002","StatusNotification",{"connectorId":0,"status":"Available","errorCode":"NoError"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012313021300000002",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012313021300000003","StatusNotification",{"connectorId":1,"status":"Preparing","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012313021300000003",{}]
[INFO test_Recurrent_cpVoltN.py:31] ========这是第78次开始执行========
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"660a9415-ab5c-41ce-8ba7-aa103992149a","RemoteStartTransaction",{"idTag":"AE0022A1GM9C00066K","connectorId":1,"chargingProfile":{"chargingProfileId":1,"transactionId":1,"stackLevel":1,"chargingProfilePurpose":"ChargePointMaxProfile","chargingProfileKind":"Absolute","recurrencyKind":"Daily","validFrom":"date-time","validTo":"date-time","chargingSchedule":{"duration":10,"startSchedule":"date-time","chargingRateUnit":"W","chargingSchedulePeriod":[{"startPeriod":1,"limit":1.5,"numberPhases":1}],"minChargingRate":1.5}}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"660a9415-ab5c-41ce-8ba7-aa103992149a",{"status":"Accepted"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012313022200000004","Authorize",{"idTag":"AE0022A1GM9C00066K"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012313022200000004",{"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012313022400000005","StatusNotification",{"connectorId":1,"status":"Charging","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012313022400000005",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012313022500000006","StartTransaction",{"connectorId":1,"idTag":"AE0022A1GM9C00066K","meterStart":528242,"timestamp":"2022-01-23T13:02:24.000Z"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012313022500000006",{"transactionId":1,"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012313022600000007","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T13:02:26.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"212.540000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.370000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.950000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.010000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012313022600000007",{}]
[INFO test_Recurrent_cpVoltN.py:52] ********正在充电********稍等约1分钟********
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"1e8c1cd5-06f5-4a38-95d4-1cb360e73d01","RemoteStopTransaction",{"transactionId":1}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012313023600000008","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T13:02:37.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"212.650000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.380000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.950000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012313023600000008",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012313024700000009","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T13:03:07.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"212.580000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.370000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.950000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.010000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012313024700000009",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"1e8c1cd5-06f5-4a38-95d4-1cb360e73d01",{"status":"Accepted"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231303260000000F","StopTransaction",{"idTag":"AE0022A1GM9C00066K","transactionId":1,"meterStop":528242,"timestamp":"2022-01-23T13:03:25.000Z","reason":"Remote"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231303260000000F",{"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231302570000000A","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T13:03:37.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231302570000000A",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231303070000000B","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T13:03:38.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231303070000000B",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231303170000000C","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T13:03:38.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231303170000000C",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231303180000000D","StatusNotification",{"connectorId":1,"status":"Preparing","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231303180000000D",{}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"1aae2735-4755-4e33-9dc0-38c6be4986b4","Reset",{"type":"Soft"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"1aae2735-4755-4e33-9dc0-38c6be4986b4",{"status":"Accepted"}]
[ERROR server.py:233] connection handler failed
Traceback (most recent call last):
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 944, in transfer_data
    message = await self.read_message()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1013, in read_message
    frame = await self.read_data_frame(max_size=self.max_size)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1089, in read_data_frame
    frame = await self.read_frame(max_size)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1148, in read_frame
    extensions=self.extensions,
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\framing.py", line 70, in read
    data = await reader(2)
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\streams.py", line 679, in readexactly
    await self._wait_for_data('readexactly')
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\streams.py", line 473, in _wait_for_data
    await self._waiter
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\selector_events.py", line 812, in _read_ready__data_received
    data = self._sock.recv(self.max_size)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\server.py", line 231, in handler
    await self.ws_handler(self)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\server.py", line 1137, in _ws_handler
    )(websocket, websocket.path)
  File "D:\workspace\ocpp_test\server\connect.py", line 156, in on_connect
    await Value.chargePoint.start()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\ocpp\charge_point.py", line 125, in start
    message = await self._connection.recv()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 552, in recv
    await self.ensure_open()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 920, in ensure_open
    raise self.connection_closed_exc()
websockets.exceptions.ConnectionClosedError: no close frame received or sent
[INFO server.py:259] connection closed
[INFO server.py:641] connection open
[INFO connect.py:146] Protocols Matched: ocpp1.6
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012313040300000001","BootNotification",{"chargePointModel":"MaxiChargerAC","chargePointVendor":"Autel","firmwareVersion":"CAQoSPAGNL"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012313040300000001",{"currentTime":"2022-01-23T13:04:04.123Z","interval":10,"status":"Accepted"}]
[INFO test_Recurrent_cpVoltN.py:69] 稍等5秒，等桩连上后台
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012313040400000002","StatusNotification",{"connectorId":0,"status":"Available","errorCode":"NoError"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012313040400000002",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012313040400000003","StatusNotification",{"connectorId":1,"status":"Preparing","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012313040400000003",{}]
[INFO test_Recurrent_cpVoltN.py:31] ========这是第79次开始执行========
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"c58f3200-861e-4837-bda6-54d69c103fea","RemoteStartTransaction",{"idTag":"AE0022A1GM9C00066K","connectorId":1,"chargingProfile":{"chargingProfileId":1,"transactionId":1,"stackLevel":1,"chargingProfilePurpose":"ChargePointMaxProfile","chargingProfileKind":"Absolute","recurrencyKind":"Daily","validFrom":"date-time","validTo":"date-time","chargingSchedule":{"duration":10,"startSchedule":"date-time","chargingRateUnit":"W","chargingSchedulePeriod":[{"startPeriod":1,"limit":1.5,"numberPhases":1}],"minChargingRate":1.5}}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"c58f3200-861e-4837-bda6-54d69c103fea",{"status":"Accepted"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012313041300000004","Authorize",{"idTag":"AE0022A1GM9C00066K"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012313041300000004",{"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012313041500000005","StatusNotification",{"connectorId":1,"status":"Charging","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012313041500000005",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012313041600000006","StartTransaction",{"connectorId":1,"idTag":"AE0022A1GM9C00066K","meterStart":528242,"timestamp":"2022-01-23T13:04:15.000Z"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012313041600000006",{"transactionId":1,"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012313041700000007","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T13:04:17.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"212.860000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.380000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.950000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012313041700000007",{}]
[INFO test_Recurrent_cpVoltN.py:52] ********正在充电********稍等约1分钟********
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"d1b8f1e9-8afa-40c3-bd82-79c6bbc6fec2","RemoteStopTransaction",{"transactionId":1}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012313042700000008","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T13:04:28.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"212.690000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.380000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.950000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012313042700000008",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012313043800000009","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T13:04:58.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"212.530000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.370000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.950000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012313043800000009",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"d1b8f1e9-8afa-40c3-bd82-79c6bbc6fec2",{"status":"Accepted"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231305170000000F","StopTransaction",{"idTag":"AE0022A1GM9C00066K","transactionId":1,"meterStop":528242,"timestamp":"2022-01-23T13:05:16.000Z","reason":"Remote"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231305170000000F",{"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231304480000000A","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T13:05:28.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231304480000000A",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231304580000000B","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T13:05:28.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231304580000000B",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231305080000000C","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T13:05:29.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231305080000000C",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231305090000000D","StatusNotification",{"connectorId":1,"status":"Preparing","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231305090000000D",{}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"3c21c116-3587-4401-980d-cf379edc6e53","Reset",{"type":"Soft"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"3c21c116-3587-4401-980d-cf379edc6e53",{"status":"Accepted"}]
[ERROR server.py:233] connection handler failed
Traceback (most recent call last):
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 944, in transfer_data
    message = await self.read_message()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1013, in read_message
    frame = await self.read_data_frame(max_size=self.max_size)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1089, in read_data_frame
    frame = await self.read_frame(max_size)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1148, in read_frame
    extensions=self.extensions,
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\framing.py", line 70, in read
    data = await reader(2)
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\streams.py", line 679, in readexactly
    await self._wait_for_data('readexactly')
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\streams.py", line 473, in _wait_for_data
    await self._waiter
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\selector_events.py", line 812, in _read_ready__data_received
    data = self._sock.recv(self.max_size)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\server.py", line 231, in handler
    await self.ws_handler(self)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\server.py", line 1137, in _ws_handler
    )(websocket, websocket.path)
  File "D:\workspace\ocpp_test\server\connect.py", line 156, in on_connect
    await Value.chargePoint.start()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\ocpp\charge_point.py", line 125, in start
    message = await self._connection.recv()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 552, in recv
    await self.ensure_open()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 920, in ensure_open
    raise self.connection_closed_exc()
websockets.exceptions.ConnectionClosedError: no close frame received or sent
[INFO server.py:259] connection closed
[INFO server.py:641] connection open
[INFO connect.py:146] Protocols Matched: ocpp1.6
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012313055400000001","BootNotification",{"chargePointModel":"MaxiChargerAC","chargePointVendor":"Autel","firmwareVersion":"CAQoSPAGNL"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012313055400000001",{"currentTime":"2022-01-23T13:05:55.123Z","interval":10,"status":"Accepted"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012313055500000002","StatusNotification",{"connectorId":0,"status":"Available","errorCode":"NoError"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012313055500000002",{}]
[INFO test_Recurrent_cpVoltN.py:69] 稍等5秒，等桩连上后台
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012313055500000003","StatusNotification",{"connectorId":1,"status":"Preparing","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012313055500000003",{}]
[INFO test_Recurrent_cpVoltN.py:31] ========这是第80次开始执行========
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"79c140af-8b84-44cd-9542-0c3d7b95c6a3","RemoteStartTransaction",{"idTag":"AE0022A1GM9C00066K","connectorId":1,"chargingProfile":{"chargingProfileId":1,"transactionId":1,"stackLevel":1,"chargingProfilePurpose":"ChargePointMaxProfile","chargingProfileKind":"Absolute","recurrencyKind":"Daily","validFrom":"date-time","validTo":"date-time","chargingSchedule":{"duration":10,"startSchedule":"date-time","chargingRateUnit":"W","chargingSchedulePeriod":[{"startPeriod":1,"limit":1.5,"numberPhases":1}],"minChargingRate":1.5}}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"79c140af-8b84-44cd-9542-0c3d7b95c6a3",{"status":"Accepted"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012313060400000004","Authorize",{"idTag":"AE0022A1GM9C00066K"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012313060400000004",{"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012313060600000005","StatusNotification",{"connectorId":1,"status":"Charging","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012313060600000005",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012313060700000006","StartTransaction",{"connectorId":1,"idTag":"AE0022A1GM9C00066K","meterStart":528242,"timestamp":"2022-01-23T13:06:06.000Z"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012313060700000006",{"transactionId":1,"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012313060800000007","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T13:06:08.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"212.600000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.360000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.950000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012313060800000007",{}]
[INFO test_Recurrent_cpVoltN.py:52] ********正在充电********稍等约1分钟********
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"72764ddb-6326-4116-ad05-56af06bd53b5","RemoteStopTransaction",{"transactionId":1}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012313061800000008","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T13:06:18.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"212.870000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.380000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.950000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012313061800000008",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012313062900000009","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T13:06:49.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"213.060000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.390000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.950000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012313062900000009",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"72764ddb-6326-4116-ad05-56af06bd53b5",{"status":"Accepted"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231307080000000F","StopTransaction",{"idTag":"AE0022A1GM9C00066K","transactionId":1,"meterStop":528242,"timestamp":"2022-01-23T13:07:07.000Z","reason":"Remote"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231307080000000F",{"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231306390000000A","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T13:07:19.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231306390000000A",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231306490000000B","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T13:07:20.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231306490000000B",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231306590000000C","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T13:07:20.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231306590000000C",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231307000000000D","StatusNotification",{"connectorId":1,"status":"Preparing","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231307000000000D",{}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"c57ba926-69e1-435c-a3aa-1f811072aa8f","Reset",{"type":"Soft"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"c57ba926-69e1-435c-a3aa-1f811072aa8f",{"status":"Accepted"}]
[ERROR server.py:233] connection handler failed
Traceback (most recent call last):
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 944, in transfer_data
    message = await self.read_message()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1013, in read_message
    frame = await self.read_data_frame(max_size=self.max_size)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1089, in read_data_frame
    frame = await self.read_frame(max_size)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1148, in read_frame
    extensions=self.extensions,
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\framing.py", line 70, in read
    data = await reader(2)
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\streams.py", line 679, in readexactly
    await self._wait_for_data('readexactly')
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\streams.py", line 473, in _wait_for_data
    await self._waiter
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\selector_events.py", line 812, in _read_ready__data_received
    data = self._sock.recv(self.max_size)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\server.py", line 231, in handler
    await self.ws_handler(self)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\server.py", line 1137, in _ws_handler
    )(websocket, websocket.path)
  File "D:\workspace\ocpp_test\server\connect.py", line 156, in on_connect
    await Value.chargePoint.start()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\ocpp\charge_point.py", line 125, in start
    message = await self._connection.recv()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 552, in recv
    await self.ensure_open()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 920, in ensure_open
    raise self.connection_closed_exc()
websockets.exceptions.ConnectionClosedError: no close frame received or sent
[INFO server.py:259] connection closed
[INFO server.py:641] connection open
[INFO connect.py:146] Protocols Matched: ocpp1.6
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012313074400000001","BootNotification",{"chargePointModel":"MaxiChargerAC","chargePointVendor":"Autel","firmwareVersion":"CAQoSPAGNL"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012313074400000001",{"currentTime":"2022-01-23T13:07:45.123Z","interval":10,"status":"Accepted"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012313074500000002","StatusNotification",{"connectorId":0,"status":"Available","errorCode":"NoError"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012313074500000002",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012313074500000003","StatusNotification",{"connectorId":1,"status":"Preparing","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012313074500000003",{}]
[INFO test_Recurrent_cpVoltN.py:69] 稍等5秒，等桩连上后台
[INFO test_Recurrent_cpVoltN.py:31] ========这是第81次开始执行========
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"8f3ea818-0bba-45fb-87e8-04a1cbd8aca4","RemoteStartTransaction",{"idTag":"AE0022A1GM9C00066K","connectorId":1,"chargingProfile":{"chargingProfileId":1,"transactionId":1,"stackLevel":1,"chargingProfilePurpose":"ChargePointMaxProfile","chargingProfileKind":"Absolute","recurrencyKind":"Daily","validFrom":"date-time","validTo":"date-time","chargingSchedule":{"duration":10,"startSchedule":"date-time","chargingRateUnit":"W","chargingSchedulePeriod":[{"startPeriod":1,"limit":1.5,"numberPhases":1}],"minChargingRate":1.5}}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"8f3ea818-0bba-45fb-87e8-04a1cbd8aca4",{"status":"Accepted"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012313075100000004","Authorize",{"idTag":"AE0022A1GM9C00066K"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012313075100000004",{"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012313075400000005","StatusNotification",{"connectorId":1,"status":"Charging","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012313075400000005",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012313075400000006","StartTransaction",{"connectorId":1,"idTag":"AE0022A1GM9C00066K","meterStart":528242,"timestamp":"2022-01-23T13:07:54.000Z"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012313075400000006",{"transactionId":1,"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012313075600000007","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T13:07:56.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"213.090000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.390000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.960000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012313075600000007",{}]
[INFO test_Recurrent_cpVoltN.py:52] ********正在充电********稍等约1分钟********
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"5e690f0d-80b2-458e-b872-12e316833286","RemoteStopTransaction",{"transactionId":1}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012313080600000008","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T13:08:06.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"213.040000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.390000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.950000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012313080600000008",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012313081600000009","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T13:08:37.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"213.100000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.390000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.960000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012313081600000009",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"5e690f0d-80b2-458e-b872-12e316833286",{"status":"Accepted"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231308550000000F","StopTransaction",{"idTag":"AE0022A1GM9C00066K","transactionId":1,"meterStop":528242,"timestamp":"2022-01-23T13:08:54.000Z","reason":"Remote"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231308550000000F",{"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231308270000000A","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T13:09:07.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231308270000000A",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231308370000000B","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T13:09:08.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231308370000000B",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231308470000000C","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T13:09:08.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.010000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231308470000000C",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231308480000000D","StatusNotification",{"connectorId":1,"status":"Preparing","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231308480000000D",{}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"372622b6-4532-46a7-a4ba-9afe2a237266","Reset",{"type":"Soft"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"372622b6-4532-46a7-a4ba-9afe2a237266",{"status":"Accepted"}]
[ERROR server.py:233] connection handler failed
Traceback (most recent call last):
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 944, in transfer_data
    message = await self.read_message()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1013, in read_message
    frame = await self.read_data_frame(max_size=self.max_size)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1089, in read_data_frame
    frame = await self.read_frame(max_size)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1148, in read_frame
    extensions=self.extensions,
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\framing.py", line 70, in read
    data = await reader(2)
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\streams.py", line 679, in readexactly
    await self._wait_for_data('readexactly')
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\streams.py", line 473, in _wait_for_data
    await self._waiter
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\selector_events.py", line 812, in _read_ready__data_received
    data = self._sock.recv(self.max_size)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\server.py", line 231, in handler
    await self.ws_handler(self)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\server.py", line 1137, in _ws_handler
    )(websocket, websocket.path)
  File "D:\workspace\ocpp_test\server\connect.py", line 156, in on_connect
    await Value.chargePoint.start()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\ocpp\charge_point.py", line 125, in start
    message = await self._connection.recv()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 552, in recv
    await self.ensure_open()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 920, in ensure_open
    raise self.connection_closed_exc()
websockets.exceptions.ConnectionClosedError: no close frame received or sent
[INFO server.py:259] connection closed
[INFO server.py:641] connection open
[INFO connect.py:146] Protocols Matched: ocpp1.6
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012313093500000001","BootNotification",{"chargePointModel":"MaxiChargerAC","chargePointVendor":"Autel","firmwareVersion":"CAQoSPAGNL"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012313093500000001",{"currentTime":"2022-01-23T13:09:36.123Z","interval":10,"status":"Accepted"}]
[INFO test_Recurrent_cpVoltN.py:69] 稍等5秒，等桩连上后台
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012313093600000002","StatusNotification",{"connectorId":0,"status":"Available","errorCode":"NoError"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012313093600000002",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012313093600000003","StatusNotification",{"connectorId":1,"status":"Preparing","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012313093600000003",{}]
[INFO test_Recurrent_cpVoltN.py:31] ========这是第82次开始执行========
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"8e28f9d8-e3d4-40da-9022-a515b1267043","RemoteStartTransaction",{"idTag":"AE0022A1GM9C00066K","connectorId":1,"chargingProfile":{"chargingProfileId":1,"transactionId":1,"stackLevel":1,"chargingProfilePurpose":"ChargePointMaxProfile","chargingProfileKind":"Absolute","recurrencyKind":"Daily","validFrom":"date-time","validTo":"date-time","chargingSchedule":{"duration":10,"startSchedule":"date-time","chargingRateUnit":"W","chargingSchedulePeriod":[{"startPeriod":1,"limit":1.5,"numberPhases":1}],"minChargingRate":1.5}}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"8e28f9d8-e3d4-40da-9022-a515b1267043",{"status":"Accepted"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012313094500000004","Authorize",{"idTag":"AE0022A1GM9C00066K"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012313094500000004",{"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012313094700000005","StatusNotification",{"connectorId":1,"status":"Charging","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012313094700000005",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012313094800000006","StartTransaction",{"connectorId":1,"idTag":"AE0022A1GM9C00066K","meterStart":528242,"timestamp":"2022-01-23T13:09:47.000Z"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012313094800000006",{"transactionId":1,"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012313094900000007","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T13:09:49.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"213.100000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.390000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.950000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012313094900000007",{}]
[INFO test_Recurrent_cpVoltN.py:52] ********正在充电********稍等约1分钟********
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"af28cd59-b3a6-4e16-bf06-b46d0a085248","RemoteStopTransaction",{"transactionId":1}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012313095900000008","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T13:09:59.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"213.150000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.390000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.960000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012313095900000008",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012313101000000009","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T13:10:30.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"213.120000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.390000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.960000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012313101000000009",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"af28cd59-b3a6-4e16-bf06-b46d0a085248",{"status":"Accepted"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231310490000000F","StopTransaction",{"idTag":"AE0022A1GM9C00066K","transactionId":1,"meterStop":528242,"timestamp":"2022-01-23T13:10:48.000Z","reason":"Remote"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231310490000000F",{"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231310200000000A","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T13:11:00.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231310200000000A",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231310300000000B","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T13:11:01.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231310300000000B",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231310400000000C","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T13:11:01.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231310400000000C",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231310410000000D","StatusNotification",{"connectorId":1,"status":"Preparing","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231310410000000D",{}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"1bd3ad23-d9b8-4d08-b762-31ba55791c05","Reset",{"type":"Soft"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"1bd3ad23-d9b8-4d08-b762-31ba55791c05",{"status":"Accepted"}]
[ERROR server.py:233] connection handler failed
Traceback (most recent call last):
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 944, in transfer_data
    message = await self.read_message()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1013, in read_message
    frame = await self.read_data_frame(max_size=self.max_size)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1089, in read_data_frame
    frame = await self.read_frame(max_size)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1148, in read_frame
    extensions=self.extensions,
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\framing.py", line 70, in read
    data = await reader(2)
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\streams.py", line 679, in readexactly
    await self._wait_for_data('readexactly')
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\streams.py", line 473, in _wait_for_data
    await self._waiter
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\selector_events.py", line 812, in _read_ready__data_received
    data = self._sock.recv(self.max_size)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\server.py", line 231, in handler
    await self.ws_handler(self)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\server.py", line 1137, in _ws_handler
    )(websocket, websocket.path)
  File "D:\workspace\ocpp_test\server\connect.py", line 156, in on_connect
    await Value.chargePoint.start()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\ocpp\charge_point.py", line 125, in start
    message = await self._connection.recv()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 552, in recv
    await self.ensure_open()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 920, in ensure_open
    raise self.connection_closed_exc()
websockets.exceptions.ConnectionClosedError: no close frame received or sent
[INFO server.py:259] connection closed
[INFO server.py:641] connection open
[INFO connect.py:146] Protocols Matched: ocpp1.6
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012313112600000001","BootNotification",{"chargePointModel":"MaxiChargerAC","chargePointVendor":"Autel","firmwareVersion":"CAQoSPAGNL"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012313112600000001",{"currentTime":"2022-01-23T13:11:27.123Z","interval":10,"status":"Accepted"}]
[INFO test_Recurrent_cpVoltN.py:69] 稍等5秒，等桩连上后台
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012313112700000002","StatusNotification",{"connectorId":0,"status":"Available","errorCode":"NoError"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012313112700000002",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012313112700000003","StatusNotification",{"connectorId":1,"status":"Preparing","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012313112700000003",{}]
[INFO test_Recurrent_cpVoltN.py:31] ========这是第83次开始执行========
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"eb068945-3e4b-460a-9440-b433579f244e","RemoteStartTransaction",{"idTag":"AE0022A1GM9C00066K","connectorId":1,"chargingProfile":{"chargingProfileId":1,"transactionId":1,"stackLevel":1,"chargingProfilePurpose":"ChargePointMaxProfile","chargingProfileKind":"Absolute","recurrencyKind":"Daily","validFrom":"date-time","validTo":"date-time","chargingSchedule":{"duration":10,"startSchedule":"date-time","chargingRateUnit":"W","chargingSchedulePeriod":[{"startPeriod":1,"limit":1.5,"numberPhases":1}],"minChargingRate":1.5}}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"eb068945-3e4b-460a-9440-b433579f244e",{"status":"Accepted"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012313113500000004","Authorize",{"idTag":"AE0022A1GM9C00066K"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012313113500000004",{"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012313113800000005","StatusNotification",{"connectorId":1,"status":"Charging","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012313113800000005",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012313113900000006","StartTransaction",{"connectorId":1,"idTag":"AE0022A1GM9C00066K","meterStart":528242,"timestamp":"2022-01-23T13:11:38.000Z"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012313113900000006",{"transactionId":1,"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012313114000000007","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T13:11:40.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"213.050000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.380000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.960000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012313114000000007",{}]
[INFO test_Recurrent_cpVoltN.py:52] ********正在充电********稍等约1分钟********
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"a31a052d-50f6-46e3-8e10-6eed56b8836a","RemoteStopTransaction",{"transactionId":1}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012313115000000008","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T13:11:50.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"213.230000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.390000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.960000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012313115000000008",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012313120100000009","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T13:12:21.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"213.100000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.390000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.960000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012313120100000009",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"a31a052d-50f6-46e3-8e10-6eed56b8836a",{"status":"Accepted"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231312390000000F","StopTransaction",{"idTag":"AE0022A1GM9C00066K","transactionId":1,"meterStop":528242,"timestamp":"2022-01-23T13:12:38.000Z","reason":"Remote"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231312390000000F",{"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231312110000000A","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T13:12:51.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231312110000000A",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231312210000000B","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T13:12:52.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231312210000000B",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231312310000000C","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T13:12:52.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231312310000000C",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231312320000000D","StatusNotification",{"connectorId":1,"status":"Preparing","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231312320000000D",{}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"5cad80e5-d272-4993-bd6a-546ae0bc7ada","Reset",{"type":"Soft"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"5cad80e5-d272-4993-bd6a-546ae0bc7ada",{"status":"Accepted"}]
[ERROR server.py:233] connection handler failed
Traceback (most recent call last):
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 944, in transfer_data
    message = await self.read_message()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1013, in read_message
    frame = await self.read_data_frame(max_size=self.max_size)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1089, in read_data_frame
    frame = await self.read_frame(max_size)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1148, in read_frame
    extensions=self.extensions,
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\framing.py", line 70, in read
    data = await reader(2)
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\streams.py", line 679, in readexactly
    await self._wait_for_data('readexactly')
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\streams.py", line 473, in _wait_for_data
    await self._waiter
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\selector_events.py", line 812, in _read_ready__data_received
    data = self._sock.recv(self.max_size)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\server.py", line 231, in handler
    await self.ws_handler(self)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\server.py", line 1137, in _ws_handler
    )(websocket, websocket.path)
  File "D:\workspace\ocpp_test\server\connect.py", line 156, in on_connect
    await Value.chargePoint.start()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\ocpp\charge_point.py", line 125, in start
    message = await self._connection.recv()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 552, in recv
    await self.ensure_open()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 920, in ensure_open
    raise self.connection_closed_exc()
websockets.exceptions.ConnectionClosedError: no close frame received or sent
[INFO server.py:259] connection closed
[INFO server.py:641] connection open
[INFO connect.py:146] Protocols Matched: ocpp1.6
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012313131200000001","BootNotification",{"chargePointModel":"MaxiChargerAC","chargePointVendor":"Autel","firmwareVersion":"CAQoSPAGNL"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012313131200000001",{"currentTime":"2022-01-23T13:13:12.123Z","interval":10,"status":"Accepted"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012313131200000002","StatusNotification",{"connectorId":0,"status":"Available","errorCode":"NoError"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012313131200000002",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012313131200000003","StatusNotification",{"connectorId":1,"status":"Preparing","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012313131200000003",{}]
[INFO test_Recurrent_cpVoltN.py:69] 稍等5秒，等桩连上后台
[INFO test_Recurrent_cpVoltN.py:31] ========这是第84次开始执行========
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"4cbe5ce1-d97d-4406-8402-3d1b0879e82e","RemoteStartTransaction",{"idTag":"AE0022A1GM9C00066K","connectorId":1,"chargingProfile":{"chargingProfileId":1,"transactionId":1,"stackLevel":1,"chargingProfilePurpose":"ChargePointMaxProfile","chargingProfileKind":"Absolute","recurrencyKind":"Daily","validFrom":"date-time","validTo":"date-time","chargingSchedule":{"duration":10,"startSchedule":"date-time","chargingRateUnit":"W","chargingSchedulePeriod":[{"startPeriod":1,"limit":1.5,"numberPhases":1}],"minChargingRate":1.5}}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"4cbe5ce1-d97d-4406-8402-3d1b0879e82e",{"status":"Accepted"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012313131900000004","Authorize",{"idTag":"AE0022A1GM9C00066K"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012313131900000004",{"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012313132200000006","StartTransaction",{"connectorId":1,"idTag":"AE0022A1GM9C00066K","meterStart":528242,"timestamp":"2022-01-23T13:13:22.000Z"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012313132200000006",{"transactionId":1,"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012313132200000005","StatusNotification",{"connectorId":1,"status":"Charging","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012313132200000005",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012313132400000007","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T13:13:24.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"213.400000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.400000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.960000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012313132400000007",{}]
[INFO test_Recurrent_cpVoltN.py:52] ********正在充电********稍等约1分钟********
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"883f2f6e-0417-41e0-88e1-1cdf46cba466","RemoteStopTransaction",{"transactionId":1}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012313133400000008","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T13:13:34.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"213.450000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.400000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.960000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012313133400000008",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012313134400000009","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T13:14:05.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"213.140000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.390000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.960000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012313134400000009",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"883f2f6e-0417-41e0-88e1-1cdf46cba466",{"status":"Accepted"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231314220000000F","StopTransaction",{"idTag":"AE0022A1GM9C00066K","transactionId":1,"meterStop":528242,"timestamp":"2022-01-23T13:14:22.000Z","reason":"Remote"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231314220000000F",{"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231313550000000A","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T13:14:35.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231313550000000A",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231314050000000B","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T13:14:35.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231314050000000B",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231314150000000C","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T13:14:36.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231314150000000C",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231314160000000D","StatusNotification",{"connectorId":1,"status":"Preparing","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231314160000000D",{}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"dc716735-a88a-4f81-a2e3-acd688ed3b53","Reset",{"type":"Soft"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"dc716735-a88a-4f81-a2e3-acd688ed3b53",{"status":"Accepted"}]
[ERROR server.py:233] connection handler failed
Traceback (most recent call last):
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 944, in transfer_data
    message = await self.read_message()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1013, in read_message
    frame = await self.read_data_frame(max_size=self.max_size)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1089, in read_data_frame
    frame = await self.read_frame(max_size)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1148, in read_frame
    extensions=self.extensions,
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\framing.py", line 70, in read
    data = await reader(2)
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\streams.py", line 679, in readexactly
    await self._wait_for_data('readexactly')
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\streams.py", line 473, in _wait_for_data
    await self._waiter
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\selector_events.py", line 812, in _read_ready__data_received
    data = self._sock.recv(self.max_size)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\server.py", line 231, in handler
    await self.ws_handler(self)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\server.py", line 1137, in _ws_handler
    )(websocket, websocket.path)
  File "D:\workspace\ocpp_test\server\connect.py", line 156, in on_connect
    await Value.chargePoint.start()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\ocpp\charge_point.py", line 125, in start
    message = await self._connection.recv()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 552, in recv
    await self.ensure_open()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 920, in ensure_open
    raise self.connection_closed_exc()
websockets.exceptions.ConnectionClosedError: no close frame received or sent
[INFO server.py:259] connection closed
[INFO server.py:641] connection open
[INFO connect.py:146] Protocols Matched: ocpp1.6
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012313150000000001","BootNotification",{"chargePointModel":"MaxiChargerAC","chargePointVendor":"Autel","firmwareVersion":"CAQoSPAGNL"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012313150000000001",{"currentTime":"2022-01-23T13:15:01.123Z","interval":10,"status":"Accepted"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012313150100000002","StatusNotification",{"connectorId":0,"status":"Available","errorCode":"NoError"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012313150100000002",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012313150100000003","StatusNotification",{"connectorId":1,"status":"Preparing","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012313150100000003",{}]
[INFO test_Recurrent_cpVoltN.py:69] 稍等5秒，等桩连上后台
[INFO test_Recurrent_cpVoltN.py:31] ========这是第85次开始执行========
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"99920048-7c22-4a5b-8208-5e6efd61ceab","RemoteStartTransaction",{"idTag":"AE0022A1GM9C00066K","connectorId":1,"chargingProfile":{"chargingProfileId":1,"transactionId":1,"stackLevel":1,"chargingProfilePurpose":"ChargePointMaxProfile","chargingProfileKind":"Absolute","recurrencyKind":"Daily","validFrom":"date-time","validTo":"date-time","chargingSchedule":{"duration":10,"startSchedule":"date-time","chargingRateUnit":"W","chargingSchedulePeriod":[{"startPeriod":1,"limit":1.5,"numberPhases":1}],"minChargingRate":1.5}}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"99920048-7c22-4a5b-8208-5e6efd61ceab",{"status":"Accepted"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012313150700000004","Authorize",{"idTag":"AE0022A1GM9C00066K"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012313150700000004",{"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012313151000000005","StatusNotification",{"connectorId":1,"status":"Charging","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012313151000000005",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012313151100000006","StartTransaction",{"connectorId":1,"idTag":"AE0022A1GM9C00066K","meterStart":528242,"timestamp":"2022-01-23T13:15:10.000Z"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012313151100000006",{"transactionId":1,"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012313151200000007","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T13:15:12.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"213.280000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.390000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.960000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012313151200000007",{}]
[INFO test_Recurrent_cpVoltN.py:52] ********正在充电********稍等约1分钟********
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"a9f42409-6212-4d55-b2b6-b5b0880fdc95","RemoteStopTransaction",{"transactionId":1}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012313152200000008","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T13:15:22.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"213.540000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.400000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.960000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012313152200000008",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012313153300000009","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T13:15:53.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"213.270000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.390000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.960000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012313153300000009",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"a9f42409-6212-4d55-b2b6-b5b0880fdc95",{"status":"Accepted"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231316110000000E","StopTransaction",{"idTag":"AE0022A1GM9C00066K","transactionId":1,"meterStop":528242,"timestamp":"2022-01-23T13:16:10.000Z","reason":"Remote"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231316110000000E",{"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231315430000000A","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T13:16:23.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231315430000000A",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231315530000000B","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T13:16:23.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231315530000000B",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231316040000000C","StatusNotification",{"connectorId":1,"status":"Preparing","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231316040000000C",{}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"67a94433-dfbe-4b68-9c03-6a2a280f670e","Reset",{"type":"Soft"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"67a94433-dfbe-4b68-9c03-6a2a280f670e",{"status":"Accepted"}]
[ERROR server.py:233] connection handler failed
Traceback (most recent call last):
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 944, in transfer_data
    message = await self.read_message()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1013, in read_message
    frame = await self.read_data_frame(max_size=self.max_size)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1089, in read_data_frame
    frame = await self.read_frame(max_size)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1148, in read_frame
    extensions=self.extensions,
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\framing.py", line 70, in read
    data = await reader(2)
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\streams.py", line 679, in readexactly
    await self._wait_for_data('readexactly')
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\streams.py", line 473, in _wait_for_data
    await self._waiter
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\selector_events.py", line 812, in _read_ready__data_received
    data = self._sock.recv(self.max_size)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\server.py", line 231, in handler
    await self.ws_handler(self)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\server.py", line 1137, in _ws_handler
    )(websocket, websocket.path)
  File "D:\workspace\ocpp_test\server\connect.py", line 156, in on_connect
    await Value.chargePoint.start()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\ocpp\charge_point.py", line 125, in start
    message = await self._connection.recv()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 552, in recv
    await self.ensure_open()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 920, in ensure_open
    raise self.connection_closed_exc()
websockets.exceptions.ConnectionClosedError: no close frame received or sent
[INFO server.py:259] connection closed
[INFO server.py:641] connection open
[INFO connect.py:146] Protocols Matched: ocpp1.6
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012313164800000001","BootNotification",{"chargePointModel":"MaxiChargerAC","chargePointVendor":"Autel","firmwareVersion":"CAQoSPAGNL"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012313164800000001",{"currentTime":"2022-01-23T13:16:49.123Z","interval":10,"status":"Accepted"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012313164900000002","StatusNotification",{"connectorId":0,"status":"Available","errorCode":"NoError"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012313164900000002",{}]
[INFO test_Recurrent_cpVoltN.py:69] 稍等5秒，等桩连上后台
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012313164900000003","StatusNotification",{"connectorId":1,"status":"Preparing","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012313164900000003",{}]
[INFO test_Recurrent_cpVoltN.py:31] ========这是第86次开始执行========
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"2fd83cb1-2532-477f-848f-554ae68a4f64","RemoteStartTransaction",{"idTag":"AE0022A1GM9C00066K","connectorId":1,"chargingProfile":{"chargingProfileId":1,"transactionId":1,"stackLevel":1,"chargingProfilePurpose":"ChargePointMaxProfile","chargingProfileKind":"Absolute","recurrencyKind":"Daily","validFrom":"date-time","validTo":"date-time","chargingSchedule":{"duration":10,"startSchedule":"date-time","chargingRateUnit":"W","chargingSchedulePeriod":[{"startPeriod":1,"limit":1.5,"numberPhases":1}],"minChargingRate":1.5}}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"2fd83cb1-2532-477f-848f-554ae68a4f64",{"status":"Accepted"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012313165800000004","Authorize",{"idTag":"AE0022A1GM9C00066K"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012313165800000004",{"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012313170000000005","StatusNotification",{"connectorId":1,"status":"Charging","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012313170000000005",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012313170100000006","StartTransaction",{"connectorId":1,"idTag":"AE0022A1GM9C00066K","meterStart":528242,"timestamp":"2022-01-23T13:17:00.000Z"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012313170100000006",{"transactionId":1,"idTagInfo":{"status":"Accepted"}}]
[INFO test_Recurrent_cpVoltN.py:52] ********正在充电********稍等约1分钟********
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"779e8441-d323-4f49-b7de-1941ee98a051","RemoteStopTransaction",{"transactionId":1}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012313170200000007","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T13:17:02.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"213.200000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.390000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.960000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.010000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012313170200000007",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012313171200000008","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T13:17:32.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"213.130000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.390000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.950000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012313171200000008",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"779e8441-d323-4f49-b7de-1941ee98a051",{"status":"Accepted"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231317590000000E","StopTransaction",{"idTag":"AE0022A1GM9C00066K","transactionId":1,"meterStop":528242,"timestamp":"2022-01-23T13:17:58.000Z","reason":"Remote"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231317590000000E",{"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012313172200000009","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T13:18:02.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012313172200000009",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231317330000000A","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T13:18:03.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231317330000000A",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231317430000000B","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T13:18:04.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231317430000000B",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231317510000000C","StatusNotification",{"connectorId":1,"status":"Preparing","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231317510000000C",{}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"e82a323b-5c20-4e10-b1f4-a25b95bb44e4","Reset",{"type":"Soft"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"e82a323b-5c20-4e10-b1f4-a25b95bb44e4",{"status":"Accepted"}]
[ERROR server.py:233] connection handler failed
Traceback (most recent call last):
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 944, in transfer_data
    message = await self.read_message()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1013, in read_message
    frame = await self.read_data_frame(max_size=self.max_size)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1089, in read_data_frame
    frame = await self.read_frame(max_size)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1148, in read_frame
    extensions=self.extensions,
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\framing.py", line 70, in read
    data = await reader(2)
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\streams.py", line 679, in readexactly
    await self._wait_for_data('readexactly')
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\streams.py", line 473, in _wait_for_data
    await self._waiter
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\selector_events.py", line 812, in _read_ready__data_received
    data = self._sock.recv(self.max_size)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\server.py", line 231, in handler
    await self.ws_handler(self)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\server.py", line 1137, in _ws_handler
    )(websocket, websocket.path)
  File "D:\workspace\ocpp_test\server\connect.py", line 156, in on_connect
    await Value.chargePoint.start()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\ocpp\charge_point.py", line 125, in start
    message = await self._connection.recv()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 552, in recv
    await self.ensure_open()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 920, in ensure_open
    raise self.connection_closed_exc()
websockets.exceptions.ConnectionClosedError: no close frame received or sent
[INFO server.py:259] connection closed
[INFO server.py:641] connection open
[INFO connect.py:146] Protocols Matched: ocpp1.6
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012313182900000001","BootNotification",{"chargePointModel":"MaxiChargerAC","chargePointVendor":"Autel","firmwareVersion":"CAQoSPAGNL"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012313182900000001",{"currentTime":"2022-01-23T13:18:30.123Z","interval":10,"status":"Accepted"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012313183000000002","StatusNotification",{"connectorId":0,"status":"Available","errorCode":"NoError"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012313183000000002",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012313183000000003","StatusNotification",{"connectorId":1,"status":"Preparing","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012313183000000003",{}]
[INFO test_Recurrent_cpVoltN.py:69] 稍等5秒，等桩连上后台
[INFO test_Recurrent_cpVoltN.py:31] ========这是第87次开始执行========
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"f6ec85f8-312c-49d4-8905-860a45f1cf81","RemoteStartTransaction",{"idTag":"AE0022A1GM9C00066K","connectorId":1,"chargingProfile":{"chargingProfileId":1,"transactionId":1,"stackLevel":1,"chargingProfilePurpose":"ChargePointMaxProfile","chargingProfileKind":"Absolute","recurrencyKind":"Daily","validFrom":"date-time","validTo":"date-time","chargingSchedule":{"duration":10,"startSchedule":"date-time","chargingRateUnit":"W","chargingSchedulePeriod":[{"startPeriod":1,"limit":1.5,"numberPhases":1}],"minChargingRate":1.5}}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"f6ec85f8-312c-49d4-8905-860a45f1cf81",{"status":"Accepted"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012313183600000004","Authorize",{"idTag":"AE0022A1GM9C00066K"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012313183600000004",{"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012313183900000005","StatusNotification",{"connectorId":1,"status":"Charging","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012313183900000005",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012313183900000006","StartTransaction",{"connectorId":1,"idTag":"AE0022A1GM9C00066K","meterStart":528242,"timestamp":"2022-01-23T13:18:39.000Z"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012313183900000006",{"transactionId":1,"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012313184100000007","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T13:18:41.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"213.200000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.380000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.950000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012313184100000007",{}]
[INFO test_Recurrent_cpVoltN.py:52] ********正在充电********稍等约1分钟********
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"f331a6bd-af6a-47f4-90fc-4e80a0b6fdd5","RemoteStopTransaction",{"transactionId":1}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012313185100000008","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T13:18:51.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"213.010000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.380000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.950000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.010000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012313185100000008",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012313190100000009","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T13:19:21.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"213.250000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.390000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.950000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012313190100000009",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"f331a6bd-af6a-47f4-90fc-4e80a0b6fdd5",{"status":"Accepted"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231319400000000F","StopTransaction",{"idTag":"AE0022A1GM9C00066K","transactionId":1,"meterStop":528242,"timestamp":"2022-01-23T13:19:39.000Z","reason":"Remote"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231319400000000F",{"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231319110000000A","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T13:19:52.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231319110000000A",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231319220000000B","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T13:19:52.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.010000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231319220000000B",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231319320000000C","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T13:19:53.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.010000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231319320000000C",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231319320000000D","StatusNotification",{"connectorId":1,"status":"Preparing","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231319320000000D",{}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"6e5b683c-f015-4544-b3ef-083a12672a60","Reset",{"type":"Soft"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"6e5b683c-f015-4544-b3ef-083a12672a60",{"status":"Accepted"}]
[ERROR server.py:233] connection handler failed
Traceback (most recent call last):
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 944, in transfer_data
    message = await self.read_message()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1013, in read_message
    frame = await self.read_data_frame(max_size=self.max_size)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1089, in read_data_frame
    frame = await self.read_frame(max_size)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1148, in read_frame
    extensions=self.extensions,
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\framing.py", line 70, in read
    data = await reader(2)
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\streams.py", line 679, in readexactly
    await self._wait_for_data('readexactly')
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\streams.py", line 473, in _wait_for_data
    await self._waiter
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\selector_events.py", line 812, in _read_ready__data_received
    data = self._sock.recv(self.max_size)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\server.py", line 231, in handler
    await self.ws_handler(self)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\server.py", line 1137, in _ws_handler
    )(websocket, websocket.path)
  File "D:\workspace\ocpp_test\server\connect.py", line 156, in on_connect
    await Value.chargePoint.start()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\ocpp\charge_point.py", line 125, in start
    message = await self._connection.recv()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 552, in recv
    await self.ensure_open()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 920, in ensure_open
    raise self.connection_closed_exc()
websockets.exceptions.ConnectionClosedError: no close frame received or sent
[INFO server.py:259] connection closed
[INFO server.py:641] connection open
[INFO connect.py:146] Protocols Matched: ocpp1.6
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012313200900000001","BootNotification",{"chargePointModel":"MaxiChargerAC","chargePointVendor":"Autel","firmwareVersion":"CAQoSPAGNL"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012313200900000001",{"currentTime":"2022-01-23T13:20:10.123Z","interval":10,"status":"Accepted"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012313201000000002","StatusNotification",{"connectorId":0,"status":"Available","errorCode":"NoError"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012313201000000002",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012313201000000003","StatusNotification",{"connectorId":1,"status":"Preparing","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012313201000000003",{}]
[INFO test_Recurrent_cpVoltN.py:69] 稍等5秒，等桩连上后台
[INFO test_Recurrent_cpVoltN.py:31] ========这是第88次开始执行========
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"b22fb335-9014-4c03-934f-d28cfa963614","RemoteStartTransaction",{"idTag":"AE0022A1GM9C00066K","connectorId":1,"chargingProfile":{"chargingProfileId":1,"transactionId":1,"stackLevel":1,"chargingProfilePurpose":"ChargePointMaxProfile","chargingProfileKind":"Absolute","recurrencyKind":"Daily","validFrom":"date-time","validTo":"date-time","chargingSchedule":{"duration":10,"startSchedule":"date-time","chargingRateUnit":"W","chargingSchedulePeriod":[{"startPeriod":1,"limit":1.5,"numberPhases":1}],"minChargingRate":1.5}}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"b22fb335-9014-4c03-934f-d28cfa963614",{"status":"Accepted"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012313201700000004","Authorize",{"idTag":"AE0022A1GM9C00066K"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012313201700000004",{"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012313202000000005","StatusNotification",{"connectorId":1,"status":"Charging","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012313202000000005",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012313202100000006","StartTransaction",{"connectorId":1,"idTag":"AE0022A1GM9C00066K","meterStart":528242,"timestamp":"2022-01-23T13:20:20.000Z"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012313202100000006",{"transactionId":1,"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012313202200000007","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T13:20:22.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"213.590000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.400000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.950000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012313202200000007",{}]
[INFO test_Recurrent_cpVoltN.py:52] ********正在充电********稍等约1分钟********
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"f90d2f70-4b68-467c-8252-acac32d871e7","RemoteStopTransaction",{"transactionId":1}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012313203200000008","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T13:20:32.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"213.540000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.400000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.950000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012313203200000008",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012313204200000009","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T13:21:03.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"213.440000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.390000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.960000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012313204200000009",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"f90d2f70-4b68-467c-8252-acac32d871e7",{"status":"Accepted"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231321210000000F","StopTransaction",{"idTag":"AE0022A1GM9C00066K","transactionId":1,"meterStop":528242,"timestamp":"2022-01-23T13:21:20.000Z","reason":"Remote"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231321210000000F",{"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231320530000000A","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T13:21:33.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231320530000000A",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231321030000000B","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T13:21:33.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231321030000000B",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231321130000000C","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T13:21:34.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231321130000000C",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231321140000000D","StatusNotification",{"connectorId":1,"status":"Preparing","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231321140000000D",{}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"47c76a2a-290c-4a38-9e9a-ebba01b25d8f","Reset",{"type":"Soft"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"47c76a2a-290c-4a38-9e9a-ebba01b25d8f",{"status":"Accepted"}]
[ERROR server.py:233] connection handler failed
Traceback (most recent call last):
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 944, in transfer_data
    message = await self.read_message()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1013, in read_message
    frame = await self.read_data_frame(max_size=self.max_size)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1089, in read_data_frame
    frame = await self.read_frame(max_size)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1148, in read_frame
    extensions=self.extensions,
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\framing.py", line 70, in read
    data = await reader(2)
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\streams.py", line 679, in readexactly
    await self._wait_for_data('readexactly')
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\streams.py", line 473, in _wait_for_data
    await self._waiter
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\selector_events.py", line 812, in _read_ready__data_received
    data = self._sock.recv(self.max_size)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\server.py", line 231, in handler
    await self.ws_handler(self)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\server.py", line 1137, in _ws_handler
    )(websocket, websocket.path)
  File "D:\workspace\ocpp_test\server\connect.py", line 156, in on_connect
    await Value.chargePoint.start()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\ocpp\charge_point.py", line 125, in start
    message = await self._connection.recv()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 552, in recv
    await self.ensure_open()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 920, in ensure_open
    raise self.connection_closed_exc()
websockets.exceptions.ConnectionClosedError: no close frame received or sent
[INFO server.py:259] connection closed
[INFO server.py:641] connection open
[INFO connect.py:146] Protocols Matched: ocpp1.6
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012313215100000001","BootNotification",{"chargePointModel":"MaxiChargerAC","chargePointVendor":"Autel","firmwareVersion":"CAQoSPAGNL"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012313215100000001",{"currentTime":"2022-01-23T13:21:52.123Z","interval":10,"status":"Accepted"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012313215200000002","StatusNotification",{"connectorId":0,"status":"Available","errorCode":"NoError"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012313215200000002",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012313215200000003","StatusNotification",{"connectorId":1,"status":"Preparing","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012313215200000003",{}]
[INFO test_Recurrent_cpVoltN.py:69] 稍等5秒，等桩连上后台
[INFO test_Recurrent_cpVoltN.py:31] ========这是第89次开始执行========
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"8f4e215b-254b-4897-aa44-03b03feab67a","RemoteStartTransaction",{"idTag":"AE0022A1GM9C00066K","connectorId":1,"chargingProfile":{"chargingProfileId":1,"transactionId":1,"stackLevel":1,"chargingProfilePurpose":"ChargePointMaxProfile","chargingProfileKind":"Absolute","recurrencyKind":"Daily","validFrom":"date-time","validTo":"date-time","chargingSchedule":{"duration":10,"startSchedule":"date-time","chargingRateUnit":"W","chargingSchedulePeriod":[{"startPeriod":1,"limit":1.5,"numberPhases":1}],"minChargingRate":1.5}}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"8f4e215b-254b-4897-aa44-03b03feab67a",{"status":"Accepted"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012313215900000004","Authorize",{"idTag":"AE0022A1GM9C00066K"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012313215900000004",{"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012313220100000005","StatusNotification",{"connectorId":1,"status":"Charging","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012313220100000005",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012313220200000006","StartTransaction",{"connectorId":1,"idTag":"AE0022A1GM9C00066K","meterStart":528242,"timestamp":"2022-01-23T13:22:00.000Z"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012313220200000006",{"transactionId":1,"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012313220300000007","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T13:22:03.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"213.520000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.400000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.950000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012313220300000007",{}]
[INFO test_Recurrent_cpVoltN.py:52] ********正在充电********稍等约1分钟********
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"5c168999-2ee7-4a45-8047-b809404f199b","RemoteStopTransaction",{"transactionId":1}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012313221400000008","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T13:22:14.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"213.570000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.400000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.960000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012313221400000008",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012313222400000009","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T13:22:44.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"213.310000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.400000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.960000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012313222400000009",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"5c168999-2ee7-4a45-8047-b809404f199b",{"status":"Accepted"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231323030000000F","StopTransaction",{"idTag":"AE0022A1GM9C00066K","transactionId":1,"meterStop":528242,"timestamp":"2022-01-23T13:23:02.000Z","reason":"Remote"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231323030000000F",{"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231322340000000A","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T13:23:14.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231322340000000A",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231322450000000B","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T13:23:15.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231322450000000B",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231322550000000C","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T13:23:15.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231322550000000C",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231322550000000D","StatusNotification",{"connectorId":1,"status":"Preparing","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231322550000000D",{}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"e409448f-4d2b-4728-9e88-fc61ae1fcc66","Reset",{"type":"Soft"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"e409448f-4d2b-4728-9e88-fc61ae1fcc66",{"status":"Accepted"}]
[ERROR server.py:233] connection handler failed
Traceback (most recent call last):
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 944, in transfer_data
    message = await self.read_message()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1013, in read_message
    frame = await self.read_data_frame(max_size=self.max_size)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1089, in read_data_frame
    frame = await self.read_frame(max_size)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1148, in read_frame
    extensions=self.extensions,
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\framing.py", line 70, in read
    data = await reader(2)
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\streams.py", line 679, in readexactly
    await self._wait_for_data('readexactly')
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\streams.py", line 473, in _wait_for_data
    await self._waiter
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\selector_events.py", line 812, in _read_ready__data_received
    data = self._sock.recv(self.max_size)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\server.py", line 231, in handler
    await self.ws_handler(self)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\server.py", line 1137, in _ws_handler
    )(websocket, websocket.path)
  File "D:\workspace\ocpp_test\server\connect.py", line 156, in on_connect
    await Value.chargePoint.start()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\ocpp\charge_point.py", line 125, in start
    message = await self._connection.recv()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 552, in recv
    await self.ensure_open()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 920, in ensure_open
    raise self.connection_closed_exc()
websockets.exceptions.ConnectionClosedError: no close frame received or sent
[INFO server.py:259] connection closed
[INFO server.py:641] connection open
[INFO connect.py:146] Protocols Matched: ocpp1.6
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012313234000000001","BootNotification",{"chargePointModel":"MaxiChargerAC","chargePointVendor":"Autel","firmwareVersion":"CAQoSPAGNL"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012313234000000001",{"currentTime":"2022-01-23T13:23:40.123Z","interval":10,"status":"Accepted"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012313234000000002","StatusNotification",{"connectorId":0,"status":"Available","errorCode":"NoError"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012313234000000002",{}]
[INFO test_Recurrent_cpVoltN.py:69] 稍等5秒，等桩连上后台
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012313234000000003","StatusNotification",{"connectorId":1,"status":"Preparing","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012313234000000003",{}]
[INFO test_Recurrent_cpVoltN.py:31] ========这是第90次开始执行========
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"a42f2f4a-f385-4816-b718-46c687e66802","RemoteStartTransaction",{"idTag":"AE0022A1GM9C00066K","connectorId":1,"chargingProfile":{"chargingProfileId":1,"transactionId":1,"stackLevel":1,"chargingProfilePurpose":"ChargePointMaxProfile","chargingProfileKind":"Absolute","recurrencyKind":"Daily","validFrom":"date-time","validTo":"date-time","chargingSchedule":{"duration":10,"startSchedule":"date-time","chargingRateUnit":"W","chargingSchedulePeriod":[{"startPeriod":1,"limit":1.5,"numberPhases":1}],"minChargingRate":1.5}}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"a42f2f4a-f385-4816-b718-46c687e66802",{"status":"Accepted"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012313234900000004","Authorize",{"idTag":"AE0022A1GM9C00066K"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012313234900000004",{"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012313235100000005","StatusNotification",{"connectorId":1,"status":"Charging","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012313235100000005",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012313235200000006","StartTransaction",{"connectorId":1,"idTag":"AE0022A1GM9C00066K","meterStart":528242,"timestamp":"2022-01-23T13:23:51.000Z"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012313235200000006",{"transactionId":1,"idTagInfo":{"status":"Accepted"}}]
[INFO test_Recurrent_cpVoltN.py:52] ********正在充电********稍等约1分钟********
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"b55f6879-3457-473c-8bca-2f0dd0f45ba8","RemoteStopTransaction",{"transactionId":1}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012313235300000007","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T13:23:53.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"213.770000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.420000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.960000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012313235300000007",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012313240400000008","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T13:24:23.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"213.860000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.420000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.960000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012313240400000008",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"b55f6879-3457-473c-8bca-2f0dd0f45ba8",{"status":"Accepted"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231324500000000E","StopTransaction",{"idTag":"AE0022A1GM9C00066K","transactionId":1,"meterStop":528242,"timestamp":"2022-01-23T13:24:49.000Z","reason":"Remote"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231324500000000E",{"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012313241400000009","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T13:24:54.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012313241400000009",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231324240000000A","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T13:24:55.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.010000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231324240000000A",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231324340000000B","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T13:24:55.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.010000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231324340000000B",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231324430000000C","StatusNotification",{"connectorId":1,"status":"Preparing","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231324430000000C",{}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"4c97c73c-6e89-42fe-86f7-2ef096a16c6a","Reset",{"type":"Soft"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"4c97c73c-6e89-42fe-86f7-2ef096a16c6a",{"status":"Accepted"}]
[ERROR server.py:233] connection handler failed
Traceback (most recent call last):
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 944, in transfer_data
    message = await self.read_message()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1013, in read_message
    frame = await self.read_data_frame(max_size=self.max_size)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1089, in read_data_frame
    frame = await self.read_frame(max_size)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1148, in read_frame
    extensions=self.extensions,
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\framing.py", line 70, in read
    data = await reader(2)
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\streams.py", line 679, in readexactly
    await self._wait_for_data('readexactly')
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\streams.py", line 473, in _wait_for_data
    await self._waiter
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\selector_events.py", line 812, in _read_ready__data_received
    data = self._sock.recv(self.max_size)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\server.py", line 231, in handler
    await self.ws_handler(self)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\server.py", line 1137, in _ws_handler
    )(websocket, websocket.path)
  File "D:\workspace\ocpp_test\server\connect.py", line 156, in on_connect
    await Value.chargePoint.start()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\ocpp\charge_point.py", line 125, in start
    message = await self._connection.recv()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 552, in recv
    await self.ensure_open()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 920, in ensure_open
    raise self.connection_closed_exc()
websockets.exceptions.ConnectionClosedError: no close frame received or sent
[INFO server.py:259] connection closed
[INFO server.py:641] connection open
[INFO connect.py:146] Protocols Matched: ocpp1.6
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012313251300000001","BootNotification",{"chargePointModel":"MaxiChargerAC","chargePointVendor":"Autel","firmwareVersion":"CAQoSPAGNL"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012313251300000001",{"currentTime":"2022-01-23T13:25:14.123Z","interval":10,"status":"Accepted"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012313251400000002","StatusNotification",{"connectorId":0,"status":"Available","errorCode":"NoError"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012313251400000002",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012313251400000003","StatusNotification",{"connectorId":1,"status":"Preparing","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012313251400000003",{}]
[INFO test_Recurrent_cpVoltN.py:69] 稍等5秒，等桩连上后台
[INFO test_Recurrent_cpVoltN.py:31] ========这是第91次开始执行========
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"16318b6d-9255-49d4-a2fa-a05af8a6a41b","RemoteStartTransaction",{"idTag":"AE0022A1GM9C00066K","connectorId":1,"chargingProfile":{"chargingProfileId":1,"transactionId":1,"stackLevel":1,"chargingProfilePurpose":"ChargePointMaxProfile","chargingProfileKind":"Absolute","recurrencyKind":"Daily","validFrom":"date-time","validTo":"date-time","chargingSchedule":{"duration":10,"startSchedule":"date-time","chargingRateUnit":"W","chargingSchedulePeriod":[{"startPeriod":1,"limit":1.5,"numberPhases":1}],"minChargingRate":1.5}}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"16318b6d-9255-49d4-a2fa-a05af8a6a41b",{"status":"Accepted"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012313252100000004","Authorize",{"idTag":"AE0022A1GM9C00066K"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012313252100000004",{"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012313252400000005","StatusNotification",{"connectorId":1,"status":"Charging","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012313252400000005",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012313252500000006","StartTransaction",{"connectorId":1,"idTag":"AE0022A1GM9C00066K","meterStart":528242,"timestamp":"2022-01-23T13:25:24.000Z"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012313252500000006",{"transactionId":1,"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012313252600000007","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T13:25:26.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"213.470000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.390000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.960000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012313252600000007",{}]
[INFO test_Recurrent_cpVoltN.py:52] ********正在充电********稍等约1分钟********
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"5d77b7a1-2cbc-4799-ad99-bf7df35d89bf","RemoteStopTransaction",{"transactionId":1}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012313253700000008","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T13:25:37.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"213.520000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.400000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.960000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012313253700000008",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012313254700000009","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T13:26:07.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"213.620000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.400000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.960000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012313254700000009",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"5d77b7a1-2cbc-4799-ad99-bf7df35d89bf",{"status":"Accepted"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231326250000000E","StopTransaction",{"idTag":"AE0022A1GM9C00066K","transactionId":1,"meterStop":528242,"timestamp":"2022-01-23T13:26:24.000Z","reason":"Remote"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231326250000000E",{"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231325570000000A","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T13:26:37.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231325570000000A",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231326070000000B","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T13:26:38.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231326070000000B",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231326180000000C","StatusNotification",{"connectorId":1,"status":"Preparing","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231326180000000C",{}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"92f4e1c0-fdb7-41d2-9d7d-c23d1af0774d","Reset",{"type":"Soft"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"92f4e1c0-fdb7-41d2-9d7d-c23d1af0774d",{"status":"Accepted"}]
[ERROR server.py:233] connection handler failed
Traceback (most recent call last):
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 944, in transfer_data
    message = await self.read_message()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1013, in read_message
    frame = await self.read_data_frame(max_size=self.max_size)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1089, in read_data_frame
    frame = await self.read_frame(max_size)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1148, in read_frame
    extensions=self.extensions,
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\framing.py", line 70, in read
    data = await reader(2)
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\streams.py", line 679, in readexactly
    await self._wait_for_data('readexactly')
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\streams.py", line 473, in _wait_for_data
    await self._waiter
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\selector_events.py", line 812, in _read_ready__data_received
    data = self._sock.recv(self.max_size)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\server.py", line 231, in handler
    await self.ws_handler(self)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\server.py", line 1137, in _ws_handler
    )(websocket, websocket.path)
  File "D:\workspace\ocpp_test\server\connect.py", line 156, in on_connect
    await Value.chargePoint.start()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\ocpp\charge_point.py", line 125, in start
    message = await self._connection.recv()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 552, in recv
    await self.ensure_open()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 920, in ensure_open
    raise self.connection_closed_exc()
websockets.exceptions.ConnectionClosedError: no close frame received or sent
[INFO server.py:259] connection closed
[INFO server.py:641] connection open
[INFO connect.py:146] Protocols Matched: ocpp1.6
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012313270200000001","BootNotification",{"chargePointModel":"MaxiChargerAC","chargePointVendor":"Autel","firmwareVersion":"CAQoSPAGNL"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012313270200000001",{"currentTime":"2022-01-23T13:27:03.123Z","interval":10,"status":"Accepted"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012313270300000002","StatusNotification",{"connectorId":0,"status":"Available","errorCode":"NoError"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012313270300000002",{}]
[INFO test_Recurrent_cpVoltN.py:69] 稍等5秒，等桩连上后台
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012313270300000003","StatusNotification",{"connectorId":1,"status":"Preparing","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012313270300000003",{}]
[INFO test_Recurrent_cpVoltN.py:31] ========这是第92次开始执行========
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"aff82ccb-ac53-4ded-af28-8612a11455c4","RemoteStartTransaction",{"idTag":"AE0022A1GM9C00066K","connectorId":1,"chargingProfile":{"chargingProfileId":1,"transactionId":1,"stackLevel":1,"chargingProfilePurpose":"ChargePointMaxProfile","chargingProfileKind":"Absolute","recurrencyKind":"Daily","validFrom":"date-time","validTo":"date-time","chargingSchedule":{"duration":10,"startSchedule":"date-time","chargingRateUnit":"W","chargingSchedulePeriod":[{"startPeriod":1,"limit":1.5,"numberPhases":1}],"minChargingRate":1.5}}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"aff82ccb-ac53-4ded-af28-8612a11455c4",{"status":"Accepted"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012313271200000004","Authorize",{"idTag":"AE0022A1GM9C00066K"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012313271200000004",{"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012313271400000005","StatusNotification",{"connectorId":1,"status":"Charging","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012313271400000005",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012313271500000006","StartTransaction",{"connectorId":1,"idTag":"AE0022A1GM9C00066K","meterStart":528242,"timestamp":"2022-01-23T13:27:14.000Z"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012313271500000006",{"transactionId":1,"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012313271600000007","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T13:27:16.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"213.710000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.410000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.960000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012313271600000007",{}]
[INFO test_Recurrent_cpVoltN.py:52] ********正在充电********稍等约1分钟********
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"f3a8ba75-5419-4487-b7a4-ff0f8348fb8c","RemoteStopTransaction",{"transactionId":1}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012313272600000008","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T13:27:26.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"213.910000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.420000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.960000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012313272600000008",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012313273700000009","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T13:27:57.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"213.660000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.400000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.960000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012313273700000009",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"f3a8ba75-5419-4487-b7a4-ff0f8348fb8c",{"status":"Accepted"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231328160000000F","StopTransaction",{"idTag":"AE0022A1GM9C00066K","transactionId":1,"meterStop":528242,"timestamp":"2022-01-23T13:28:15.000Z","reason":"Remote"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231328160000000F",{"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231327470000000A","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T13:28:27.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231327470000000A",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231327570000000B","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T13:28:27.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231327570000000B",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231328070000000C","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T13:28:28.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231328070000000C",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231328080000000D","StatusNotification",{"connectorId":1,"status":"Preparing","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231328080000000D",{}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"2a6b3cef-744f-4da9-8438-26fde5fb3320","Reset",{"type":"Soft"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"2a6b3cef-744f-4da9-8438-26fde5fb3320",{"status":"Accepted"}]
[ERROR server.py:233] connection handler failed
Traceback (most recent call last):
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 944, in transfer_data
    message = await self.read_message()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1013, in read_message
    frame = await self.read_data_frame(max_size=self.max_size)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1089, in read_data_frame
    frame = await self.read_frame(max_size)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1148, in read_frame
    extensions=self.extensions,
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\framing.py", line 70, in read
    data = await reader(2)
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\streams.py", line 679, in readexactly
    await self._wait_for_data('readexactly')
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\streams.py", line 473, in _wait_for_data
    await self._waiter
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\selector_events.py", line 812, in _read_ready__data_received
    data = self._sock.recv(self.max_size)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\server.py", line 231, in handler
    await self.ws_handler(self)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\server.py", line 1137, in _ws_handler
    )(websocket, websocket.path)
  File "D:\workspace\ocpp_test\server\connect.py", line 156, in on_connect
    await Value.chargePoint.start()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\ocpp\charge_point.py", line 125, in start
    message = await self._connection.recv()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 552, in recv
    await self.ensure_open()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 920, in ensure_open
    raise self.connection_closed_exc()
websockets.exceptions.ConnectionClosedError: no close frame received or sent
[INFO server.py:259] connection closed
[INFO server.py:641] connection open
[INFO connect.py:146] Protocols Matched: ocpp1.6
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012313285200000001","BootNotification",{"chargePointModel":"MaxiChargerAC","chargePointVendor":"Autel","firmwareVersion":"CAQoSPAGNL"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012313285200000001",{"currentTime":"2022-01-23T13:28:54.123Z","interval":10,"status":"Accepted"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012313285400000002","StatusNotification",{"connectorId":0,"status":"Available","errorCode":"NoError"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012313285400000002",{}]
[INFO test_Recurrent_cpVoltN.py:69] 稍等5秒，等桩连上后台
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012313285400000003","StatusNotification",{"connectorId":1,"status":"Preparing","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012313285400000003",{}]
[INFO test_Recurrent_cpVoltN.py:31] ========这是第93次开始执行========
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"436c4990-3715-441e-acba-46913411cd2c","RemoteStartTransaction",{"idTag":"AE0022A1GM9C00066K","connectorId":1,"chargingProfile":{"chargingProfileId":1,"transactionId":1,"stackLevel":1,"chargingProfilePurpose":"ChargePointMaxProfile","chargingProfileKind":"Absolute","recurrencyKind":"Daily","validFrom":"date-time","validTo":"date-time","chargingSchedule":{"duration":10,"startSchedule":"date-time","chargingRateUnit":"W","chargingSchedulePeriod":[{"startPeriod":1,"limit":1.5,"numberPhases":1}],"minChargingRate":1.5}}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"436c4990-3715-441e-acba-46913411cd2c",{"status":"Accepted"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012313290300000004","Authorize",{"idTag":"AE0022A1GM9C00066K"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012313290300000004",{"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012313290500000005","StatusNotification",{"connectorId":1,"status":"Charging","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012313290500000005",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012313290600000006","StartTransaction",{"connectorId":1,"idTag":"AE0022A1GM9C00066K","meterStart":528242,"timestamp":"2022-01-23T13:29:05.000Z"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012313290600000006",{"transactionId":1,"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012313290700000007","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T13:29:07.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"213.560000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.400000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.960000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012313290700000007",{}]
[INFO test_Recurrent_cpVoltN.py:52] ********正在充电********稍等约1分钟********
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"de9064c3-52d1-411c-bf56-27e96bf8191b","RemoteStopTransaction",{"transactionId":1}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012313291800000008","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T13:29:18.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"213.770000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.410000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.960000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012313291800000008",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012313292800000009","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T13:29:48.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"213.980000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.420000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.960000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012313292800000009",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"de9064c3-52d1-411c-bf56-27e96bf8191b",{"status":"Accepted"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231330070000000F","StopTransaction",{"idTag":"AE0022A1GM9C00066K","transactionId":1,"meterStop":528242,"timestamp":"2022-01-23T13:30:06.000Z","reason":"Remote"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231330070000000F",{"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231329380000000A","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T13:30:18.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231329380000000A",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231329490000000B","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T13:30:19.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231329490000000B",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231329590000000C","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T13:30:19.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231329590000000C",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231330000000000D","StatusNotification",{"connectorId":1,"status":"Preparing","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231330000000000D",{}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"b0217af1-cc1d-466d-8369-f261abd20c36","Reset",{"type":"Soft"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"b0217af1-cc1d-466d-8369-f261abd20c36",{"status":"Accepted"}]
[ERROR server.py:233] connection handler failed
Traceback (most recent call last):
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 944, in transfer_data
    message = await self.read_message()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1013, in read_message
    frame = await self.read_data_frame(max_size=self.max_size)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1089, in read_data_frame
    frame = await self.read_frame(max_size)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1148, in read_frame
    extensions=self.extensions,
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\framing.py", line 70, in read
    data = await reader(2)
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\streams.py", line 679, in readexactly
    await self._wait_for_data('readexactly')
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\streams.py", line 473, in _wait_for_data
    await self._waiter
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\selector_events.py", line 812, in _read_ready__data_received
    data = self._sock.recv(self.max_size)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\server.py", line 231, in handler
    await self.ws_handler(self)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\server.py", line 1137, in _ws_handler
    )(websocket, websocket.path)
  File "D:\workspace\ocpp_test\server\connect.py", line 156, in on_connect
    await Value.chargePoint.start()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\ocpp\charge_point.py", line 125, in start
    message = await self._connection.recv()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 552, in recv
    await self.ensure_open()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 920, in ensure_open
    raise self.connection_closed_exc()
websockets.exceptions.ConnectionClosedError: no close frame received or sent
[INFO server.py:259] connection closed
[INFO server.py:641] connection open
[INFO connect.py:146] Protocols Matched: ocpp1.6
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012313304400000001","BootNotification",{"chargePointModel":"MaxiChargerAC","chargePointVendor":"Autel","firmwareVersion":"CAQoSPAGNL"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012313304400000001",{"currentTime":"2022-01-23T13:30:45.123Z","interval":10,"status":"Accepted"}]
[INFO test_Recurrent_cpVoltN.py:69] 稍等5秒，等桩连上后台
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012313304500000002","StatusNotification",{"connectorId":0,"status":"Available","errorCode":"NoError"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012313304500000002",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012313304500000003","StatusNotification",{"connectorId":1,"status":"Preparing","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012313304500000003",{}]
[INFO test_Recurrent_cpVoltN.py:31] ========这是第94次开始执行========
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"c709f927-f0ac-4cae-aa93-fba9145e8b37","RemoteStartTransaction",{"idTag":"AE0022A1GM9C00066K","connectorId":1,"chargingProfile":{"chargingProfileId":1,"transactionId":1,"stackLevel":1,"chargingProfilePurpose":"ChargePointMaxProfile","chargingProfileKind":"Absolute","recurrencyKind":"Daily","validFrom":"date-time","validTo":"date-time","chargingSchedule":{"duration":10,"startSchedule":"date-time","chargingRateUnit":"W","chargingSchedulePeriod":[{"startPeriod":1,"limit":1.5,"numberPhases":1}],"minChargingRate":1.5}}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"c709f927-f0ac-4cae-aa93-fba9145e8b37",{"status":"Accepted"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012313305300000004","Authorize",{"idTag":"AE0022A1GM9C00066K"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012313305300000004",{"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012313305600000005","StatusNotification",{"connectorId":1,"status":"Charging","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012313305600000005",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012313305700000006","StartTransaction",{"connectorId":1,"idTag":"AE0022A1GM9C00066K","meterStart":528242,"timestamp":"2022-01-23T13:30:56.000Z"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012313305700000006",{"transactionId":1,"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012313305800000007","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T13:30:58.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"213.640000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.400000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.960000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012313305800000007",{}]
[INFO test_Recurrent_cpVoltN.py:52] ********正在充电********稍等约1分钟********
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"256d4ad1-5136-401b-ae7f-ee6bc52cb915","RemoteStopTransaction",{"transactionId":1}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012313310900000008","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T13:31:09.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"213.470000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.390000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.950000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.010000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012313310900000008",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012313311900000009","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T13:31:39.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"213.710000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.400000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.950000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012313311900000009",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"256d4ad1-5136-401b-ae7f-ee6bc52cb915",{"status":"Accepted"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231331570000000E","StopTransaction",{"idTag":"AE0022A1GM9C00066K","transactionId":1,"meterStop":528242,"timestamp":"2022-01-23T13:31:56.000Z","reason":"Remote"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231331570000000E",{"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231331290000000A","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T13:32:09.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231331290000000A",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231331390000000B","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T13:32:10.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231331390000000B",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231331500000000C","StatusNotification",{"connectorId":1,"status":"Preparing","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231331500000000C",{}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"028da152-073a-42b3-aeb8-c76fe9de42d8","Reset",{"type":"Soft"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"028da152-073a-42b3-aeb8-c76fe9de42d8",{"status":"Accepted"}]
[ERROR server.py:233] connection handler failed
Traceback (most recent call last):
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 944, in transfer_data
    message = await self.read_message()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1013, in read_message
    frame = await self.read_data_frame(max_size=self.max_size)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1089, in read_data_frame
    frame = await self.read_frame(max_size)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1148, in read_frame
    extensions=self.extensions,
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\framing.py", line 70, in read
    data = await reader(2)
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\streams.py", line 679, in readexactly
    await self._wait_for_data('readexactly')
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\streams.py", line 473, in _wait_for_data
    await self._waiter
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\selector_events.py", line 812, in _read_ready__data_received
    data = self._sock.recv(self.max_size)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\server.py", line 231, in handler
    await self.ws_handler(self)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\server.py", line 1137, in _ws_handler
    )(websocket, websocket.path)
  File "D:\workspace\ocpp_test\server\connect.py", line 156, in on_connect
    await Value.chargePoint.start()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\ocpp\charge_point.py", line 125, in start
    message = await self._connection.recv()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 552, in recv
    await self.ensure_open()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 920, in ensure_open
    raise self.connection_closed_exc()
websockets.exceptions.ConnectionClosedError: no close frame received or sent
[INFO server.py:259] connection closed
[INFO server.py:641] connection open
[INFO connect.py:146] Protocols Matched: ocpp1.6
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012313323400000001","BootNotification",{"chargePointModel":"MaxiChargerAC","chargePointVendor":"Autel","firmwareVersion":"CAQoSPAGNL"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012313323400000001",{"currentTime":"2022-01-23T13:32:34.123Z","interval":10,"status":"Accepted"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012313323400000002","StatusNotification",{"connectorId":0,"status":"Available","errorCode":"NoError"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012313323400000002",{}]
[INFO test_Recurrent_cpVoltN.py:69] 稍等5秒，等桩连上后台
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012313323400000003","StatusNotification",{"connectorId":1,"status":"Preparing","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012313323400000003",{}]
[INFO test_Recurrent_cpVoltN.py:31] ========这是第95次开始执行========
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"b07acc31-e7db-44bc-9e32-49978ce24353","RemoteStartTransaction",{"idTag":"AE0022A1GM9C00066K","connectorId":1,"chargingProfile":{"chargingProfileId":1,"transactionId":1,"stackLevel":1,"chargingProfilePurpose":"ChargePointMaxProfile","chargingProfileKind":"Absolute","recurrencyKind":"Daily","validFrom":"date-time","validTo":"date-time","chargingSchedule":{"duration":10,"startSchedule":"date-time","chargingRateUnit":"W","chargingSchedulePeriod":[{"startPeriod":1,"limit":1.5,"numberPhases":1}],"minChargingRate":1.5}}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"b07acc31-e7db-44bc-9e32-49978ce24353",{"status":"Accepted"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012313324300000004","Authorize",{"idTag":"AE0022A1GM9C00066K"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012313324300000004",{"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012313324500000005","StatusNotification",{"connectorId":1,"status":"Charging","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012313324500000005",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012313324600000006","StartTransaction",{"connectorId":1,"idTag":"AE0022A1GM9C00066K","meterStart":528242,"timestamp":"2022-01-23T13:32:45.000Z"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012313324600000006",{"transactionId":1,"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012313324700000007","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T13:32:47.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"214.090000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.430000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.960000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012313324700000007",{}]
[INFO test_Recurrent_cpVoltN.py:52] ********正在充电********稍等约1分钟********
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"33f740b3-c553-462f-af7f-aa1b1875a45a","RemoteStopTransaction",{"transactionId":1}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012313325700000008","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T13:32:58.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"214.040000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.420000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.960000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012313325700000008",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012313330800000009","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T13:33:28.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"213.790000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.410000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.960000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012313330800000009",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"33f740b3-c553-462f-af7f-aa1b1875a45a",{"status":"Accepted"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231333470000000F","StopTransaction",{"idTag":"AE0022A1GM9C00066K","transactionId":1,"meterStop":528242,"timestamp":"2022-01-23T13:33:46.000Z","reason":"Remote"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231333470000000F",{"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231333180000000A","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T13:33:58.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231333180000000A",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231333280000000B","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T13:33:59.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231333280000000B",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231333380000000C","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T13:33:59.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231333380000000C",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231333390000000D","StatusNotification",{"connectorId":1,"status":"Preparing","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231333390000000D",{}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"a589cd9a-065a-4614-80b9-39487195b2e1","Reset",{"type":"Soft"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"a589cd9a-065a-4614-80b9-39487195b2e1",{"status":"Accepted"}]
[ERROR server.py:233] connection handler failed
Traceback (most recent call last):
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 944, in transfer_data
    message = await self.read_message()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1013, in read_message
    frame = await self.read_data_frame(max_size=self.max_size)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1089, in read_data_frame
    frame = await self.read_frame(max_size)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1148, in read_frame
    extensions=self.extensions,
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\framing.py", line 70, in read
    data = await reader(2)
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\streams.py", line 679, in readexactly
    await self._wait_for_data('readexactly')
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\streams.py", line 473, in _wait_for_data
    await self._waiter
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\selector_events.py", line 812, in _read_ready__data_received
    data = self._sock.recv(self.max_size)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\server.py", line 231, in handler
    await self.ws_handler(self)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\server.py", line 1137, in _ws_handler
    )(websocket, websocket.path)
  File "D:\workspace\ocpp_test\server\connect.py", line 156, in on_connect
    await Value.chargePoint.start()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\ocpp\charge_point.py", line 125, in start
    message = await self._connection.recv()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 552, in recv
    await self.ensure_open()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 920, in ensure_open
    raise self.connection_closed_exc()
websockets.exceptions.ConnectionClosedError: no close frame received or sent
[INFO server.py:259] connection closed
[INFO server.py:641] connection open
[INFO connect.py:146] Protocols Matched: ocpp1.6
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012313342400000001","BootNotification",{"chargePointModel":"MaxiChargerAC","chargePointVendor":"Autel","firmwareVersion":"CAQoSPAGNL"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012313342400000001",{"currentTime":"2022-01-23T13:34:25.123Z","interval":10,"status":"Accepted"}]
[INFO test_Recurrent_cpVoltN.py:69] 稍等5秒，等桩连上后台
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012313342500000002","StatusNotification",{"connectorId":0,"status":"Available","errorCode":"NoError"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012313342500000002",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012313342500000003","StatusNotification",{"connectorId":1,"status":"Preparing","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012313342500000003",{}]
[INFO test_Recurrent_cpVoltN.py:31] ========这是第96次开始执行========
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"5b715446-ad91-4941-89b4-90001259117c","RemoteStartTransaction",{"idTag":"AE0022A1GM9C00066K","connectorId":1,"chargingProfile":{"chargingProfileId":1,"transactionId":1,"stackLevel":1,"chargingProfilePurpose":"ChargePointMaxProfile","chargingProfileKind":"Absolute","recurrencyKind":"Daily","validFrom":"date-time","validTo":"date-time","chargingSchedule":{"duration":10,"startSchedule":"date-time","chargingRateUnit":"W","chargingSchedulePeriod":[{"startPeriod":1,"limit":1.5,"numberPhases":1}],"minChargingRate":1.5}}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"5b715446-ad91-4941-89b4-90001259117c",{"status":"Accepted"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012313343300000004","Authorize",{"idTag":"AE0022A1GM9C00066K"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012313343300000004",{"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012313343600000005","StatusNotification",{"connectorId":1,"status":"Charging","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012313343600000005",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012313343700000006","StartTransaction",{"connectorId":1,"idTag":"AE0022A1GM9C00066K","meterStart":528242,"timestamp":"2022-01-23T13:34:36.000Z"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012313343700000006",{"transactionId":1,"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012313343800000007","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T13:34:38.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"213.900000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.420000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.960000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012313343800000007",{}]
[INFO test_Recurrent_cpVoltN.py:52] ********正在充电********稍等约1分钟********
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"6ed2b600-c2e5-455b-9754-8e9d93344b71","RemoteStopTransaction",{"transactionId":1}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012313344800000008","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T13:34:49.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"213.920000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.420000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.960000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012313344800000008",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012313345900000009","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T13:35:19.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"213.860000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.420000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.960000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012313345900000009",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"6ed2b600-c2e5-455b-9754-8e9d93344b71",{"status":"Accepted"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231335370000000F","StopTransaction",{"idTag":"AE0022A1GM9C00066K","transactionId":1,"meterStop":528242,"timestamp":"2022-01-23T13:35:36.000Z","reason":"Remote"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231335370000000F",{"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231335090000000A","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T13:35:49.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231335090000000A",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231335190000000B","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T13:35:50.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231335190000000B",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231335290000000C","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T13:35:50.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231335290000000C",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231335300000000D","StatusNotification",{"connectorId":1,"status":"Preparing","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231335300000000D",{}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"5fde04bd-7a31-415e-90b5-b4563c955476","Reset",{"type":"Soft"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"5fde04bd-7a31-415e-90b5-b4563c955476",{"status":"Accepted"}]
[ERROR server.py:233] connection handler failed
Traceback (most recent call last):
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 944, in transfer_data
    message = await self.read_message()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1013, in read_message
    frame = await self.read_data_frame(max_size=self.max_size)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1089, in read_data_frame
    frame = await self.read_frame(max_size)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1148, in read_frame
    extensions=self.extensions,
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\framing.py", line 70, in read
    data = await reader(2)
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\streams.py", line 679, in readexactly
    await self._wait_for_data('readexactly')
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\streams.py", line 473, in _wait_for_data
    await self._waiter
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\selector_events.py", line 812, in _read_ready__data_received
    data = self._sock.recv(self.max_size)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\server.py", line 231, in handler
    await self.ws_handler(self)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\server.py", line 1137, in _ws_handler
    )(websocket, websocket.path)
  File "D:\workspace\ocpp_test\server\connect.py", line 156, in on_connect
    await Value.chargePoint.start()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\ocpp\charge_point.py", line 125, in start
    message = await self._connection.recv()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 552, in recv
    await self.ensure_open()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 920, in ensure_open
    raise self.connection_closed_exc()
websockets.exceptions.ConnectionClosedError: no close frame received or sent
[INFO server.py:259] connection closed
[INFO server.py:641] connection open
[INFO connect.py:146] Protocols Matched: ocpp1.6
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012313361400000001","BootNotification",{"chargePointModel":"MaxiChargerAC","chargePointVendor":"Autel","firmwareVersion":"CAQoSPAGNL"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012313361400000001",{"currentTime":"2022-01-23T13:36:15.123Z","interval":10,"status":"Accepted"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012313361500000002","StatusNotification",{"connectorId":0,"status":"Available","errorCode":"NoError"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012313361500000002",{}]
[INFO test_Recurrent_cpVoltN.py:69] 稍等5秒，等桩连上后台
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012313361500000003","StatusNotification",{"connectorId":1,"status":"Preparing","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012313361500000003",{}]
[INFO test_Recurrent_cpVoltN.py:31] ========这是第97次开始执行========
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"1f5558bd-b42d-4632-a943-38bf0585098c","RemoteStartTransaction",{"idTag":"AE0022A1GM9C00066K","connectorId":1,"chargingProfile":{"chargingProfileId":1,"transactionId":1,"stackLevel":1,"chargingProfilePurpose":"ChargePointMaxProfile","chargingProfileKind":"Absolute","recurrencyKind":"Daily","validFrom":"date-time","validTo":"date-time","chargingSchedule":{"duration":10,"startSchedule":"date-time","chargingRateUnit":"W","chargingSchedulePeriod":[{"startPeriod":1,"limit":1.5,"numberPhases":1}],"minChargingRate":1.5}}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"1f5558bd-b42d-4632-a943-38bf0585098c",{"status":"Accepted"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012313362400000004","Authorize",{"idTag":"AE0022A1GM9C00066K"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012313362400000004",{"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012313362600000006","StartTransaction",{"connectorId":1,"idTag":"AE0022A1GM9C00066K","meterStart":528242,"timestamp":"2022-01-23T13:36:26.000Z"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012313362600000006",{"transactionId":1,"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012313362600000005","StatusNotification",{"connectorId":1,"status":"Charging","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012313362600000005",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012313362800000007","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T13:36:28.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"213.750000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.420000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.960000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012313362800000007",{}]
[INFO test_Recurrent_cpVoltN.py:52] ********正在充电********稍等约1分钟********
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"3790a547-d6fb-4888-ae58-bd16a30b7ef3","RemoteStopTransaction",{"transactionId":1}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012313363800000008","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T13:36:38.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"213.780000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.420000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.960000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012313363800000008",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012313364800000009","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T13:37:08.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"213.840000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.410000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.960000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.010000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012313364800000009",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"3790a547-d6fb-4888-ae58-bd16a30b7ef3",{"status":"Accepted"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231337280000000F","StopTransaction",{"idTag":"AE0022A1GM9C00066K","transactionId":1,"meterStop":528242,"timestamp":"2022-01-23T13:37:27.000Z","reason":"Remote"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231337280000000F",{"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231336580000000A","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T13:37:39.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231336580000000A",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231337090000000B","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T13:37:39.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231337090000000B",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231337190000000C","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T13:37:40.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231337190000000C",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231337200000000D","StatusNotification",{"connectorId":1,"status":"Preparing","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231337200000000D",{}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"188d3982-477c-4357-9d39-9fdb50db10eb","Reset",{"type":"Soft"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"188d3982-477c-4357-9d39-9fdb50db10eb",{"status":"Accepted"}]
[ERROR server.py:233] connection handler failed
Traceback (most recent call last):
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 944, in transfer_data
    message = await self.read_message()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1013, in read_message
    frame = await self.read_data_frame(max_size=self.max_size)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1089, in read_data_frame
    frame = await self.read_frame(max_size)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1148, in read_frame
    extensions=self.extensions,
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\framing.py", line 70, in read
    data = await reader(2)
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\streams.py", line 679, in readexactly
    await self._wait_for_data('readexactly')
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\streams.py", line 473, in _wait_for_data
    await self._waiter
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\selector_events.py", line 812, in _read_ready__data_received
    data = self._sock.recv(self.max_size)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\server.py", line 231, in handler
    await self.ws_handler(self)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\server.py", line 1137, in _ws_handler
    )(websocket, websocket.path)
  File "D:\workspace\ocpp_test\server\connect.py", line 156, in on_connect
    await Value.chargePoint.start()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\ocpp\charge_point.py", line 125, in start
    message = await self._connection.recv()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 552, in recv
    await self.ensure_open()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 920, in ensure_open
    raise self.connection_closed_exc()
websockets.exceptions.ConnectionClosedError: no close frame received or sent
[INFO server.py:259] connection closed
[INFO server.py:641] connection open
[INFO connect.py:146] Protocols Matched: ocpp1.6
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012313380500000001","BootNotification",{"chargePointModel":"MaxiChargerAC","chargePointVendor":"Autel","firmwareVersion":"CAQoSPAGNL"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012313380500000001",{"currentTime":"2022-01-23T13:38:06.123Z","interval":10,"status":"Accepted"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012313380600000002","StatusNotification",{"connectorId":0,"status":"Available","errorCode":"NoError"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012313380600000002",{}]
[INFO test_Recurrent_cpVoltN.py:69] 稍等5秒，等桩连上后台
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012313380600000003","StatusNotification",{"connectorId":1,"status":"Preparing","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012313380600000003",{}]
[INFO test_Recurrent_cpVoltN.py:31] ========这是第98次开始执行========
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"2b07fa50-b5ba-4e44-a639-8cc3b9aad067","RemoteStartTransaction",{"idTag":"AE0022A1GM9C00066K","connectorId":1,"chargingProfile":{"chargingProfileId":1,"transactionId":1,"stackLevel":1,"chargingProfilePurpose":"ChargePointMaxProfile","chargingProfileKind":"Absolute","recurrencyKind":"Daily","validFrom":"date-time","validTo":"date-time","chargingSchedule":{"duration":10,"startSchedule":"date-time","chargingRateUnit":"W","chargingSchedulePeriod":[{"startPeriod":1,"limit":1.5,"numberPhases":1}],"minChargingRate":1.5}}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"2b07fa50-b5ba-4e44-a639-8cc3b9aad067",{"status":"Accepted"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012313381500000004","Authorize",{"idTag":"AE0022A1GM9C00066K"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012313381500000004",{"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012313381700000005","StatusNotification",{"connectorId":1,"status":"Charging","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012313381700000005",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012313381800000006","StartTransaction",{"connectorId":1,"idTag":"AE0022A1GM9C00066K","meterStart":528242,"timestamp":"2022-01-23T13:38:17.000Z"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012313381800000006",{"transactionId":1,"idTagInfo":{"status":"Accepted"}}]
[INFO test_Recurrent_cpVoltN.py:52] ********正在充电********稍等约1分钟********
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"7fd3ad32-6d1c-4e91-8f6e-c8750ff50731","RemoteStopTransaction",{"transactionId":1}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012313381900000007","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T13:38:19.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"214.060000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.430000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.960000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012313381900000007",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012313383000000008","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T13:38:49.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"213.950000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.430000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.960000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012313383000000008",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"7fd3ad32-6d1c-4e91-8f6e-c8750ff50731",{"status":"Accepted"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231339160000000E","StopTransaction",{"idTag":"AE0022A1GM9C00066K","transactionId":1,"meterStop":528242,"timestamp":"2022-01-23T13:39:15.000Z","reason":"Remote"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231339160000000E",{"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012313384000000009","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T13:39:20.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012313384000000009",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231338500000000A","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T13:39:20.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231338500000000A",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231339010000000B","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T13:39:21.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231339010000000B",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231339080000000C","StatusNotification",{"connectorId":1,"status":"Preparing","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231339080000000C",{}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"b350169e-a117-4ad4-bb99-8752a207e06a","Reset",{"type":"Soft"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"b350169e-a117-4ad4-bb99-8752a207e06a",{"status":"Accepted"}]
[ERROR server.py:233] connection handler failed
Traceback (most recent call last):
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 944, in transfer_data
    message = await self.read_message()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1013, in read_message
    frame = await self.read_data_frame(max_size=self.max_size)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1089, in read_data_frame
    frame = await self.read_frame(max_size)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1148, in read_frame
    extensions=self.extensions,
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\framing.py", line 70, in read
    data = await reader(2)
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\streams.py", line 679, in readexactly
    await self._wait_for_data('readexactly')
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\streams.py", line 473, in _wait_for_data
    await self._waiter
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\selector_events.py", line 812, in _read_ready__data_received
    data = self._sock.recv(self.max_size)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\server.py", line 231, in handler
    await self.ws_handler(self)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\server.py", line 1137, in _ws_handler
    )(websocket, websocket.path)
  File "D:\workspace\ocpp_test\server\connect.py", line 156, in on_connect
    await Value.chargePoint.start()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\ocpp\charge_point.py", line 125, in start
    message = await self._connection.recv()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 552, in recv
    await self.ensure_open()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 920, in ensure_open
    raise self.connection_closed_exc()
websockets.exceptions.ConnectionClosedError: no close frame received or sent
[INFO server.py:259] connection closed
[INFO server.py:641] connection open
[INFO connect.py:146] Protocols Matched: ocpp1.6
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012313394700000001","BootNotification",{"chargePointModel":"MaxiChargerAC","chargePointVendor":"Autel","firmwareVersion":"CAQoSPAGNL"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012313394700000001",{"currentTime":"2022-01-23T13:39:47.123Z","interval":10,"status":"Accepted"}]
[INFO test_Recurrent_cpVoltN.py:69] 稍等5秒，等桩连上后台
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012313394700000002","StatusNotification",{"connectorId":0,"status":"Available","errorCode":"NoError"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012313394700000002",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012313394700000003","StatusNotification",{"connectorId":1,"status":"Preparing","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012313394700000003",{}]
[INFO test_Recurrent_cpVoltN.py:31] ========这是第99次开始执行========
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"68b9f548-bab3-4a2f-8f97-d569c11c44e3","RemoteStartTransaction",{"idTag":"AE0022A1GM9C00066K","connectorId":1,"chargingProfile":{"chargingProfileId":1,"transactionId":1,"stackLevel":1,"chargingProfilePurpose":"ChargePointMaxProfile","chargingProfileKind":"Absolute","recurrencyKind":"Daily","validFrom":"date-time","validTo":"date-time","chargingSchedule":{"duration":10,"startSchedule":"date-time","chargingRateUnit":"W","chargingSchedulePeriod":[{"startPeriod":1,"limit":1.5,"numberPhases":1}],"minChargingRate":1.5}}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"68b9f548-bab3-4a2f-8f97-d569c11c44e3",{"status":"Accepted"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012313395600000004","Authorize",{"idTag":"AE0022A1GM9C00066K"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012313395600000004",{"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012313395800000005","StatusNotification",{"connectorId":1,"status":"Charging","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012313395800000005",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012313395900000006","StartTransaction",{"connectorId":1,"idTag":"AE0022A1GM9C00066K","meterStart":528242,"timestamp":"2022-01-23T13:39:58.000Z"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012313395900000006",{"transactionId":1,"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012313400000000007","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T13:40:00.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"213.850000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.420000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.960000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012313400000000007",{}]
[INFO test_Recurrent_cpVoltN.py:52] ********正在充电********稍等约1分钟********
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"0f73ad85-9054-45a9-9e36-7cbb035e644e","RemoteStopTransaction",{"transactionId":1}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012313401000000008","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T13:40:10.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"213.770000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.420000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.960000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012313401000000008",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012313402000000009","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T13:40:40.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"213.650000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"7.400000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.960000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012313402000000009",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"0f73ad85-9054-45a9-9e36-7cbb035e644e",{"status":"Accepted"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231341000000000F","StopTransaction",{"idTag":"AE0022A1GM9C00066K","transactionId":1,"meterStop":528242,"timestamp":"2022-01-23T13:40:59.000Z","reason":"Remote"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231341000000000F",{"idTagInfo":{"status":"Accepted"}}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231340310000000A","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T13:41:10.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231340310000000A",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231340410000000B","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T13:41:11.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231340410000000B",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231340510000000C","MeterValues",{"connectorId":1,"transactionId":1,"meterValue":[{"timestamp":"2022-01-23T13:41:11.000Z","sampledValue":[{"value":"528242","unit":"Wh","measurand":"Energy.Active.Import.Register"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L1"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L2"},{"value":"0.000000","unit":"V","measurand":"Voltage","phase":"L3"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L1"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L2"},{"value":"0.009000","unit":"A","measurand":"Current.Export","phase":"L3"},{"value":"0","unit":"W","measurand":"Power.Offered"}]}]}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231340510000000C",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"202201231340520000000D","StatusNotification",{"connectorId":1,"status":"Preparing","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"202201231340520000000D",{}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [2,"db5e5408-0724-4c43-b9bd-08a9b7039b54","Reset",{"type":"Soft"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [3,"db5e5408-0724-4c43-b9bd-08a9b7039b54",{"status":"Accepted"}]
[ERROR server.py:233] connection handler failed
Traceback (most recent call last):
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 944, in transfer_data
    message = await self.read_message()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1013, in read_message
    frame = await self.read_data_frame(max_size=self.max_size)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1089, in read_data_frame
    frame = await self.read_frame(max_size)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1148, in read_frame
    extensions=self.extensions,
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\framing.py", line 70, in read
    data = await reader(2)
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\streams.py", line 679, in readexactly
    await self._wait_for_data('readexactly')
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\streams.py", line 473, in _wait_for_data
    await self._waiter
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\selector_events.py", line 812, in _read_ready__data_received
    data = self._sock.recv(self.max_size)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\server.py", line 231, in handler
    await self.ws_handler(self)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\server.py", line 1137, in _ws_handler
    )(websocket, websocket.path)
  File "D:\workspace\ocpp_test\server\connect.py", line 156, in on_connect
    await Value.chargePoint.start()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\ocpp\charge_point.py", line 125, in start
    message = await self._connection.recv()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 552, in recv
    await self.ensure_open()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 920, in ensure_open
    raise self.connection_closed_exc()
websockets.exceptions.ConnectionClosedError: no close frame received or sent
[INFO server.py:259] connection closed
FAILED
testcase\test_my_API\test_Recurrent_cpVoltN.py:19 (test_Recurrent_cpVoltN)
event_loop = <_WindowsSelectorEventLoop running=False closed=False debug=False>

    @allure.feature("test_Recurrent_cpVoltN")
    @pytest.mark.asyncio
    async def test_Recurrent_cpVoltN(event_loop):
        # 插枪
        Connector.slot()
    
        # 获取交流家桩的枪启动充电之前的状态
        status = await waitConnectorStatus(1, "Preparing")
        assert status == "Preparing"
    
        for i in range(1500):
            logging.info("========这是第%s次开始执行========" % str(i+1))
            # 远程启动充电
            clearTriggerMessage()
            with open("schema/RemoteStartTransaction.json", 'r') as f:
                data = json.load(f)
            response = await service.remoteStartTransaction(event_loop, id_tag=data.get('idTag'),
                                                            connector_id=data.get('connectorId'),
                                                            charging_profile=data.get('chargingProfile'))
            assert response[0].status == RegistrationStatus.accepted
    
            # 等待鉴权通过
            flag, _ = await waitRequest("authorize", 30)
            assert flag is True
    
            # 等待桩返回开始订单的信息
            flag, _ = await waitRequest("start_transaction")
            assert flag is True
    
            # 获取桩充电之后的状态
            status = await waitConnectorStatus(1, "Charging", 30)
            assert status == "Charging"
            logging.info("********正在充电********稍等约1分钟********")
            sleep(50)
    
            # 结束远程充电
            response = await service.remoteStopTransaction(event_loop, data['chargingProfile']['transactionId'])
            assert response[0].status == RegistrationStatus.accepted
            status = await waitConnectorStatus(1, "Preparing", 30)
            assert status == "Preparing"
    
            # 重启充电桩
            clearTriggerMessage()
            response = await service.reset(event_loop, "Soft")
            assert response[0].status == RegistrationStatus.accepted
    
            # 等待充电桩重启
            flag, _ = await waitRequest("boot_notification")
>           assert flag is True
E           assert False is True

test_Recurrent_cpVoltN.py:68: AssertionError








[INFO conftest.py:24] **************************************************tear down**************************************************
[INFO server.py:641] connection open
[INFO connect.py:146] Protocols Matched: ocpp1.6
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012313414700000001","BootNotification",{"chargePointModel":"MaxiChargerAC","chargePointVendor":"Autel","firmwareVersion":"CAQoSPAGNL"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012313414700000001",{"currentTime":"2022-01-23T13:41:48.123Z","interval":10,"status":"Accepted"}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012313414800000002","StatusNotification",{"connectorId":0,"status":"Available","errorCode":"NoError"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012313414800000002",{}]
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012313414800000003","StatusNotification",{"connectorId":1,"status":"Preparing","errorCode":"NoError","info":"eCp_6V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012313414800000003",{}]
[INFO server.py:755] server closing
[ERROR server.py:233] connection handler failed
Traceback (most recent call last):
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 944, in transfer_data
    message = await self.read_message()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1013, in read_message
    frame = await self.read_data_frame(max_size=self.max_size)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1089, in read_data_frame
    frame = await self.read_frame(max_size)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 1148, in read_frame
    extensions=self.extensions,
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\framing.py", line 70, in read
    data = await reader(2)
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\streams.py", line 679, in readexactly
    await self._wait_for_data('readexactly')
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\streams.py", line 473, in _wait_for_data
    await self._waiter
  File "C:\Users\Autel\AppData\Local\Programs\Python\Python37\lib\asyncio\selector_events.py", line 812, in _read_ready__data_received
    data = self._sock.recv(self.max_size)
ConnectionResetError: [WinError 10054] 远程主机强迫关闭了一个现有的连接。

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\server.py", line 231, in handler
    await self.ws_handler(self)
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\server.py", line 1137, in _ws_handler
    )(websocket, websocket.path)
  File "D:\workspace\ocpp_test\server\connect.py", line 156, in on_connect
    await Value.chargePoint.start()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\ocpp\charge_point.py", line 125, in start
    message = await self._connection.recv()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 552, in recv
    await self.ensure_open()
  File "D:\workspace\ocpp_test\venv\lib\site-packages\websockets\legacy\protocol.py", line 920, in ensure_open
    raise self.connection_closed_exc()
websockets.exceptions.ConnectionClosedError: sent 1001 (going away); no close frame received
[INFO server.py:259] connection closed
[INFO charge_point.py:126] CP_1AE0022A1GM9C00066K: receive message [2,"2022012313415000000004","StatusNotification",{"connectorId":1,"status":"Available","errorCode":"NoError","info":"eCp_12V"}]
[INFO charge_point.py:317] CP_1AE0022A1GM9C00066K: send [3,"2022012313415000000004",{}]


======================= 1 failed in 10698.80s (2:58:18) =======================

Process finished with exit code 1






